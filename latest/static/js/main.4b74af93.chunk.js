(this["webpackJsonpopening-prep"]=this["webpackJsonpopening-prep"]||[]).push([[0],{14:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(169),r=a(2);function s(){n.a.pageview(window.location.pathname),navigator.referrer&&o(r.d,"Referrer",navigator.referrer),o()}function o(e,t,a,r){n.a.event({category:e,action:t,label:a,value:r})}n.a.initialize("UA-159149755-1")},2:function(e,t,a){"use strict";a.d(t,"J",(function(){return n})),a.d(t,"E",(function(){return r})),a.d(t,"D",(function(){return s})),a.d(t,"I",(function(){return o})),a.d(t,"F",(function(){return i})),a.d(t,"G",(function(){return l})),a.d(t,"H",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"l",(function(){return h})),a.d(t,"i",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"z",(function(){return d})),a.d(t,"x",(function(){return g})),a.d(t,"B",(function(){return f})),a.d(t,"y",(function(){return v})),a.d(t,"C",(function(){return b})),a.d(t,"A",(function(){return E})),a.d(t,"n",(function(){return y})),a.d(t,"o",(function(){return w})),a.d(t,"h",(function(){return C})),a.d(t,"f",(function(){return k})),a.d(t,"b",(function(){return O})),a.d(t,"g",(function(){return N})),a.d(t,"a",(function(){return j})),a.d(t,"c",(function(){return S})),a.d(t,"e",(function(){return P})),a.d(t,"d",(function(){return F})),a.d(t,"w",(function(){return x})),a.d(t,"v",(function(){return T})),a.d(t,"u",(function(){return A})),a.d(t,"m",(function(){return R})),a.d(t,"r",(function(){return D})),a.d(t,"t",(function(){return G})),a.d(t,"s",(function(){return M})),a.d(t,"p",(function(){return I})),a.d(t,"q",(function(){return L}));var n="ultraBullet",r="bullet",s="blitz",o="rapid",i="classical",l="correspondence",c="daily",u="rated",h="selectedTimeframe",p="downloadLimit",m="eloRange",d="lichess",g="chesscom",f="pgnfile",v="eventdb",b="playerdb",E="opntfile",y=2e3,w=3e3,C="loader",k="moves",O="controls",N="navigator",j="chessboard",S="error",P="message",F="GLOBAL",x="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",T="white",A="black",R=500,D="feedback@openingtree.com",G="opening_tree",M="vannooz",I="vannooz",L="https://discord.gg/hCwKkN8"},219:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(46),r=a(165),s=a.n(r),o=a(22),i=a(348);function l(e,t,a){console.log(e);var r=function(e){return[{chunk:e.object,index:0}].concat(Object(n.a)(function(e,t){for(var a=[],n=0,r=1;n<e.length;n+=t,r++)a.push({chunk:e.slice(n,n+t),index:r});return a}(e.array,1e3)))}(e),l=[];console.log(r.length),l.push(h(1)),l.push(h(r.length));var c=r.length,u=!1;r.forEach((function(e){s.a.deflate(new o.Buffer(JSON.stringify(e)),(function(e,n){if(c--,e&&(u=!0),l.push(h(n.byteLength)),l.push(n),c<=0){if(u)return void a("Could not save file");Object(i.saveAs)(new Blob(l,{type:"application/octet-stream"}),t),a(null,"Saved opening tree to file ".concat(t))}}))}))}function c(e,t){var a=new FileReader;a.onload=function(e){var a=e.target.result,n=0,r=u(a.slice(n,n+8));if(n+=8,1===r){var i=u(a.slice(n,n+8));n+=8,i?function(e,t,a,n){var r=t,i=[],l=a,c=!1,h=function(e,t){l--,e&&(console.log(e),c=!0);try{i.push(JSON.parse(t))}catch(a){console.log(a),c=!0}0===l&&(c&&n("Input file seems corrupted",null),n(null,function(e){var t=e.sort((function(e,t){return e.index-t.index}));return{object:t[0].chunk,array:t.slice(1).map((function(e){return e.chunk})).flat()}}(i)))};for(;a>0;){var p=u(e.slice(r,r+8));r+=8,s.a.inflate(o.Buffer.from(e,r,p),h),r+=p,a--}}(a,n,i,t):t("Input file not in correct format",null)}else t("File is not an openingtree save file.",null,"Are you loading the correct file?")},a.onerror=function(e){t("Failed to read openingtree file",null,"".concat(e.target.error.name,":").concat(e.target.error.message))},a.readAsArrayBuffer(e)}function u(e){var t=new DataView(e);return 4919!==t.getUint16(0)||49363!==t.getUint16(6)?null:t.getUint32(2)}function h(e){var t=new ArrayBuffer(8),a=new DataView(t);return a.setUint16(0,4919),a.setUint32(2,e>>>0),a.setUint16(6,49363),t}},24:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return p}));var n=a(7),r=a(695),s=a(0),o=a.n(s),i=a(31),l=a(2),c=Object(n.a)({root:{border:"1px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{margin:"auto"}},expanded:{}})(r.a);function u(e){return o.a.createElement("img",{alt:"step ".concat(e),className:"lowOpacity styledNumbers",src:"/images/styled-".concat(e,".png"),height:24})}function h(e){return Object(i.a)(e,[l.J,l.E,l.D,l.I,l.G,l.H,l.F,l.k,l.l,l.i,l.j])}function p(e){var t=document.getElementById(e);try{return t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),!0}catch(a){return!1}}},31:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return p})),a.d(t,"g",(function(){return m})),a.d(t,"f",(function(){return d}));var n=a(2),r=a(54);function s(e,t){var a={};return t.forEach((function(t){a[t]=e[t]})),a}function o(e){var t=e.split(" ");return t.length<=4?e:"".concat(t[0]," ").concat(t[1]," ").concat(t[2])}function i(e,t,a){return(e===n.z?r.c:r.a).filter((function(e){return!!t[e]===a}))}var l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function c(){for(var e=[{year:2007,value:0}],t=1,a=2010,n=(new Date).getFullYear(),r=(new Date).getMonth();a<n-1;)e.push({toLongLabel:"".concat(l[11]," ").concat(a),fromLongLabel:"".concat(l[0]," ").concat(a),year:a,value:t}),a++,t++;for(var s=11;s>0;s--){var o=(r+12-s)%12,i=o<r?n:n-1;e.push({fromLongLabel:"".concat(l[o]," ").concat(i),toLongLabel:"".concat(l[o]," ").concat(i),month:o,year:i,value:t}),t++}return e.push({month:12,year:n,value:t}),e}function u(e,t){var a=e[0],n=e[1],r=t[a],s=t[n];if(a===t.length-1&&n===t.length-1){var o=new Date;return{label:"Current month",fromMonth:o.getMonth(),frmYear:o.getYear(),fromTimeStamp:h(o.getMonth(),o.getYear(),"min")}}if(0===a&&0===n)return{label:"Anytime"};if(0===a&&n===t.length-1)return{label:"Anytime"};if(n===t.length-1){var i=r.month?r.month:0;return{label:"Since ".concat(r.fromLongLabel),fromYear:r.year,fromMonth:i,fromTimeStamp:h(i,r.year,"min")}}if(0===a){var l=s.month?s.month:11;return{label:"Until ".concat(s.toLongLabel),toYear:s.year,toMonth:l,toTimeStamp:h(l,s.year,"max")}}var c=r.month?r.month:0,u=s.month?s.month:11;return{label:"From ".concat(r.fromLongLabel," to ").concat(s.toLongLabel),fromYear:r.year,fromMonth:c,fromTimeStamp:h(c,r.year,"min"),toYear:s.year,toMonth:u,toTimeStamp:h(u,s.year,"max")}}function h(e,t,a){return"min"===a?new Date(t,e).getTime():new Date(t,e,function(e,t){return new Date(e,t+1,0).getDate()}(t,e)).getTime()}function p(e,t,a,s,o){var i=t+a+s,l=Math.round(e/i),c=o===n.v?t:s,u=o!==n.v?t:s,h=c+a/2,p=Math.round(100*h/i),m=r.b[p];return{results:"+".concat(c,"-").concat(u,"=").concat(a),performanceRating:l+m,averageElo:l,score:"".concat(Number.isInteger(h)?h:h.toFixed(1),"/").concat(i),ratingChange:"".concat(0===m?"":m>0?"+":"-").concat(Math.abs(m))}}function m(e,t){return(t[1]===n.o||e<=t[1])&&e>=t[0]}function d(e,t){return!!t&&(!e||new Date(e)>new Date(t))}},343:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return I}));var n=a(50),r=a(98),s=a(18),o=a(13),i=a(16),l=a(28),c=a(29),u=a(30),h=a(0),p=a.n(h),m=a(24),d=a(687),g=a(686),f=a(113),v=a.n(f),b=a(691),E=a(694),y=a(2),w=a(682),C=a(14),k=a(32),O=a(132),N=a(25),j=a(353),S=a(684),P=a(70),F=a(696),x=a(692),T=a(688),A=a(355),R=a(357),D=a(693),G=a(344),M=a.n(G),I=function(t){function a(e){var t;return Object(o.a)(this,a),(t=Object(l.a)(this,Object(c.a)(a).call(this,e))).state={playerColor:t.props.playerColor,isAdvancedFiltersOpen:!1},t.timeframeSteps=t.props.timeframeSteps,Object.assign(t.state,t.props.advancedFilters),t.defaultAdvancedFilters=t.props.advancedFilters,t}return Object(u.a)(a,t),Object(i.a)(a,[{key:"toggleRated",value:function(){"all"===this.state.rated?this.setState({rated:"rated"}):"rated"===this.state.rated?this.setState({rated:"casual"}):this.setState({rated:"all"}),Object(C.a)(y.h,"AdvancedFilterChange","rated")}},{key:"toggleState",value:function(e){var t=this;return function(){var a={};a[e]=!t.state[e],t.setState(a),Object(C.a)(y.h,"ToggleAdvancedFilters",t.state.site)}}},{key:"playerColorChange",value:function(t){var a=t.target.value;this.setState({playerColor:a}),Object(C.a)(y.h,"ColorChange",a),P.b(this.props.site)||e(this.setFilters.bind(this))}},{key:"handleTimeControlChange",value:function(e){this.setState(Object(s.a)({},e.target.name,e.target.checked))}},{key:"handleTimeframeChange",value:function(e,t){this.setState(Object(s.a)({},y.l,t))}},{key:"handleEloRangeChange",value:function(e,t){this.setState(Object(s.a)({},y.j,t))}},{key:"handleDownloadLimitChange",value:function(e,t){this.setState(Object(s.a)({},y.i,t))}},{key:"setFilters",value:function(){this.state.playerColor?(this.setState({colorError:""}),this.props.filtersChange(this.state)):this.setState({colorError:"Please select a color"})}},{key:"getSummary",value:function(e){return this.props.playerColor&&!e?p.a.createElement("span",null,Object(m.d)("done"),"Color: ",p.a.createElement("b",null,this.props.playerColor===y.v?"White":"Black"," "),this.areAdvancedFiltersApplied()?p.a.createElement("span",{className:"smallText"},"(Filters applied)"):null):p.a.createElement("span",null,Object(m.d)(3)," Color and filters")}},{key:"componentWillReceiveProps",value:function(e){this.setState(Object(r.a)({},e.advancedFilters,{playerColor:e.playerColor}))}},{key:"areAdvancedFiltersApplied",value:function(){for(var e=0,t=Object.entries(this.defaultAdvancedFilters);e<t.length;e++){var a=Object(n.a)(t[e],2),r=a[0],s=a[1];if(this.props.advancedFilters[r]!==s&&!M()(this.props.advancedFilters[r],s))return!0}return!1}},{key:"render",value:function(){var e=!P.c(this.props.site,this.props.playerName,this.props.selectedNotablePlayer);return p.a.createElement(m.a,{expanded:"filters"===this.props.expandedPanel,TransitionComponent:S.a,TransitionProps:{timeout:y.m},onChange:this.props.handleExpansionChange,disabled:e},p.a.createElement(g.a,{expandIcon:p.a.createElement(v.a,null)},this.getSummary(e)),p.a.createElement(d.a,null,p.a.createElement("div",{className:"pgnloaderfirstsection"},p.a.createElement(F.a,{component:"fieldset",error:!!this.state.colorError},p.a.createElement(x.a,{component:"legend"},"Games where ",p.a.createElement("b",null,this.props.playerName)," is playing as:"),p.a.createElement(T.a,{onChange:this.playerColorChange.bind(this),value:this.state.playerColor},p.a.createElement(A.a,{className:"whitelabel",control:p.a.createElement(R.a,{color:"primary"}),value:y.v,label:this.state.playerColor===y.v?p.a.createElement("b",null,"White"):"White"}),p.a.createElement(A.a,{className:"blacklabel",control:p.a.createElement(R.a,{color:"primary"}),value:y.u,label:this.state.playerColor===y.u?p.a.createElement("b",null,"Black"):"Black"})),p.a.createElement(D.a,null,this.state.colorError))),P.b(this.props.site)?p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement("span",{className:"linkStyle",onClick:this.toggleState("isAdvancedFiltersOpen").bind(this)},"Advanced filters ",p.a.createElement(k.a,{icon:this.state.isAdvancedFiltersOpen?N.b:N.a})),p.a.createElement(w.a,{isOpen:this.state.isAdvancedFiltersOpen},p.a.createElement(j.a,{site:this.props.site,toggleRated:this.toggleRated.bind(this),handleTimeControlChange:this.handleTimeControlChange.bind(this),handleTimeframeChange:this.handleTimeframeChange.bind(this),handleEloRangeChange:this.handleEloRangeChange.bind(this),timeframeSteps:this.timeframeSteps,handleDownloadLimitChange:this.handleDownloadLimitChange.bind(this),advancedFilters:Object(m.b)(this.state)}))):null),p.a.createElement(b.a,null),p.a.createElement(E.a,null,p.a.createElement(O.a,{size:"small",color:"primary",onClick:this.setFilters.bind(this)},"Continue")))}}]),a}(p.a.Component)}).call(this,a(105).setImmediate)},345:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return P}));var n=a(13),r=a(16),s=a(28),o=a(29),i=a(30),l=a(0),c=a.n(l),u=a(2),h=a(14),p=a(32),m=a(132),d=a(352),g=a(25),f=a(221),v=a.n(f),b=a(349),E=a.n(b),y=a(356),w=a(154),C=a.n(w),k=a(70),O=a(697),N=a(220),j=a.n(N),S=a(219),P=function(t){function a(e){var t;return Object(n.a)(this,a),(t=Object(s.a)(this,Object(o.a)(a).call(this,e))).unload=function(){t.pgnReader&&t.pgnReader.stopDownloading()},t.state={isGamesSubsectionOpen:!1,exportingInProgress:!1},t}return Object(i.a)(a,t),Object(r.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("beforeunload",this.unload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.unload)}},{key:"importTreeClicked",value:function(){this.setState({exportingInProgress:!0}),Object(h.a)(u.h,"LoadTree",this.props.site,this.props.playerColor===u.v?1:0),e(this.importOpeningTree.bind(this))}},{key:"importOpeningTree",value:function(){var e=this;Object(S.a)(this.props.files[0],(function(t,a,n){if(t)return e.props.showError(t,null,n),void e.setState({exportingInProgress:!1});e.props.importOpeningTreeObject(a),e.setState({exportingInProgress:!1}),e.props.showInfo("Successfuly loaded openingtree")}))}},{key:"exportTreeClicked",value:function(){this.setState({exportingInProgress:!0}),Object(h.a)(u.h,"SaveTree",this.props.site,this.props.playerColor===u.v?1:0),e(this.exportOpeningTree.bind(this))}},{key:"exportOpeningTree",value:function(){var e=this;Object(S.b)(this.props.exportOpeningTreeObject(),k.a(this.props.site,this.props.playerName,this.props.playerColor,null,"tree"),(function(t,a){t?e.props.showError(t):e.props.showInfo(a),e.setState({exportingInProgress:!1})}))}},{key:"readPgn",value:function(e){this.pgnReader=new d.a,this.pgnReader.fetchPGNFromSite(this.props.playerName,this.props.playerColor,this.props.site,this.props.selectedNotablePlayer,this.props.selectedNotableEvent,e,this.props.advancedFilters,this.props.notify,this.props.showError,this.stopDownloading.bind(this),this.props.files)}},{key:"download",value:function(){this.readPgn(!0),Object(h.a)(u.h,"Download",this.props.site,this.props.playerColor===u.v?1:0)}},{key:"getPlayerName",value:function(){return this.props.site===u.C?this.props.selectedNotablePlayer.name:this.props.playerName}},{key:"componentWillReceiveProps",value:function(e){e.gamesProcessed>0&&this.setState({isGamesSubsectionOpen:!0})}},{key:"load",value:function(){this.props.clear(),this.setState({isGamesSubsectionOpen:!0,loadedSite:this.props.site}),this.props.onChange("playerName",this.props.playerName),this.props.onChange("playerColor",this.props.playerColor),this.readPgn(!1),this.props.setDownloading(!0),Object(h.a)(u.h,"Load",this.props.site,this.props.playerColor===u.v?1:0)}},{key:"stopDownloading",value:function(){this.props.setDownloading(!1)}},{key:"stopDownloadingAction",value:function(){this.stopDownloading(),Object(h.a)(u.h,"StopDownloading",this.props.site)}},{key:"openingTreeLoadActions",value:function(){return c.a.createElement("div",{className:"pgnloadersection"},c.a.createElement(m.a,{onClick:this.importTreeClicked.bind(this),variant:"contained",color:"primary",startIcon:this.state.exportingInProgress?c.a.createElement(j.a,null):c.a.createElement(v.a,null),className:"mainButton",disableElevation:!0,disabled:this.state.exportingInProgress},this.state.exportingInProgress?"Loading from file":"Load openingtree"))}},{key:"regularActions",value:function(){var e=this,t=k.d(this.state.loadedSite,this.props.site,this.props.gamesProcessed,this.props.isDownloading);return c.a.createElement("div",null,c.a.createElement("div",{className:"pgnloadersection"},c.a.createElement(m.a,{onClick:this.load.bind(this),variant:"contained",color:"primary",startIcon:c.a.createElement(E.a,null),className:"mainButton",disableElevation:!0},"Analyze games")),c.a.createElement("div",{className:"pgnloadersection"},c.a.createElement(m.a,{onClick:this.download.bind(this),variant:"contained",color:"default",startIcon:c.a.createElement(v.a,null),className:"mainButton",disableElevation:!0},"Export as PGN")),c.a.createElement("div",{className:"pgnloadersection"},c.a.createElement(O.a,{placement:"top",title:t||"Save a .tree file locally for faster reload later"},c.a.createElement("span",null,c.a.createElement(m.a,{onClick:this.exportTreeClicked.bind(this),variant:"contained",color:"default",startIcon:this.state.exportingInProgress?c.a.createElement(j.a,null):c.a.createElement(C.a,null),className:"mainButton",disableElevation:!0,disabled:!!t||this.state.exportingInProgress},this.state.exportingInProgress?"Saving to file":"Save openingtree")))),this.state.isGamesSubsectionOpen?c.a.createElement("div",null,c.a.createElement("div",{className:"pgnloadersection"},"Games Loaded: ".concat(this.props.gamesProcessed," "),this.props.isDownloading?c.a.createElement("span",{className:"stopDownloading"},"[",c.a.createElement("span",{className:"linkStyle",onClick:this.stopDownloadingAction.bind(this)},c.a.createElement("img",{alt:"loading spinner",src:"./spinner.gif",height:"15"}),"stop"),"]"):""),c.a.createElement("div",{onClick:function(){return e.props.switchToMovesTab()},className:"navLinkButton pgnloadersection"},c.a.createElement(p.a,{icon:g.i})," View Moves>>")):"")}},{key:"mainComponent",value:function(){return this.props.site===u.A?this.openingTreeLoadActions():this.regularActions()}},{key:"render",value:function(){return this.props.expandedPanel?c.a.createElement(y.a,{timeout:2*u.m},this.mainComponent()):c.a.createElement(y.a,{in:!0,timeout:3*u.m},this.mainComponent())}}]),a}(c.a.Component)}).call(this,a(105).setImmediate)},352:function(e,t,a){"use strict";var n=a(13),r=a(16),s=a(77),o=a(97),i=a.n(o),l=a(91),c=a(31),u=a(2),h=a(14),p=a(115),m=a.n(p),d=a(346),g=a.n(d);function f(e){var t=g()(e);return t=(t=(t=(t=t.replace(/^;.*$/gm,"")).replace(/\\"/gm,"")).replace(/\n\n+\[/g,"\n\n\n[")).replace(/\s*\n+(1-0|0-1|1\/2-1\/2)/g," $1")}var v=a(54),b=function(){function e(t,a,r,s,o,i){var l=this;Object(n.a)(this,e);var c="",u=m.a.get(t,{json:!1}).on("error",s).on("response",(function(e){return r(e.statusCode)})).on("data",(function(e){var t=a?f(c+e.toString()):c+e.toString(),n=t.lastIndexOf("\n\n\n"),r=t.slice(0,n);c=t.slice(n),l.callDataCallback(r,o)||u.abort()})).on("end",(function(){l.callDataCallback(c,o),i()}))}return Object(r.a)(e,[{key:"callDataCallback",value:function(e,t){return t(e.split("\n\n\n").map((function(e){return Object(v.e)(e)})))}}]),e}(),E=function e(t,a,r,s,o){Object(n.a)(this,e);var i=encodeURIComponent(t),p="?color=".concat(a),m="".concat("all"===r[u.k]?"":"&rated=".concat("rated"===r[u.k]?"true":"false")),d=Object(c.c)(r[u.l],Object(c.e)()),g="".concat(d.fromTimeStamp?"&since=".concat(d.fromTimeStamp):""),f="".concat(d.toTimeStamp?"&until=".concat(d.toTimeStamp):""),v=Object(c.d)(u.z,r,!0),E=0===v.length||6===v.length?"":"&perfType=".concat(v.join(","));new b("https://lichess.org/api/games/user/"+i+p+m+E+g+f,!1,(function(e){404===e?o("Could not find lichess user "+t):200!==e&&o("Could not load games of lichess user "+t)}),(function(e){o("Failed to connect to lichess.org. Lichess might be down right now",null,"Some addons like 'Piracy Badger' can also cause this."),s([],!1)}),(function(e){var n=e.map((function(e){try{return Object(l.parse)(e)[0]}catch(a){return console.log("Failed to parse pgn",e),console.log(a),Object(h.a)(u.c,"parseFailedLichess",t),null}}));return s(n.filter((function(e){if(!e||"Standard"!==e.headers.Variant)return!1;var t=a===u.v?e.headers.BlackElo:e.headers.WhiteElo;return!!Object(c.g)(t,r[u.j])})),!0)}),(function(){s([],!1)}))},y=a(347),w=a.n(y),C=function e(t,a,r,s,o){Object(n.a)(this,e);var i=new w.a({queue:!0}),p=0,d=function(e){if(p--,!s(e.body.games.filter((function(e){if("chess"!==e.rules||e[a].username.toLowerCase()!==t.toLowerCase())return!1;var n=r[u.k];if("rated"===n&&!e.rated)return!1;if("casual"===n&&e.rated)return!1;if(!r[e.time_class])return!1;var s=a===u.v?e.black.rating:e.white.rating;return!!Object(c.g)(s,r[u.j])})).map((function(e){try{return Object(l.parse)(f(e.pgn))[0]}catch(n){return console.log("failed to parse pgn",e),console.log(n),Object(h.a)(u.c,"parseFailedChessCom","".concat(t,":").concat(a)),null}})).filter((function(e){return null!==e})),p>0)){for(;i.dequeue(););p=0,s([],!1)}},g=Object(c.c)(r[u.l],Object(c.e)()),v=function(e){e.archives.reverse().forEach((function(e){var a=e.split("/"),n=a[a.length-2],r=a[a.length-1];(function(e,t,a){var n=a.fromYear||1970,r=a.toYear||1e4,s=a.fromYear||0,o=a.toYear||11;return t>n&&t<r||!(t<n||t>r)&&(t===n?e>=s:t===r?e<=o:(console.log("should not happen"),!0))})(r,n,g)&&(p++,i.dispatch(i.getPlayerCompleteMonthlyArchives,d,[t,n,r]))})),0===p&&(o("Could not find games for chess.com user "+t),s([],!1))};m()("https://api.chess.com/pub/player/".concat(t,"/games/archives"),(function(e,a,n){if(e)o("Failed to connect to chess.com. chess.com might be down at the moment",null,"Some addons like 'Piracy Badger' can also cause this."),s([],!1);else if(404===a.statusCode)o("Could not find chess.com user "+t),s([],!1);else if(200!==a.statusCode)o("Could not load games for chess.com user "+t),s([],!1);else if(a.body)try{var r=JSON.parse(a.body);v(r)}catch(i){o("Could not find games for chess.com user "+t),s([],!1)}}))},k=function(){function e(t,a,r,s,o,i){var l=this;Object(n.a)(this,e),a.forEach((function(e){l.setupReader(t,r,s,o,i).readAsText(e)}))}return Object(r.a)(e,[{key:"setupReader",value:function(e,t,a,n,r){var s=new FileReader,o=t===u.v?"White":"Black",i=e?e.toLowerCase():null;return s.onload=function(t){var a=f(t.target.result).split("\n\n\n").map((function(t){try{var a=Object(l.parse)(Object(v.e)(t))[0],n=a.headers[o];return e&&n&&!n.toLowerCase().includes(i)?null:a}catch(r){return console.log("failed to parse pgn",t),console.log(r),Object(h.a)(u.c,"parseFailedPGNFile",e),null}}));n(a.filter((function(e){return!!e})),!0)},s.onerror=function(e){r("Failed to load pgn file",null,e.target.error.name+":"+e.target.error.message),n([],!1)},s.onloadend=function(){n([],!1)},s}}]),e}(),O=a(218),N=a.n(O),j=function e(t,a,r,s,o,i){Object(n.a)(this,e);var c=r===u.v?"White":"Black";new b(t,!0,(function(e){200!==e&&i("Could not load url")}),(function(e){i("Could not connect to url"),o([],!1)}),(function(e){var t=e.map((function(e){try{return Object(l.parse)(e)[0]}catch(t){return console.log("Failed to parse pgn",e),console.log(t),Object(h.a)(u.c,"parseFailedPGNUrl"),null}}));return o(t.filter((function(e){return!!e&&!(a&&!a.includes(e.headers[c].toLowerCase()))})),!0)}),(function(){o([],!1)}))},S=function e(t,a,r,s,o){Object(n.a)(this,e);var i=t.pgnAliases?t.pgnAliases.map((function(e){return e.toLowerCase()})):null;new j(t.pgnUrl,i,a,r,s,o)},P=a(70);a.d(t,"a",(function(){return F}));var F=function(){function e(){Object(n.a)(this,e),this.totalGames=0,this.pendingGames=0,this.pendingDownloads=!0,N.a.mitm="download/download-mitm.html",this.fileWriter=null}return Object(r.a)(e,[{key:"stopDownloading",value:function(){this.fileWriter&&(this.fileWriter.close(),this.fileWriter=null)}},{key:"getPgnString",value:function(e){return"".concat(Object.entries(e.headers).map((function(e){return"[".concat(e[0],' "').concat(e[1],'"]')})).join("\n"),"\n                \n").concat(e.moves.map((function(e,t){return"".concat(t%2!==0?"":t/2+1+"."," ").concat(e.move)})).join(" ")," ").concat(e.result,"\n\n\n")}},{key:"fetchPGNFromSite",value:function(e,t,a,n,r,s,o,i,l,c,h){var p=this;if(this.continueProcessingGames=!0,s){var m=N.a.createWriteStream(P.a(a,e,t,r,"pgn"));this.fileWriter=m.getWriter()}var d=new TextEncoder,g=s?function(e,t){return p.fileWriter.write(d.encode(e.map((function(e){return p.getPgnString(e)})).join(""))).then((function(){t||p.stopDownloading()})),!0}:function(n,r){return n?(p.totalGames+=n.length,p.pendingGames+=n.length,p.pendingDownloads=r,setTimeout((function(){p.parsePGNTimed(a,n,o,t,0,e,i,l,c)}),1),p.continueProcessingGames):p.continueProcessingGames};a===u.z?new E(e,t,o,g,l):a===u.x?new C(e,t,o,g,l):a===u.B?new k(e,h,t,o,g,l):a===u.C?new S(n,t,o,g,l):a===u.y&&new S(r,t,o,g,l)}},{key:"parsePGNTimed",value:function(e,t,a,n,r,o,l,c,h){var p=this;if(r<t.length&&this.pendingGames--,!this.pendingDownloads&&this.pendingGames<=0&&h(),!(r>=t.length)&&this.continueProcessingGames){var m=t[r];if(m.moves[0]&&1===m.moves[0].move_number){var d=new i.a,g=this.gameResult(m,e),f=!1;m.moves.forEach((function(e){var t=d.fen(),a=d.move(e.move,{sloppy:!0}),r=d.fen();a?s.a.addMoveForFen(t,r,a,g,n):f=!0})),f&&(console.log("failed to load game ",m),c("Failed to load a game","".concat(o,":").concat(n)));var v=d.fen();s.a.addGameResultOnFen(v,g),s.a.addResultToRoot(g,n),this.continueProcessingGames=l(a[u.i],1,s.a)}setTimeout((function(){p.parsePGNTimed(e,t,a,n,r+1,o,l,c,h)}),1)}}},{key:"gameResult",value:function(e,t){var a=null;t===u.x?a=e.headers.Link:t===u.z&&(a=e.headers.Site);var n=null;return a||(n=e.headers),{result:e.result,white:e.headers.White,black:e.headers.Black,whiteElo:e.headers.WhiteElo,blackElo:e.headers.BlackElo,url:a,date:e.headers.Date,headers:n}}}]),e}()},353:function(e,t,a){"use strict";var n=a(13),r=a(16),s=a(28),o=a(29),i=a(30),l=a(696),c=a(689),u=a(769),h=a(0),p=a.n(h),m=a(682),d=a(731),g=a(732),f=a(733),v=a(775),b=a(355),E=a(2),y=a(54),w=a(31),C=[{label:"Fast time controls",selectedTimeControls:[E.E,E.J,E.D],unselectedTimeControls:[E.I,E.F,E.G]},{label:"Slow time controls",selectedTimeControls:[E.I,E.F,E.G],unselectedTimeControls:[E.E,E.J,E.D]},{label:"Reasonable time controls",selectedTimeControls:[E.D,E.I,E.F,E.G],unselectedTimeControls:[E.E,E.J]},{label:"Exclude slow time controls",selectedTimeControls:[E.E,E.J,E.D,E.I],unselectedTimeControls:[E.F,E.G]}];function k(e,t){return t.every((function(t){return e.includes(t)}))}var O=function(e,t){var a=Object(w.d)(e,t,!0),n=Object(w.d)(e,t,!1);return 0===n.length||0===a.length?"All time controls":1===a.length?y.d[a[0]]:1===n.length?"All except ".concat(y.d[n[0]]):2===a.length?"".concat(y.d[a[0]]," and ").concat(y.d[a[1]]):function(e,t){var a=C.filter((function(a){return k(t,a.unselectedTimeControls)&&k(e,a.selectedTimeControls)}));if(a.length)return a[0].label;return e.map((function(e){return y.d[e]})).join(", ")}(a,n)};var N=a(14);a.d(t,"a",(function(){return j}));var j=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={currentlyOpenAdvancedFilter:""},a.timeframeMarks=[{value:0,label:"Big bang"},{value:e.timeframeSteps.length-1,label:"Now"}],a.downloadLimitMarks=[{value:0,label:"0"},{value:E.n,label:"No limit"}],a.eloRangeMarks=[{value:0,label:"0"},{value:E.o,label:"No limit"}],a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"setCurrentlyOpenAdvancedFilter",value:function(e){var t=this;return function(){t.state.currentlyOpenAdvancedFilter===e&&(e=""),t.setState({currentlyOpenAdvancedFilter:e}),Object(N.a)(E.h,"AdvancedFilterChange",e)}}},{key:"getFilters",value:function(e){return p.a.createElement("div",null,this.subSectionComponent("Mode","all"===(s=this.props.advancedFilters.rated)?"Rated and casual":"rated"===s?"Rated only":"casual"===s?"Casual only":void 0,this.props.toggleRated),this.subSectionComponent("Time control",O(this.props.site,this.props.advancedFilters),this.setCurrentlyOpenAdvancedFilter("timeControl").bind(this),p.a.createElement(m.a,{isOpen:"timeControl"===this.state.currentlyOpenAdvancedFilter},this.getTimeControlFilters(e,4))),this.subSectionComponent("When played",(n=this.props.advancedFilters[E.l],r=this.props.timeframeSteps,Object(w.c)(n,r).label),this.setCurrentlyOpenAdvancedFilter("whenPlayed").bind(this),p.a.createElement(m.a,{isOpen:"whenPlayed"===this.state.currentlyOpenAdvancedFilter},this.getTimeFrameFilters())),this.subSectionComponent("Opponent elo range",0===(a=this.props.advancedFilters[E.j])[0]&&a[1]===E.o?"All elo ratings":0===a[0]?"Below ".concat(a[1]):a[1]===E.o?"Above ".concat(a[0]):"Between ".concat(a[0]," and ").concat(a[1]),this.setCurrentlyOpenAdvancedFilter("eloRange").bind(this),p.a.createElement(m.a,{isOpen:"eloRange"===this.state.currentlyOpenAdvancedFilter},this.getEloRangeFilters())),this.subSectionComponent("Download limit",(t=this.props.advancedFilters[E.i])>=E.n?"No limit":"".concat(t," games"),this.setCurrentlyOpenAdvancedFilter("downloadLimit").bind(this),p.a.createElement(m.a,{isOpen:"downloadLimit"===this.state.currentlyOpenAdvancedFilter},this.getDownloadLimitFilters())));var t,a,n,r,s}},{key:"getDownloadLimitFilters",value:function(){return p.a.createElement(v.a,{className:"sliderCustom",value:this.props.advancedFilters[E.i],onChange:this.props.handleDownloadLimitChange,valueLabelDisplay:"auto",valueLabelFormat:function(e){return e>=E.n?"All":e},step:100,min:0,marks:this.downloadLimitMarks,max:E.n})}},{key:"getTimeFrameFilters",value:function(){var e=this;return p.a.createElement(v.a,{className:"sliderCustom",value:this.props.advancedFilters[E.l],onChange:this.props.handleTimeframeChange,valueLabelDisplay:"off",valueLabelFormat:function(t){return e.props.timeframeSteps[t].label},step:1,marks:this.timeframeMarks,min:0,max:this.props.timeframeSteps.length-1})}},{key:"getEloRangeFilters",value:function(){return p.a.createElement(v.a,{className:"sliderCustom",value:this.props.advancedFilters[E.j],onChange:this.props.handleEloRangeChange,valueLabelDisplay:"off",marks:this.eloRangeMarks,min:0,max:E.o})}},{key:"getTimeControlFilters",value:function(e){var t=null,a=null,n=null,r=null;return"lichess"===e?(t=[E.E,E.J],a=[E.D,E.F],n=[E.I,E.G],r="4"):(t=[E.E,E.D],n=[E.I,E.H],r="6"),p.a.createElement(l.a,null,p.a.createElement(c.a,null,p.a.createElement(d.a,null,this.getTimeControlFilterRow(t,r,"first"),a?this.getTimeControlFilterRow(a,r,"middle"):null,this.getTimeControlFilterRow(n,r,"last"))))}},{key:"getTimeControlFilterRow",value:function(e,t,a){var n=this,r="topBottomNegativeMargin";return"first"===a?r="bottomNegativeMargin":"last"===a&&(r="topNegativeMargin"),p.a.createElement(g.a,{className:r},e.map((function(e){return p.a.createElement(f.a,{sm:t,key:"ctrl".concat(e)},p.a.createElement(b.a,{className:"nomargin",control:p.a.createElement(u.a,{checked:n.props.advancedFilters[e],color:"primary",onChange:n.props.handleTimeControlChange,name:e}),label:y.d[e]}))})))}},{key:"subSectionComponent",value:function(e,t,a,n){return p.a.createElement("div",{className:"pgnloadersection"},e,": ",p.a.createElement("span",{className:"smallText"},"[",p.a.createElement("span",{className:"linkStyle",onClick:a},"change"),"]"),p.a.createElement("div",null,p.a.createElement("b",null,t)),n)}},{key:"render",value:function(){return this.getFilters(this.props.site)}}]),t}(p.a.Component)},367:function(e,t,a){e.exports=a(681)},448:function(e,t){},473:function(e,t){},475:function(e,t){},507:function(e,t){},508:function(e,t){},54:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return u}));var n,r=a(18),s=a(2),o=[s.J,s.E,s.D,s.I,s.F,s.G],i=[s.E,s.D,s.I,s.H],l=(n={},Object(r.a)(n,s.J,"Ultrabullet"),Object(r.a)(n,s.E,"Bullet"),Object(r.a)(n,s.D,"Blitz"),Object(r.a)(n,s.I,"Rapid"),Object(r.a)(n,s.F,"Classical"),Object(r.a)(n,s.G,"Correspondence"),Object(r.a)(n,s.H,"Daily"),n);function c(e){return e.replace(/^\s+|\s+$/g,"")}var u={100:800,99:677,98:589,97:538,96:501,95:470,94:444,93:422,92:401,91:383,90:366,89:351,88:336,87:322,86:309,85:296,84:284,83:273,82:262,81:251,80:240,79:230,78:220,77:211,76:202,75:193,74:184,73:175,72:166,71:158,70:149,69:141,68:133,67:125,66:117,65:110,64:102,63:95,62:87,61:80,60:72,59:65,58:57,57:50,56:43,55:36,54:29,53:21,52:14,51:7,50:0,49:-7,48:-14,47:-21,46:-29,45:-36,44:-43,43:-50,42:-57,41:-65,40:-72,39:-80,38:-87,37:-95,36:-102,35:-110,34:-117,33:-125,32:-133,31:-141,30:-149,29:-158,28:-166,27:-175,26:-184,25:-193,24:-202,23:-211,22:-220,21:-230,20:-240,19:-251,18:-262,17:-273,16:-284,15:-296,14:-309,13:-322,12:-336,11:-351,10:-366,9:-383,8:-401,7:-422,6:-444,5:-470,4:-501,3:-538,2:-589,1:-677,0:-800}},573:function(e,t){},681:function(e,t,a){"use strict";a.r(t);var n=a(23),r=a.n(n),s=a(13),o=a(16),i=a(28),l=a(29),c=a(68),u=a(30),h=a(0),p=a.n(h),m=a(97),d=a.n(m),g=a(326),f=a.n(g),v=(a(382),a(77)),b=a(328),E=a.n(b),y=a(46),w=a(2),C=function(){function e(){Object(s.a)(this,e),this.plys=[{pgn:"",fen:w.w,move:null}],this.currentIndex=0}return Object(o.a)(e,[{key:"addPly",value:function(e,t){if(!(this.currentIndex<this.plys.length-1&&this.plys[this.currentIndex+1].move.san===t.san))return this.plys=this.plys.slice(0,this.currentIndex+1),this.plys.push({pgnAsList:this.pgnAsList(t.san),fen:e,move:t}),this.currentIndex++,this.plys[this.currentIndex];this.moveForward()}},{key:"pgnAsList",value:function(e){var t,a=this.pgnListSoFar();if(t=a?Object(y.a)(a):[],this.plys.length%2!==0)t.push({moveNumber:t.length+1,whitePly:e,blackPly:""});else{var n=t[t.length-1];n.blackPly=e,t[t.length-1]=n}return t}},{key:"currentMove",value:function(){return Math.floor((this.currentIndex-1)/2)}},{key:"pgnListSoFar",value:function(){return this.plys[this.plys.length-1].pgnAsList}},{key:"fen",value:function(){return this.plys[this.currentIndex].fen}},{key:"moveForward",value:function(){return this.moveTo(this.currentIndex+1)}},{key:"moveBack",value:function(){return this.moveTo(this.currentIndex-1)}},{key:"moveTo",value:function(e){return e>=0&&e<this.plys.length&&(this.currentIndex=e),this.plys[this.currentIndex]}}]),e}(),k=a(731),O=a(732),N=a(733),j=a(329),S=a(32),P=a(25),F=a(14),x=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).openingManager=new C,a.state={currentMove:0},window.addEventListener("keydown",a.keyHandler.bind(Object(c.a)(a))),a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"keyHandler",value:function(e){switch(e.keyCode){case 37:this.previous(e,"keyboard");break;case 39:this.next(e,"keyboard")}}},{key:"shouldComponentUpdate",value:function(e){return e.fen===this.openingManager.fen()||(null===e.move?(this.openingManager=new C,!0):(this.openingManager.addPly(e.fen,e.move),!0))}},{key:"previous",value:function(e,t){var a=this.openingManager.moveBack();this.props.onChange(a.fen,a.move),this.setState({currentMove:this.openingManager.currentMove()}),Object(F.a)(w.g,"Previous",t||"mouse")}},{key:"next",value:function(e,t){var a=this.openingManager.moveForward();this.props.onChange(a.fen,a.move),this.setState({currentMove:this.openingManager.currentMove()}),Object(F.a)(w.g,"Next",t||"mouse")}},{key:"moveTo",value:function(e){var t=this;return function(){var a=t.openingManager.moveTo(2*e+1);t.props.onChange(a.fen,a.move),t.setState({currentMove:t.openingManager.currentMove()}),Object(F.a)(w.g,"move",null,e)}}},{key:"render",value:function(){var e=this,t=E()(this.openingManager.fen());return t&&(this.opening=t.name,this.openingCode=t.code),this.openingManager.pgnListSoFar()?p.a.createElement(k.a,null,p.a.createElement(O.a,null,p.a.createElement(N.a,{lg:"6",className:"navSection"},p.a.createElement(j.a,{color:"",className:"settingButton",onClick:this.previous.bind(this)},p.a.createElement(S.a,{icon:P.k})," prev")," "),p.a.createElement(N.a,{lg:"6",className:"navSection"},p.a.createElement(j.a,{color:"",className:"settingButton",onClick:this.next.bind(this)},"next ",p.a.createElement(S.a,{icon:P.l})))),p.a.createElement(O.a,{className:"greyText"},this.openingCode,": ",this.opening),this.openingManager.pgnListSoFar().map((function(t,a){return p.a.createElement(O.a,{key:"".concat(t.moveNumber),onClick:e.moveTo(a).bind(e),className:"navCol ".concat(e.openingManager.currentMove()===a?"selectedMove":"")},p.a.createElement(N.a,{sm:"12",className:"navMove border"},"".concat(t.moveNumber,". ").concat(t.whitePly," ").concat(t.blackPly)))}))):p.a.createElement("div",null)}}]),t}(p.a.Component),T=a(50),A=(a(387),a(734)),R=a(735),D=a(736),G=a(682),M=a(737),I=a(738),L=a(739),B=a(771),W=a(772),z=a(740),U=a(741),_=a(773),J=a(742),V=a(743),Y=a(744),H=a(745),K=function(e){var t=Object(h.useState)(!1),a=Object(T.a)(t,2),n=a[0],r=a[1],s=Object(h.useState)(!1),o=Object(T.a)(s,2),i=o[0],l=o[1],c=function(){return l(!i)},u=function(e){return function(){window.open(e,"_blank")}};return p.a.createElement("div",null,p.a.createElement(A.a,{color:"light",light:!0,expand:"md"},p.a.createElement("img",{src:"/opening-tree-logo.png",height:"32px",width:"32px",alt:"Logo"}),p.a.createElement(R.a,{href:"/"},"\xa0OpeningTree.com"),p.a.createElement(D.a,{onClick:function(){return r(!n)}}),p.a.createElement(G.a,{isOpen:n,navbar:!0},p.a.createElement(M.a,{className:"mr-auto",navbar:!0},p.a.createElement(I.a,null,p.a.createElement(L.a,{className:"navLinkButton",onClick:u("https://www.youtube.com/watch?v=AJ66-HqdpXE")},'"It\'s so powerful" - IM Eric Rosen ',p.a.createElement("span",{className:"smallText"},"[Watch video]")))),p.a.createElement(M.a,{className:"ml-auto",navbar:!0},p.a.createElement(I.a,null,p.a.createElement(L.a,{className:"navLinkButton",onClick:e.toggleFeedback},"Feedback"))),p.a.createElement(B.a,null,p.a.createElement(W.a,{className:"bootNavColor",nav:!0,caret:!0},"More"),p.a.createElement(z.a,{right:!0},p.a.createElement(U.a,{onClick:c},"Acknowledgements"),p.a.createElement(U.a,{onClick:u("https://www.openingtree.com/old")},"Old version"),p.a.createElement(U.a,{divider:!0}),p.a.createElement(U.a,{onClick:u("https://lichess.org/")},"Lichess"),p.a.createElement(U.a,{onClick:u("https://www.lichess4545.com/")},"Lichess4545"),p.a.createElement(U.a,{onClick:u("https://www.chess.com")},"Chess.com"))))),p.a.createElement(_.a,{isOpen:i,toggle:c},p.a.createElement(J.a,{toggle:c},"Acknowledgements"),p.a.createElement(V.a,{className:"acknowledgement"},p.a.createElement(Y.a,{tag:"a",href:"https://lichess.org/api",target:"_blank",action:!0},"Lichess API"),p.a.createElement(Y.a,{tag:"a",href:"https://www.chess.com/club/chess-com-developer-community",target:"_blank",action:!0},"Chess.com API"),p.a.createElement(Y.a,{tag:"a",href:"https://github.com/ruilisi/react-chessground",target:"_blank",action:!0},"ChessGround"),p.a.createElement(Y.a,{tag:"a",href:"https://github.com/jhlywa/chess.js",target:"_blank",action:!0},"Chess.js"),p.a.createElement(Y.a,{tag:"a",href:"https://github.com/niklasf/eco",target:"_blank",action:!0},"Eco"),p.a.createElement(Y.a,{tag:"a",href:"https://github.com/jimmywarting/StreamSaver.js",target:"_blank",action:!0},"StreamSaver.js"),p.a.createElement(Y.a,{tag:"a",href:"https://www.flaticon.com/authors/google/",target:"_blank",action:!0},"Icons made by google"),p.a.createElement(Y.a,{tag:"a",href:"https://www.flaticon.com/",target:"_blank",action:!0},"FlatIcons.com"),p.a.createElement(Y.a,{tag:"a",href:"https://www.freelogodesign.org",target:"_blank",action:!0},"Free logo design"),p.a.createElement(Y.a,{tag:"a",href:"https://github.com/kevinludwig/pgn-parser",target:"_blank",action:!0},"PGN Parser"),p.a.createElement(Y.a,{tag:"a",href:"https://www.npmjs.com/package/material-ui-dropzone",target:"_blank",action:!0},"Dropzone"),p.a.createElement(Y.a,{tag:"a",href:"https://www.pgnmentor.com",target:"_blank",action:!0},"PGN Mentor"),p.a.createElement(Y.a,{tag:"a",href:"https://www.twitch.tv/imrosen",target:"_blank",action:!0},"IM Eric Rosen")),p.a.createElement(H.a,null,p.a.createElement(j.a,{color:"secondary",onClick:c},"Done"))))},q=a(98),Q=a(31),$=a(24),Z=a(688),X=a(355),ee=a(357),te=a(687),ae=a(686),ne=a(113),re=a.n(ne),se=a(684),oe=a(333),ie=a.n(oe),le=a(335),ce=a.n(le),ue=a(154),he=a.n(ue),pe=a(691),me=a(334),de=a.n(me),ge=a(749),fe=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"getSourceOption",value:function(e,t){return e===w.z?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement("img",{alt:"lichess",className:"siteimage",src:"./lichesslogo.png"}),p.a.createElement("span",{className:"sourceName"}," lichess.org ")):e===w.x?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement("img",{alt:"chess.com",className:"siteimage",src:"./chesscomlogo.png"})):e===w.B?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement(ie.a,{className:"lowOpacity"}),p.a.createElement("span",{className:"sourceName"}," Upload PGN file")):e===w.y?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement(de.a,{className:"lowOpacity"}),p.a.createElement("span",{className:"sourceName"}," Notable chess events")):e===w.C?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement(ce.a,{className:"lowOpacity"}),p.a.createElement("span",{className:"sourceName"}," Notable chess players")):e===w.A?p.a.createElement("span",null,t?Object($.d)("done",t):null,p.a.createElement(he.a,{className:"lowOpacity"}),p.a.createElement("span",{className:"sourceName"}," Openingtree file ",p.a.createElement(ge.a,{className:"sourceName",color:"secondary"},"New"))):p.a.createElement("span",null,Object($.d)(1,t),"Select a source")}},{key:"render",value:function(){return p.a.createElement($.a,{TransitionComponent:se.a,TransitionProps:{timeout:w.m},expanded:"source"===this.props.expandedPanel,onChange:this.props.handleExpansionChange},p.a.createElement(ae.a,{expandIcon:p.a.createElement(re.a,null),"aria-controls":"panel1c-content",id:"panel1c-header"},p.a.createElement("div",null,this.getSourceOption(this.props.site,!0))),p.a.createElement(te.a,null,p.a.createElement(Z.a,{onChange:this.props.siteChange,value:this.props.site},p.a.createElement(X.a,{className:"sitelabel",value:w.z,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.z)}),p.a.createElement(X.a,{className:"sitelabel",value:w.x,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.x)}),p.a.createElement(X.a,{className:"sitelabel",value:w.A,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.A)}),p.a.createElement(pe.a,{className:"dividerMargin"}),p.a.createElement(X.a,{className:"sitelabel",value:w.C,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.C)}),p.a.createElement(X.a,{className:"sitelabel",value:w.y,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.y)}),p.a.createElement(X.a,{className:"sitelabel",value:w.B,control:p.a.createElement(ee.a,{color:"primary"}),label:this.getSourceOption(w.B)}))))}}]),t}(p.a.Component),ve=a(767),be=a(132),Ee=a(694),ye=a(351),we=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"handleFileChange",value:function(e){Object(F.a)(w.h,"FileSaved",e.length>0?e[0].name:null),this.props.filesChange(e)}},{key:"render",value:function(){return p.a.createElement(ye.a,{acceptedFiles:[],dropzoneText:this.props.dropzoneText,onChange:this.handleFileChange.bind(this),dropzoneParagraphClass:"dropzonetext",showFileNames:!0,useChipsForPreview:!0,previewChipProps:{className:"previewChip"},dropzoneClass:"dropzone",filesLimit:this.props.filesLimit,maxFileSize:3e12})}}]),t}(p.a.Component),Ce=a(341),ke=a.n(Ce),Oe=a(342),Ne=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).updateDetails=function(e){Object(F.a)(w.h,"NotableGameSelected",e.value),a.props.onChange(e)},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"renderDetails",value:function(e){return p.a.createElement("div",null,p.a.createElement("span",null,p.a.createElement(Oe.LazyLoadImage,{alt:e.name,className:"profilePicture",width:"40",height:"40",src:e.profile.imageUrl})),p.a.createElement("div",null,e.name),p.a.createElement("div",{className:"smallText"},e.profile.subText))}},{key:"render",value:function(){if(!this.props.list)return p.a.createElement("div",{className:"lowOpacity textCenter"},p.a.createElement("img",{alt:"loading",width:"25",height:"25",src:"./spinner.gif"})," Loading List");if(!this.props.list.length)return p.a.createElement("div",{className:"lowOpacity textCenter"}," Could not fetch list");var e=this.props.list.map((function(e){return Object(q.a)({},e,{value:e.name})}));return p.a.createElement(ke.a,{name:"goatPlayers",value:this.props.selectedDetail.value,options:e,placeholder:this.props.placeholder,renderOption:this.renderDetails,onChange:this.updateDetails})}}]),t}(p.a.Component),je=a(753),Se=a(754),Pe=a(755),Fe=a(756),xe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={playerName:"",files:[],selectedPlayer:{},selectedEvent:{}},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"editPlayerName",value:function(e){this.setState({playerName:e.target.value,playerNameError:""})}},{key:"filesChange",value:function(e){this.setState({files:e})}},{key:"notablePlayerChange",value:function(e){this.setState({selectedPlayer:e})}},{key:"notableEventChange",value:function(e){this.setState({selectedEvent:e})}},{key:"componentWillReceiveProps",value:function(){this.setState({playerNameError:""})}},{key:"validateInputDetailsSet",value:function(){if(this.props.site===w.y){if(!this.state.selectedEvent)return this.props.showError("Please select an event"),!1}else if(this.props.site===w.C){if(!this.state.selectedPlayer)return this.props.showError("Please select a player"),!1}else if(this.props.site===w.z||this.props.site===w.x){if(!this.state.playerName)return this.setState({playerNameError:"Please enter a username"}),!1}else if(this.props.site===w.B){if(0===this.state.files.length)return this.props.showError("Please upload a PGN file"),!1}else if(this.props.site===w.A&&0===this.state.files.length)return this.props.showError("Please upload an openingtree file"),!1;return!0}},{key:"finalPlayerName",value:function(e,t,a){return e===w.C?a.name:e===w.y?"":t}},{key:"setPlayerDetails",value:function(){this.validateInputDetailsSet()&&this.props.playerDetailsChange(this.finalPlayerName(this.props.site,this.state.playerName,this.state.selectedPlayer),this.state.files,this.state.selectedEvent,this.state.selectedPlayer)}},{key:"getSummary",value:function(){if(this.props.site===w.C){if(this.props.selectedPlayer&&this.props.selectedPlayer.name)return p.a.createElement("span",null,Object($.d)("done"),this.props.selectedPlayer.profile.title,"\xa0",p.a.createElement("b",null,this.props.selectedPlayer.name))}else if(this.props.site===w.z||this.props.site===w.x){if(this.props.playerName)return p.a.createElement("span",null,Object($.d)("done"),"User: ",p.a.createElement("b",null,this.props.playerName))}else if(this.props.site===w.B||this.props.site===w.A){if(1===this.props.files.length)return p.a.createElement("span",null,Object($.d)("done"),"File: ",p.a.createElement("b",null,this.props.files[0].name));if(this.props.files.length>1)return p.a.createElement("span",null,Object($.d)("done"),this.props.files.length," PGN files uploaded")}else if(this.props.site===w.y&&this.props.selectedEvent&&this.props.selectedEvent.name)return p.a.createElement("span",null,Object($.d)("done"),this.props.selectedEvent.name);return p.a.createElement("span",null,Object($.d)(2),"Player details")}},{key:"getPlayerNameInput",value:function(e,t){return p.a.createElement(ve.a,{className:"playernameField",name:"playerName",id:"playerNameTextBox",margin:"dense",onChange:this.editPlayerName.bind(this),label:e,variant:"outlined",value:this.state.playerName,helperText:this.state.playerNameError?this.state.playerNameError:t,error:!!this.state.playerNameError,onKeyUp:this.playerNameKeyUp.bind(this)})}},{key:"playerNameKeyUp",value:function(e){13===e.keyCode&&this.setPlayerDetails()}},{key:"getGoatDBSelection",value:function(){return p.a.createElement(Ne,{list:this.props.notablePlayers,placeholder:"Select a player",onChange:this.notablePlayerChange.bind(this),selectedDetail:this.state.selectedPlayer})}},{key:"getGoatDBEventSelection",value:function(){return p.a.createElement(Ne,{list:this.props.notableEvents,placeholder:"Select an event",onChange:this.notableEventChange.bind(this),selectedDetail:this.state.selectedEvent})}},{key:"getPgnFileSelection",value:function(){return p.a.createElement("div",null,p.a.createElement(we,{filesChange:this.filesChange.bind(this),filesLimit:10,dropzoneText:"Drag and drop up to 10 pgn files here or click here to select files"}),this.getPlayerNameInput("player name in PGN","Leave blank to load all games"))}},{key:"getOpeningTreeSelection",value:function(){return p.a.createElement("div",null,p.a.createElement(je.a,null,p.a.createElement(Se.a,{className:"singlePadding"},p.a.createElement(Pe.a,{className:"smallBottomMargin"},p.a.createElement(S.a,{icon:P.h,className:"lowOpacity"})," How it works"),p.a.createElement(Fe.a,{className:"smallText"},"If you plan to revisit the same player, you can save a ",p.a.createElement("b",null,".tree")," file locally by loading a tree and then clicking ",p.a.createElement("i",null,'"Save Openingtree"'),". To reload the same tree, drop the ",p.a.createElement("b",null,".tree")," file in the dropzone below."))),p.a.createElement("br",null),p.a.createElement(we,{filesChange:this.filesChange.bind(this),filesLimit:1,dropzoneText:"Drag and drop openingtree save file here or click here to select a file"}))}},{key:"getInputsToShow",value:function(){return this.props.site===w.B?this.getPgnFileSelection():this.props.site===w.z?this.getPlayerNameInput("lichess username"):this.props.site===w.x?this.getPlayerNameInput("chess.com username"):this.props.site===w.y?this.getGoatDBEventSelection():this.props.site===w.C?this.getGoatDBSelection():this.props.site===w.A?this.getOpeningTreeSelection():p.a.createElement("div",null)}},{key:"render",value:function(){return p.a.createElement($.a,{expanded:"user"===this.props.expandedPanel,TransitionComponent:se.a,TransitionProps:{timeout:w.m},onChange:this.props.handleExpansionChange,disabled:""===this.props.site},p.a.createElement(ae.a,{expandIcon:p.a.createElement(re.a,null)},this.getSummary()),p.a.createElement(te.a,null,this.getInputsToShow()),p.a.createElement(pe.a,null),p.a.createElement(Ee.a,null,p.a.createElement(be.a,{size:"small",color:"primary",onClick:this.setPlayerDetails.bind(this)},"Continue")))}}]),t}(p.a.Component),Te=a(343),Ae=a(345),Re=a(115),De=a.n(Re),Ge=a(70),Me=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={playerName:"",site:"",playerColor:a.props.settings.playerColor,isAdvancedFiltersOpen:!1,isGamesSubsectionOpen:!1,expandedPanel:"source",notablePlayers:null,notableEvents:null,files:[],selectedNotableEvent:{},selectedNotablePlayer:{}},a.timeframeSteps=Object(Q.e)(),a.state[w.l]=[0,a.timeframeSteps.length-1],a.state[w.i]=w.n,a.state[w.J]=!0,a.state[w.E]=!0,a.state[w.D]=!0,a.state[w.I]=!0,a.state[w.F]=!0,a.state[w.G]=!0,a.state[w.H]=!0,a.state[w.k]="all",a.state[w.j]=[0,w.o],a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"advancedFilters",value:function(){return Object(Q.a)(this.state,[w.J,w.E,w.D,w.I,w.G,w.H,w.F,w.k,w.l,w.i,w.j])}},{key:"handleExpansionChange",value:function(e){var t=this;return function(a,n){t.setState({expandedPanel:!!n&&e})}}},{key:"exportOpeningTreeObject",value:function(){return{object:{gamesProcessed:this.props.gamesProcessed,settings:this.props.settings,playerName:this.state.playername,site:this.state.site,advancedFilters:this.advancedFilters()},array:Object(y.a)(this.props.openingGraph.graph.nodes.entries())}}},{key:"importOpeningTreeObject",value:function(e){this.setState(Object(q.a)({},e.object.advancedFilters,{playerColor:e.object.settings.playerColor,site:e.object.site,playerName:e.object.settings.playerName})),v.a.setEntries(e.array),this.props.importCallback({settings:e.object.settings,gamesProcessed:e.object.gamesProcessed,openingGraph:v.a})}},{key:"playerDetailsChange",value:function(e,t,a,n){this.setState({playerName:e,expandedPanel:Ge.c(this.state.site,e,n)?"filters":"",files:t,selectedNotableEvent:a,selectedNotablePlayer:n}),Object(F.a)(w.h,"PlayerNameSaved")}},{key:"fetchGOATGames",value:function(e,t){var a=this;De.a.get(e,(function(e,n){if(e)return a.props.showError("Could not fetch player list. Failed to connect to DB."),void t([]);var r;try{r=JSON.parse(n.body).list}catch(s){console.log(s)}r?t(r):(a.props.showError("Failed to load games."),t([]))}))}},{key:"siteChange",value:function(e){var t=this,a=e.target.value;a!==w.C||this.state.notablePlayers||this.fetchGOATGames("https://goatchess.github.io/list.json",(function(e){t.setState({notablePlayers:e})})),a!==w.y||this.state.notableEvents||this.fetchGOATGames("https://goatevents.github.io/list.json",(function(e){t.setState({notableEvents:e})})),this.setState({site:a,expandedPanel:"user"}),Object(F.a)(w.h,"ChangeSite",a)}},{key:"filtersChange",value:function(e){this.setState(Object(q.a)({},e,{expandedPanel:""})),Object(F.a)(w.h,"FitlersSaved",this.state.site)}},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement("div",{className:"pgnloadersection"},p.a.createElement(fe,{expandedPanel:this.state.expandedPanel,handleExpansionChange:this.handleExpansionChange("source").bind(this),site:this.state.site,siteChange:this.siteChange.bind(this)}),p.a.createElement(xe,{expandedPanel:this.state.expandedPanel,playerName:this.state.playerName,handleExpansionChange:this.handleExpansionChange("user").bind(this),showError:this.props.showError,files:this.state.files,notablePlayers:this.state.notablePlayers,notableEvents:this.state.notableEvents,site:this.state.site,playerDetailsChange:this.playerDetailsChange.bind(this),pgnUrl:this.state.pgnUrl,selectedPlayer:this.state.selectedNotablePlayer,selectedEvent:this.state.selectedNotableEvent}),p.a.createElement(Te.a,{expandedPanel:this.state.expandedPanel,playerColor:this.state.playerColor,handleExpansionChange:this.handleExpansionChange("filters").bind(this),site:this.state.site,playerName:this.state.playerName,advancedFilters:this.advancedFilters(),timeframeSteps:this.timeframeSteps,filtersChange:this.filtersChange.bind(this),selectedNotablePlayer:this.state.selectedNotablePlayer})),p.a.createElement(Ae.a,{expandedPanel:this.state.expandedPanel,playerColor:this.state.playerColor,files:this.state.files,playerName:this.state.playerName,site:this.state.site,advancedFilters:this.advancedFilters(),notify:this.props.notify,showError:this.props.showError,onChange:this.props.onChange,setDownloading:this.props.setDownloading,clear:this.props.clear,isDownloading:this.props.isDownloading,switchToMovesTab:this.props.switchToMovesTab,gamesProcessed:this.props.gamesProcessed,selectedNotablePlayer:this.state.selectedNotablePlayer,selectedNotableEvent:this.state.selectedNotableEvent,exportOpeningTreeObject:this.exportOpeningTreeObject.bind(this),showInfo:this.props.showInfo,importOpeningTreeObject:this.importOpeningTreeObject.bind(this)}))}}]),t}(p.a.Component),Ie=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"toggle",value:function(e){var t=this;return function(){var a=t.props.settings[e]===w.v?w.u:w.v;t.props.onChange(e,a),Object(F.a)(w.b,"ChangeOrientation")}}},{key:"analyse",value:function(){window.open("https://www.lichess.org/analysis/standard/".concat(this.props.fen),"_blank"),Object(F.a)(w.b,"AnalyzeGame")}},{key:"resetAction",value:function(){this.props.reset(),Object(F.a)(w.b,"Reset")}},{key:"clearAction",value:function(){this.props.clear(),Object(F.a)(w.b,"Clear")}},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement(k.a,null,p.a.createElement(O.a,{sm:"12"},p.a.createElement(N.a,{sm:"6"},p.a.createElement(j.a,{className:"settingButton",onClick:this.toggle("orientation"),color:""},p.a.createElement("h3",null,p.a.createElement(S.a,{icon:P.j}))," Flip board")),p.a.createElement(N.a,{sm:"6"},p.a.createElement(j.a,{className:"settingButton",onClick:this.clearAction.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(S.a,{icon:P.m}))," Clear games")),p.a.createElement(N.a,{sm:"6"},p.a.createElement(j.a,{className:"settingButton",onClick:this.resetAction.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(S.a,{icon:P.g}))," Starting position")),p.a.createElement(N.a,{sm:"6"},p.a.createElement(j.a,{className:"settingButton",onClick:this.analyse.bind(this),color:""},p.a.createElement("h3",null,p.a.createElement(S.a,{icon:P.e}))," Computer analysis")))))}}]),t}(p.a.Component),Le=a(764),Be=a(765),We=a(8),ze=a.n(We),Ue=a(770),_e=a(763),Je=a(757),Ve=a(761),Ye=a(759),He=a(760),Ke=a(758),qe=a(762),Qe=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"eatClicks",value:function(e){e.stopPropagation()}},{key:"copyFen",value:function(){Object($.c)("fenField"),this.props.showInfo("FEN copied")}},{key:"getFenField",value:function(){return this.props.simplifiedView?null:p.a.createElement("div",{className:"fenDiv"},p.a.createElement(ve.a,{id:"fenField",multiline:!0,label:"FEN",rowsMax:"2",value:this.props.fen,inputProps:{style:{fontSize:12},spellCheck:!1},variant:"outlined",className:"fenField",margin:"dense",onClick:this.copyFen.bind(this)}))}},{key:"render",value:function(){var e=this;if(!this.props.moveDetails.lastPlayedGame)return p.a.createElement("div",null,this.getFenField(),p.a.createElement("div",{className:"infoMessage"},"No data to show. Please enter a lichess or chess.com user name in the",p.a.createElement("span",{className:"navLinkButton",onClick:function(){return e.props.switchToUserTab()}}," ",p.a.createElement(S.a,{icon:P.n})," User"),' tab and click "Load"'));var t={};return this.props.isOpen&&(t=Object(Q.b)(this.props.moveDetails.totalOpponentElo,this.props.moveDetails.whiteWins,this.props.moveDetails.draws,this.props.moveDetails.blackWins,this.props.settings.playerColor)),p.a.createElement("div",null,this.getFenField(),p.a.createElement(Je.a,{onClick:this.eatClicks},isNaN(t.performanceRating)?null:p.a.createElement(Ke.a,{className:"performanceRatingRow".concat(this.props.simplifiedView?" performanceHeader":"")},p.a.createElement(Ye.a,null,p.a.createElement(He.a,{className:"performanceRatingRow"},p.a.createElement("b",null,"Performance")),p.a.createElement(He.a,{className:"performanceRatingRow"},p.a.createElement("b",null,t.performanceRating)))),p.a.createElement(Ve.a,null,p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Results"),p.a.createElement(He.a,{className:"performanceRatingRow"},t.results)),isNaN(t.averageElo)?null:p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Avg opponent"),p.a.createElement(He.a,{className:"performanceRatingRow"},t.averageElo)),p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Score"),p.a.createElement(He.a,{className:"performanceRatingRow"},t.score)),this.props.simplifiedView||isNaN(t.averageElo)?null:p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Rating change"),p.a.createElement(He.a,{className:"performanceRatingRow"},t.ratingChange)),!this.props.simplifiedView&&this.props.moveDetails.bestWin?p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Best win"),p.a.createElement(He.a,{className:"performanceRatingRow"},this.props.moveDetails.bestWin," ",p.a.createElement(S.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.bestWinGame),icon:P.f}))):null,!this.props.simplifiedView&&this.props.moveDetails.worstLoss?p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Worst loss"),p.a.createElement(He.a,{className:"performanceRatingRow"},this.props.moveDetails.worstLoss," ",p.a.createElement(S.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.worstLossGame),icon:P.f}))):null,p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},"Last played"),p.a.createElement(He.a,{className:"performanceRatingRow"},this.removeQuestionMarksFromDate(this.props.moveDetails.lastPlayedGame.date)," ",p.a.createElement(S.a,{className:"pointerExternalLink",onClick:this.props.launchGame(this.props.moveDetails.lastPlayedGame),icon:P.f})))),this.props.simplifiedView?null:p.a.createElement(qe.a,null,p.a.createElement(Ye.a,null,p.a.createElement(He.a,{colSpan:"2"},"Calculated based on ",p.a.createElement("a",{href:"https://handbook.fide.com/chapter/B022017",target:"_blank",rel:"noopener noreferrer"},"FIDE regulations"))))))}},{key:"removeQuestionMarksFromDate",value:function(e){return-1===e.indexOf("?")?e:e.slice(0,e.indexOf("."))}}]),t}(p.a.Component),$e=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={openPerformanceIndex:null},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"move",value:function(e,t){var a=this;return function(){a.props.onMove(e,t),Object(F.a)(w.f,"MoveClicked")}}},{key:"componentDidUpdate",value:function(e,t){e.turnColor!==this.props.turnColor&&this.setState({openPerformanceIndex:null})}},{key:"togglePerformancePopover",value:function(e){var t=this;return function(a){null!==t.state.openPerformanceIndex?t.setState({openPerformanceIndex:null}):t.setState({openPerformanceIndex:e}),a.stopPropagation()}}},{key:"render",value:function(){var e=this;return this.props.movesToShow?p.a.createElement("div",null,this.props.gameResults&&this.props.gameResults.length>0?this.resultsTable():null,this.movesTable()):p.a.createElement("div",{className:"infoMessage"},"No moves to show. Please select a source from the",p.a.createElement("span",{className:"navLinkButton",onClick:function(){return e.props.switchToUserTab()}}," ",p.a.createElement(S.a,{icon:P.n})," User")," tab and enter the details.")}},{key:"resultsTable",value:function(){var e=this;return p.a.createElement(Je.a,null,p.a.createElement(Ve.a,null,this.props.gameResults.map((function(t){var a=e.player(t.white,t.whiteElo),n=e.player(t.black,t.blackElo);return p.a.createElement(Ye.a,{className:"moveRow",key:"".concat(t.url),onClick:e.props.launchGame(t)},p.a.createElement(He.a,null,"1-0"===t.result?p.a.createElement("b",null,a):a," ",t.result," ","0-1"===t.result?p.a.createElement("b",null,n):n))}))))}},{key:"player",value:function(e,t){return"".concat(e).concat(t?"(".concat(t,")"):"")}},{key:"getPopover",value:function(e){var t=this.state.openPerformanceIndex===e,a=this.props.movesToShow[e];return p.a.createElement(Ue.a,{trigger:"hover",placement:"right",isOpen:t,target:"performancePopover".concat(e),toggle:this.togglePerformancePopover(e)},p.a.createElement(Qe,{moveDetails:a.details,simplifiedView:!0,isOpen:t,launchGame:this.props.launchGame,settings:this.props.settings}))}},{key:"movesTable",value:function(){var e=this,t=this.props.movesToShow&&this.props.movesToShow.length>0;return p.a.createElement(Je.a,null,t?p.a.createElement(Ke.a,null,p.a.createElement(Ye.a,null,p.a.createElement(He.a,{size:"small",className:"smallCol"},p.a.createElement("b",null,"Move")),p.a.createElement(He.a,{size:"small",className:"smallCol"},p.a.createElement("b",null,"Games")),p.a.createElement(He.a,null,p.a.createElement("b",null,"Results")))):null,t?p.a.createElement(Ve.a,null,this.props.movesToShow.map((function(t,a){var n=e.player(t.details.lastPlayedGame.white,t.details.lastPlayedGame.whiteElo),r=e.player(t.details.lastPlayedGame.black,t.details.lastPlayedGame.blackElo),s=t.details.lastPlayedGame.result;return t.details.count>1?p.a.createElement(Ye.a,{className:"moveRow",key:"".concat(t.orig).concat(t.dest),onClick:e.move(t.orig,t.dest)},p.a.createElement(He.a,{size:"small",className:"smallCol"},t.san," "),p.a.createElement(He.a,{size:"small",id:"performancePopover".concat(a),className:"smallCol",onClick:e.togglePerformancePopover(a)},t.details.count," ",p.a.createElement(S.a,{className:"lowOpacity",icon:P.h}),e.getPopover(a)),p.a.createElement(He.a,null,p.a.createElement(_e.a,{className:"border",multi:!0},p.a.createElement(_e.a,{bar:!0,className:"whiteMove",value:"".concat(t.details.whiteWins/t.details.count*100)},t.details.whiteWins/t.details.count>.1?t.details.whiteWins:""),p.a.createElement(_e.a,{bar:!0,className:"grayMove",value:"".concat(t.details.draws/t.details.count*100)},t.details.draws/t.details.count>.1?t.details.draws:""),p.a.createElement(_e.a,{bar:!0,className:"blackMove",value:"".concat(t.details.blackWins/t.details.count*100)},t.details.blackWins/t.details.count>.1?t.details.blackWins:"")))):p.a.createElement(Ye.a,{className:"moveRow",key:"".concat(t.orig).concat(t.dest),onClick:e.move(t.orig,t.dest)},p.a.createElement(He.a,{size:"small",className:"smallCol"},t.san),p.a.createElement(He.a,{colSpan:"2"},n," ",s," ",r," ",p.a.createElement(S.a,{className:"pointerExternalLink",onClick:e.props.launchGame(t.details.lastPlayedGame),icon:P.f})))}))):null,p.a.createElement(qe.a,null,p.a.createElement(Ye.a,null,this.props.settings.playerName?t?p.a.createElement(He.a,{colSpan:"3"},"Showing moves that have been played ",this.props.turnColor===this.props.settings.playerColor?"by":"by others against"," ",p.a.createElement("b",null,this.props.settings.playerName)," in this position. ",p.a.createElement("b",null,this.props.settings.playerName)," is playing as ",p.a.createElement("b",null,this.props.settings.playerColor),"."):p.a.createElement(He.a,{colSpan:"3"},"No moves found played by ",this.props.turnColor===this.props.settings.playerColor?"by":"by others against"," ",p.a.createElement("b",null,this.props.settings.playerName)," in this position. ",p.a.createElement("b",null,this.props.settings.playerName)," is playing as ",p.a.createElement("b",null,this.props.settings.playerColor),"."):t?p.a.createElement(He.a,{colSpan:"3"},"Showing all moves that have been played by ",p.a.createElement("b",null,this.props.turnColor)," in this position."):p.a.createElement(He.a,{colSpan:"3"},"No moves found played by ",p.a.createElement("b",null,this.props.turnColor)," in this position."))))}}]),t}(p.a.Component),Ze=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={activeTab:"user",activeGame:null},a.toggleModal=function(){a.setState({activeGame:null})},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"launchGame",value:function(e){var t=this;return e.url?function(t){t.stopPropagation(),window.open(e.url,"_blank"),Object(F.a)(w.f,"ViewGameExternal")}:function(a){a.stopPropagation(),t.setState({activeGame:e})}}},{key:"toggle",value:function(e){this.state.activeTab!==e&&(this.setState({activeTab:e}),Object(F.a)(w.b,"activeTab:".concat(e)))}},{key:"switchToUserTab",value:function(){this.toggle("user")}},{key:"switchToMovesTab",value:function(){this.toggle("moves")}},{key:"render",value:function(){var e=this;return p.a.createElement("div",null,p.a.createElement(_.a,{isOpen:this.state.activeGame,toggle:this.toggleModal},p.a.createElement(J.a,{toggle:this.toggleModal},"Game details"),this.state.activeGame?p.a.createElement(Je.a,null,p.a.createElement(Ve.a,null,Object.entries(this.state.activeGame.headers).map((function(e){return e[1]?p.a.createElement(Ye.a,{className:"performanceRatingRow"},p.a.createElement(He.a,{className:"performanceRatingRow"},e[0]),p.a.createElement(He.a,{className:"performanceRatingRow"},e[1])):null})))):null,p.a.createElement(H.a,null,p.a.createElement(j.a,{color:"secondary",onClick:this.toggleModal},"Done"))),p.a.createElement(M.a,{tabs:!0},p.a.createElement(I.a,null,p.a.createElement(L.a,{className:ze()({active:"user"===this.state.activeTab}),onClick:function(){e.toggle("user")}},p.a.createElement(S.a,{icon:P.n})," ","user"===this.state.activeTab?"User":"")),p.a.createElement(I.a,null,p.a.createElement(L.a,{className:ze()({active:"moves"===this.state.activeTab}),onClick:function(){e.toggle("moves")}},p.a.createElement(S.a,{icon:P.i})," ","moves"===this.state.activeTab?"Moves":"")),p.a.createElement(I.a,null,p.a.createElement(L.a,{className:ze()({active:"report"===this.state.activeTab}),onClick:function(){e.toggle("report")}},p.a.createElement(S.a,{icon:P.c})," ","report"===this.state.activeTab?"Report":"")),p.a.createElement(I.a,null,p.a.createElement(L.a,{className:ze()({active:"settings"===this.state.activeTab}),onClick:function(){e.toggle("settings")}},p.a.createElement(S.a,{icon:P.d})," ","settings"===this.state.activeTab?"Controls":""))),p.a.createElement(Le.a,{activeTab:this.state.activeTab},p.a.createElement(Be.a,{tabId:"user"},p.a.createElement(Me,{switchToMovesTab:this.switchToMovesTab.bind(this),clear:this.props.clear,gamesProcessed:this.props.gamesProcessed,settings:this.props.settings,onChange:this.props.settingsChange,notify:this.props.updateProcessedGames,showError:this.props.showError,showInfo:this.props.showInfo,setDownloading:this.props.setDownloading,isDownloading:this.props.isDownloading,openingGraph:this.props.openingGraph,importCallback:this.props.importCallback})),p.a.createElement(Be.a,{tabId:"moves"},p.a.createElement($e,{switchToUserTab:this.switchToUserTab.bind(this),movesToShow:this.props.movesToShow,gameResults:this.props.gameResults,onMove:this.props.onMove,settings:this.props.settings,turnColor:this.props.turnColor,settingsChange:this.props.settingsChange,launchGame:this.launchGame.bind(this)})),p.a.createElement(Be.a,{tabId:"report"},p.a.createElement(Qe,{fen:this.props.fen,simplifiedView:!1,moveDetails:this.props.openingGraph.getDetailsForFen(this.props.fen),launchGame:this.launchGame.bind(this),settings:this.props.settings,switchToUserTab:this.switchToUserTab.bind(this),isOpen:"report"===this.state.activeTab,showInfo:this.props.showInfo})),p.a.createElement(Be.a,{tabId:"settings"},p.a.createElement(O.a,null,p.a.createElement(N.a,{sm:"6"},p.a.createElement(Ie,{fen:this.props.fen,settings:this.props.settings,isOpen:!0,clear:this.props.clear,reset:this.props.reset,onChange:this.props.settingsChange}))))))}}]),t}(p.a.Component);function Xe(){return"w"===this.chess.turn()?w.v:w.u}function et(){return this.state.settings.playerColor}function tt(){return this.playerColor()===this.turnColor()?this.forBrushes:this.againstBrushes}function at(){var e=this,t={};return this.chess.SQUARES.forEach((function(a){var n=e.chess.moves({square:a,verbose:!0});n.length&&(t[a]=n.map((function(e){return e.to})))})),{free:!1,dests:t,color:this.turnColor()}}function nt(){return this.state.settings.orientation}function rt(e,t){var a=this.chess,n=a.move({from:e,to:t,promotion:"q"});this.setState({fen:a.fen(),lastMove:n})}function st(e,t){this.onMove(e,t),Object(F.a)(w.a,"Move")}function ot(e,t){this.chess=new d.a(e),this.setState({fen:e,lastMove:t})}function it(e,t,a){var n=this.state.gamesProcessed+t;return this.setState({gamesProcessed:n,openingGraph:a,downloadingGames:(n<e||e>=w.n)&&this.state.downloadingGames}),(n<e||e>=w.n)&&this.state.downloadingGames}function lt(e){return{orig:e.orig,dest:e.dest,brush:this.brushes()[e.level]}}function ct(){var e=this.movesToShow();if(e){var t=e.map(this.moveToShape.bind(this));return this.fillArray(t,25)}return this.fillArray([],25)}function ut(){if(!this.state.openingGraph.hasMoves)return null;var e=this.state.openingGraph.movesForFen(this.chess.fen());return e?e.sort((function(e,t){return t.details.count-e.details.count})):[]}function ht(){return this.state.openingGraph.gameResultsForFen(this.chess.fen())}function pt(e,t){for(var a=e.length;a<t;a++)e.push({orig:"i"+a,dest:"i"+(a+1),brush:this.brushes()[0]});return e}function mt(){this.chess=new d.a,this.setState({fen:this.chess.fen(),lastMove:null})}function dt(){this.state.openingGraph.clear(),this.state.gamesProcessed=0,this.reset()}function gt(e,t){var a=this.state.settings;a[e]=t,this.setState({settings:a})}function ft(e,t,a){this.setState({message:e,subMessage:a,messageSeverity:"error"});var n="errorShown";t&&(n=n+":"+t),Object(F.a)(w.e,n,e)}function vt(e,t){this.setState({message:e,messageSeverity:"success"}),Object(F.a)(w.e,"infoShown",t||e)}function bt(){this.setState({message:"",subMessage:""})}function Et(e){var t=this;return function(){var a=t.state.feedbackOpen;t.closeError(),t.setState({feedbackOpen:!a,diagnosticsDataOpen:e})}}function yt(e){this.setState({downloadingGames:e})}function wt(){this.setState({diagnosticsDataOpen:!this.state.diagnosticsDataOpen})}function Ct(){Object($.c)("diagnosticsText"),this.showInfo("Copied Diagnostics data")}function kt(e){this.setState({settings:e.settings,openingGraph:e.openingGraph,gamesProcessed:e.gamesProcessed})}function Ot(){return window.innerWidth<=768?"".concat(Math.round(95*window.innerWidth/100),"px"):window.innerWidth<=1024?"".concat(Math.round(40*window.innerWidth/100),"px"):"512px"}function Nt(){return"--------------------\n  ".concat(navigator.userAgent,"\n  -------------------\n  ").concat(JSON.stringify(this.state),"\n  -------------------\n  ")}function jt(){return"https://www.reddit.com/message/compose/?to=".concat(w.t,"&subject=").concat(this.getSubject(),"&message=%0D%0A%0D%0A%0D%0A").concat(this.getBody())}function St(){return"mailto:".concat(w.r,"?subject=").concat(this.getSubject(),"&body=%0D%0A%0D%0A%0D%0A").concat(this.getBody())}function Pt(){return this.state.diagnosticsDataOpen?"Possible Openingtree bug":"Feedback on Openingtree"}function Ft(){return this.state.diagnosticsDataOpen?this.getDiagnosticsValue():""}function xt(e){e.orientation=nt,e.turnColor=Xe,e.calcMovable=at,e.onMove=rt,e.onMoveAction=st,e.autoShapes=ct,e.updateProcessedGames=it,e.settingsChange=gt,e.reset=mt,e.clear=dt,e.navigateTo=ot,e.playerColor=et,e.fillArray=pt,e.brushes=tt,e.moveToShape=lt,e.movesToShow=ut,e.gameResults=ht,e.showError=ft,e.showInfo=vt,e.closeError=bt,e.toggleFeedback=Et.bind(e),e.setDownloading=yt,e.toggleDiagnosticsData=wt.bind(e),e.copyDiagnostics=Ct.bind(e),e.importGameState=kt,e.getDiagnosticsValue=Nt,e.getChessboardWidth=Ot,e.getEmailLink=St,e.getSubject=Pt,e.getBody=Ft.bind(e),e.getRedditLink=jt}var Tt=a(774),At=a(6),Rt=a(161),Dt=a.n(Rt),Gt=a(162),Mt=a.n(Gt),It=a(354),Lt=a(750),Bt=a(7),Wt=a(157),zt=a.n(Wt),Ut=a(163),_t=a.n(Ut),Jt=a(159),Vt=a.n(Jt),Yt=a(160),Ht=a.n(Yt),Kt=a(158),qt=a.n(Kt),Qt=a(5),$t={success:zt.a,warning:qt.a,error:Vt.a,info:Ht.a};var Zt=Object(Bt.a)((function(e){return{success:{backgroundColor:Dt.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:Mt.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}))((function(e){var t=e.classes,a=e.className,n=e.message,r=e.onClose,s=e.variant,o=e.subMessage,i=e.onReport,l=e.showReportButton,c=Object(At.a)(e,["classes","className","message","onClose","variant","subMessage","onReport","showReportButton"]),u=$t[s];return h.createElement(Lt.a,Object.assign({className:Object(Qt.a)(t[s],a),"aria-describedby":"client-snackbar",message:h.createElement("div",null,h.createElement("span",{id:"client-snackbar",className:t.message},h.createElement(u,{className:Object(Qt.a)(t.icon,t.iconVariant)}),n),o?h.createElement("div",{className:"smallText"},"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",o):null),action:[l?h.createElement(be.a,{key:"report",onClick:i,color:"inherit",size:"small"},"Report this"):null,h.createElement(It.a,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:r},h.createElement(_t.a,{className:t.icon}))]},c))})),Xt=a(766),ea=a(769),ta=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).chess=new d.a,xt(Object(c.a)(a)),a.state={fen:a.chess.fen(),lastMove:null,gamesProcessed:0,openingGraph:v.a,settings:{playerName:"",orientation:w.v,playerColor:""},message:"",downloadingGames:!1,feedbackOpen:!1,diagnosticsDataOpen:!1},a.chessboardWidth=a.getChessboardWidth(),a.forBrushes=["paleGrey","paleGreen","green"],a.againstBrushes=["paleRed","paleRed","red"],a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.lastMove?[this.state.lastMove.from,this.state.lastMove.to]:null,t=!!this.state.message;return p.a.createElement("div",{className:"rootView"},p.a.createElement(K,{toggleFeedback:this.toggleFeedback(!1)}),p.a.createElement(k.a,{className:"mainContainer"},p.a.createElement(O.a,null,p.a.createElement(N.a,{lg:{order:0,size:2},xs:{order:2}},p.a.createElement(x,{fen:this.state.fen,move:this.state.lastMove,onChange:this.navigateTo.bind(this)})),p.a.createElement(N.a,{lg:"6"},p.a.createElement(f.a,{height:this.chessboardWidth,width:this.chessboardWidth,orientation:this.orientation(),turnColor:this.turnColor(),movable:this.calcMovable(),lastMove:e,fen:this.state.fen,onMove:this.onMoveAction.bind(this),drawable:{enabled:!0,visible:!0,autoShapes:this.autoShapes()},style:{margin:"auto"}})),p.a.createElement(N.a,{lg:"4",className:"paddingTop"},p.a.createElement(Ze,{fen:this.state.fen,gamesProcessed:this.state.gamesProcessed,updateProcessedGames:this.updateProcessedGames.bind(this),settingsChange:this.settingsChange.bind(this),settings:this.state.settings,reset:this.reset.bind(this),clear:this.clear.bind(this),movesToShow:this.movesToShow(),gameResults:this.gameResults(),onMove:this.onMove.bind(this),turnColor:this.turnColor(),showError:this.showError.bind(this),showInfo:this.showInfo.bind(this),setDownloading:this.setDownloading.bind(this),isDownloading:this.state.downloadingGames,openingGraph:this.state.openingGraph,importCallback:this.importGameState.bind(this)})))),p.a.createElement(Tt.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t,autoHideDuration:6e3,onClose:this.closeError.bind(this)},p.a.createElement(Zt,{onClose:this.closeError.bind(this),variant:this.state.messageSeverity,message:this.state.message,subMessage:this.state.subMessage,showReportButton:"error"===this.state.messageSeverity,onReport:this.toggleFeedback(!0)})),p.a.createElement(_.a,{isOpen:this.state.feedbackOpen,toggle:this.toggleFeedback(!1)},p.a.createElement(J.a,{toggle:this.toggleFeedback(!1)},"Feedback"),p.a.createElement(Xt.a,null,"Your feedback is greatly appreciated. Reach out to me for feedback, suggestions, bug report or just a game of chess.",p.a.createElement("ul",null,p.a.createElement("li",null,"Email me: ",p.a.createElement("a",{rel:"noopener noreferrer",href:this.getEmailLink(),target:"_blank"},w.r)),p.a.createElement("li",null,"Message me on reddit ",p.a.createElement("a",{rel:"noopener noreferrer",href:this.getRedditLink(),target:"_blank"},"u/",w.t)),p.a.createElement("li",null,"Message me on lichess: ",p.a.createElement("a",{rel:"noopener noreferrer",href:"https://lichess.org/inbox/".concat(w.s),target:"_blank"},w.s)),p.a.createElement("li",null,"Message me on chess.com: ",p.a.createElement("a",{rel:"noopener noreferrer",href:"https://www.chess.com/messages/compose/".concat(w.p),target:"_blank"},w.p)),p.a.createElement("li",null,"Join my ",p.a.createElement("a",{rel:"noopener noreferrer",href:w.q,target:"_blank"},"discord server")," to chat")),p.a.createElement(X.a,{control:p.a.createElement(ea.a,{checked:this.state.diagnosticsDataOpen,onChange:this.toggleDiagnosticsData,name:"diagnostics",color:"primary"}),label:"Add diagnostics data to message"}),p.a.createElement(G.a,{isOpen:this.state.diagnosticsDataOpen},p.a.createElement(ve.a,{id:"diagnosticsText",label:"Click to copy.",variant:"outlined",className:"fullWidth",value:this.getDiagnosticsValue(),rowsMax:4,onClick:this.copyDiagnostics,multiline:!0}))),p.a.createElement(H.a,null,p.a.createElement(j.a,{color:"secondary",onClick:this.toggleFeedback(!1)},"Done"))))}}]),t}(p.a.Component);r.a.render(p.a.createElement(ta,null),document.getElementById("root")),Object(F.b)()},70:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return i}));var n=a(2);function r(e){return e===n.x||e===n.z}function s(e,t){return e!==n.y&&e!==n.A&&!!t}function o(e,t,a,r){return t!==n.z&&t!==n.x?"Only supported for chess.com and lichess":e!==t||a<=0?"You need to analyze games before saving":r?"Action not supported while games are loading":""}function i(e,t,a,r,s){return e===n.y?"".concat(r.name,".").concat(s):t?"".concat(t,"-").concat(a,".").concat(s):"openingtree-exportedgames.".concat(s)}},77:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(13),r=a(16),s=a(31),o=a(2),i=function(){function e(){Object(n.a)(this,e),this.graph=new l,this.hasMoves=!1}return Object(r.a)(e,[{key:"setEntries",value:function(e){this.graph=new l(e),this.hasMoves=!0}},{key:"clear",value:function(){this.graph=new l,this.hasMoves=!1}},{key:"addGameResultOnFen",value:function(e,t){this.getNodeFromGraph(e).gameResults.push(t)}},{key:"addResultToRoot",value:function(e,t){var a=this.getNodeFromGraph(o.w),n=this.getUpdatedMoveDetails(a.details,e,t);a.details=n}},{key:"getDetailsForFen",value:function(e){return this.getNodeFromGraph(Object(s.h)(e)).details}},{key:"addMoveForFen",value:function(e,t,a,n,r){var s=this.getNodeFromGraph(t),o=this.getUpdatedMoveDetails(s.details,n,r);s.details=o;var i=this.getNodeFromGraph(e),l=this.createOrGetMoveNode(i.playedBy,a,t);i.playedByMax=Math.max(i.playedByMax,s.details.count),i.playedBy=l,this.hasMoves=!0}},{key:"getNodeFromGraph",value:function(e){var t=Object(s.h)(e),a=this.graph.nodes.get(t);return a||((a=new c).fen=t,this.graph.nodes.set(t,a)),a}},{key:"createOrGetMoveNode",value:function(e,t,a){var n=e[t.san];return n||((n=new u).move=t,n.fen=Object(s.h)(a),e[t.san]=n),e}},{key:"getUpdatedMoveDetails",value:function(e,t,a){var n=0,r=0,i=0,l=0,c=0;return"1-0"===t.result?(n=1,c=a===o.v?1:-1):"0-1"===t.result?(r=1,c=a===o.u?1:-1):i=1,l=a===o.v?t.blackElo:t.whiteElo,1===c&&(!e.bestWin||parseInt(l)>parseInt(e.bestWin))&&(e.bestWin=l,e.bestWinGame=t),-1===c&&(!e.worstLoss||parseInt(l)<parseInt(e.worstLoss))&&(e.worstLoss=l,e.worstLossGame=t),e.lastPlayedGame&&!Object(s.f)(t.date,e.lastPlayedGame.date)||(e.lastPlayedGame=t),e.count+=1,e.blackWins+=r,e.whiteWins+=n,e.draws+=i,e.totalOpponentElo+=parseInt(l),e}},{key:"gameResultsForFen",value:function(e){var t=Object(s.h)(e),a=this.graph.nodes.get(t);return a?a.gameResults:null}},{key:"movesForFen",value:function(e){var t=this,a=Object(s.h)(e),n=this.graph.nodes.get(a);return n?Array.from(Object.entries(n.playedBy)).map((function(e){var a=e[1],r=t.graph.nodes.get(a.fen);return{orig:a.move.from,dest:a.move.to,level:t.levelFor(r.details.count,n.playedByMax),san:a.move.san,details:r.details}})):null}},{key:"levelFor",value:function(e,t){return t<=0||e/t>.8?2:e/t>.3?1:0}}]),e}(),l=function e(t){var a=this;Object(n.a)(this,e),this.nodes=new Map,t&&t.forEach((function(e){a.nodes.set(e[0],e[1])}))},c=function e(){Object(n.a)(this,e),this.fen="",this.playedByMax=0,this.playedBy={},this.gameResults=[],this.properties={},this.details={count:0,blackWins:0,whiteWins:0,draws:0,totalOpponentElo:0,bestWin:null,bestWinGame:null,worstLoss:null,worstLossGame:null,lastPlayedGame:null}},u=function e(){Object(n.a)(this,e),this.fen="",this.move={}};var h=new i},91:function(e,t,a){"use strict";function n(e,t,a,r){this.message=e,this.expected=t,this.found=a,this.location=r,this.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,t){function a(){this.constructor=e}a.prototype=t.prototype,e.prototype=new a}(n,Error),n.buildMessage=function(e,t){var a={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,a="";for(t=0;t<e.parts.length;t++)a+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+a+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,r,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(r=e[t],a[r.type](r));if(s.sort(),s.length>0){for(t=1,n=1;t<s.length;t++)s[t-1]!==s[t]&&(s[n]=s[t],n++);s.length=n}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:n,parse:function(e,t){t=void 0!==t?t:{};var a,r={},s={start:be},o=be,i=function(e,t,a){return function(e,t,a,n){return{headers:(e=e||[]).reduce((function(e,t){return Object.assign(e,t)}),{}),comment:t,moves:a||[],result:n}}(e,t,a[0],a[1])},l={type:"any"},c=pe('"',!1),u=/^[^"]/,h=me(['"'],!0,!1),p=/^[1-9]/,m=me([["1","9"]],!1,!1),d=/^[0-9]/,g=me([["0","9"]],!1,!1),f=/^[A-Za-z0-9_\-]/,v=me([["A","Z"],["a","z"],["0","9"],"_","-"],!1,!1),b=function(e){return e.join("")},E=pe(" ",!1),y=pe("\f",!1),w=pe("\t",!1),C=pe("\n",!1),k=pe("[",!1),O=pe("]",!1),N=/^[NKQRBP]/,j=me(["N","K","Q","R","B","P"],!1,!1),S=/^[a-h]/,P=me([["a","h"]],!1,!1),F=/^[1-8]/,x=me([["1","8"]],!1,!1),T=pe("+",!1),A=pe("#",!1),R=/^[x@]/,D=me(["x","@"],!1,!1),G=pe(".",!1),M=pe("1-0",!1),I=pe("0-1",!1),L=pe("*",!1),B=pe("1/2-1/2",!1),W=pe("=",!1),z=/^[QRBNK]/,U=me(["Q","R","B","N","K"],!1,!1),_=pe("$",!1),J=pe("!!",!1),V=pe("??",!1),Y=pe("!?",!1),H=pe("?!",!1),K=pe("!",!1),q=pe("?",!1),Q=/^[^}]/,$=me(["}"],!0,!1),Z=pe("{",!1),X=pe("}",!1),ee=pe("O-O-O",!1),te=pe("O-O",!1),ae=function(e){return function e(t){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;n<t.length;n++)Array.isArray(t[n])?e(t[n],a):a.push(t[n]);return a}(e).join("")},ne=function(e,t,a){return a},re=function(e,t,a,n,r){return r},se=pe("(",!1),oe=pe(")",!1),ie=0,le=[{line:1,column:1}],ce=0,ue=[],he=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=s[t.startRule]}function pe(e,t){return{type:"literal",text:e,ignoreCase:t}}function me(e,t,a){return{type:"class",parts:e,inverted:t,ignoreCase:a}}function de(t){var a,n=le[t];if(n)return n;for(a=t-1;!le[a];)a--;for(n={line:(n=le[a]).line,column:n.column};a<t;)10===e.charCodeAt(a)?(n.line++,n.column=1):n.column++,a++;return le[t]=n,n}function ge(e,t){var a=de(e),n=de(t);return{start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:n.line,column:n.column}}}function fe(e){ie<ce||(ie>ce&&(ce=ie,ue=[]),ue.push(e))}function ve(e,t,a){return new n(n.buildMessage(e,t),e,t,a)}function be(){var t,a,n,s,o,i;if(t=ie,a=[],n=ie,(s=Ee())!==r){for(o=[],i=Oe();i!==r;)o.push(i),i=Oe();o!==r?n=s=[s,o]:(ie=n,n=r)}else ie=n,n=r;for(;n!==r;)if(a.push(n),n=ie,(s=Ee())!==r){for(o=[],i=Oe();i!==r;)o.push(i),i=Oe();o!==r?n=s=[s,o]:(ie=n,n=r)}else ie=n,n=r;return a!==r&&(n=function(){var t,a;t=ie,he++,e.length>ie?(a=e.charAt(ie),ie++):(a=r,0===he&&fe(l));he--,a===r?t=void 0:(ie=t,t=r);return t}())!==r?(t,t=a=a.map((function(e){return e[0]}))):(ie=t,t=r),t}function Ee(){var e,t,a,n,s,o,l,c;if(e=ie,(t=function(){var e,t,a;if(e=ie,t=[],(a=Ne())!==r)for(;a!==r;)t.push(a),a=Ne();else t=r;t!==r&&(e,t=t);return e=t}())===r&&(t=null),t!==r)if((a=Ge())===r&&(a=null),a!==r){for(n=[],s=ke();s!==r;)n.push(s),s=ke();if(n!==r){if(s=ie,(o=Be())!==r){if(l=[],(c=ke())!==r)for(;c!==r;)l.push(c),c=ke();else l=r;l!==r&&(c=Te())!==r?(s,s=o=[o,c]):(ie=s,s=r)}else ie=s,s=r;if(s===r&&(s=ie,(o=Te())!==r&&(s,o=function(e,t,a){return[null,a]}(0,0,o)),s=o),s!==r){for(o=[],l=ke();l!==r;)o.push(l),l=ke();o!==r?(e,e=t=i(t,a,s)):(ie=e,e=r)}else ie=e,e=r}else ie=e,e=r}else ie=e,e=r;else ie=e,e=r;return e}function ye(){var t;return 34===e.charCodeAt(ie)?(t='"',ie++):(t=r,0===he&&fe(c)),t}function we(){var t,a,n,s;if(t=ie,p.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&fe(m)),a!==r){for(n=[],d.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&fe(g));s!==r;)n.push(s),d.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&fe(g));n!==r?(t,t=a=parseInt(a+n.join(""),10)):(ie=t,t=r)}else ie=t,t=r;return t}function Ce(){var t;return 32===e.charCodeAt(ie)?(t=" ",ie++):(t=r,0===he&&fe(E)),t===r&&(12===e.charCodeAt(ie)?(t="\f",ie++):(t=r,0===he&&fe(y)),t===r&&(9===e.charCodeAt(ie)?(t="\t",ie++):(t=r,0===he&&fe(w)))),t}function ke(){var e;return(e=Ce())===r&&(e=Oe()),e}function Oe(){var t;return 10===e.charCodeAt(ie)?(t="\n",ie++):(t=r,0===he&&fe(C)),t}function Ne(){var t,a,n,s,o,i,l,c;if(t=ie,91===e.charCodeAt(ie)?(a="[",ie++):(a=r,0===he&&fe(k)),a!==r)if((n=function(){var t,a,n;if(t=ie,a=[],f.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&fe(v)),n!==r)for(;n!==r;)a.push(n),f.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&fe(v));else a=r;return a!==r&&(t,a=b(a)),t=a}())!==r){if(s=[],(o=Ce())!==r)for(;o!==r;)s.push(o),o=Ce();else s=r;if(s!==r)if((o=function(){var t,a,n;if(t=ie,ye()!==r){for(a=[],u.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&fe(h));n!==r;)a.push(n),u.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&fe(h));a!==r&&(n=ye())!==r?(t,t=a.join("")):(ie=t,t=r)}else ie=t,t=r;return t}())!==r)if(93===e.charCodeAt(ie)?(i="]",ie++):(i=r,0===he&&fe(O)),i!==r){for(l=[],c=ke();c!==r;)l.push(c),c=ke();l!==r?(t,t=a=function(e,t){var a={};return a[e]=t,a}(n,o)):(ie=t,t=r)}else ie=t,t=r;else ie=t,t=r;else ie=t,t=r}else ie=t,t=r;else ie=t,t=r;return t}function je(){var t;return N.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&fe(j)),t}function Se(){var t;return S.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&fe(P)),t}function Pe(){var t;return F.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&fe(x)),t}function Fe(){var t;return R.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&fe(D)),t}function xe(){var t;return 46===e.charCodeAt(ie)?(t=".",ie++):(t=r,0===he&&fe(G)),t}function Te(){var t;return"1-0"===e.substr(ie,3)?(t="1-0",ie+=3):(t=r,0===he&&fe(M)),t===r&&("0-1"===e.substr(ie,3)?(t="0-1",ie+=3):(t=r,0===he&&fe(I)),t===r&&(42===e.charCodeAt(ie)?(t="*",ie++):(t=r,0===he&&fe(L)),t===r&&("1/2-1/2"===e.substr(ie,7)?(t="1/2-1/2",ie+=7):(t=r,0===he&&fe(B))))),t}function Ae(){var e,t,a;return e=ie,(t=Se())!==r&&(a=Pe())!==r?(e,e=t=t+a):(ie=e,e=r),e}function Re(){var t,a,n,s;return t=ie,a=ie,36===e.charCodeAt(ie)?(n="$",ie++):(n=r,0===he&&fe(_)),n!==r&&(s=we())!==r?a=n=[n,s]:(ie=a,a=r),a!==r&&(t,a=b(a)),t=a}function De(){var t;return Q.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&fe($)),t}function Ge(){var t,a,n,s;if(t=ie,123===e.charCodeAt(ie)?(a="{",ie++):(a=r,0===he&&fe(Z)),a!==r){for(n=[],s=De();s!==r;)n.push(s),s=De();n!==r?(125===e.charCodeAt(ie)?(s="}",ie++):(s=r,0===he&&fe(X)),s!==r?(t,t=a=n.join("")):(ie=t,t=r)):(ie=t,t=r)}else ie=t,t=r;return t}function Me(){var t,a,n,s;return t=ie,a=ie,(n=Se())!==r&&(s=Fe())!==r?a=n=[n,s]:(ie=a,a=r),a===r&&(a=null),a!==r&&(n=Ae())!==r?((s=function(){var t,a,n;return t=ie,61===e.charCodeAt(ie)?(a="=",ie++):(a=r,0===he&&fe(W)),a!==r?(z.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&fe(U)),n!==r?t=a=[a,n]:(ie=t,t=r)):(ie=t,t=r),t}())===r&&(s=null),s!==r?t=a=[a,n,s]:(ie=t,t=r)):(ie=t,t=r),t}function Ie(){var t,a,n,s,o,i;return t=ie,a=ie,(n=function(){var e,t,a,n;return e=ie,(t=xe())!==r&&(a=xe())!==r&&(n=xe())!==r?e=t=[t,a,n]:(ie=e,e=r),e}())===r&&(n=null),n!==r?((s=function(){var t;return"O-O-O"===e.substr(ie,5)?(t="O-O-O",ie+=5):(t=r,0===he&&fe(ee)),t===r&&("O-O"===e.substr(ie,3)?(t="O-O",ie+=3):(t=r,0===he&&fe(te))),t}())===r&&(s=function(){var e,t,a,n,s;return e=ie,(t=je())!==r?((a=Se())===r&&(a=Pe()),a!==r?((n=Fe())===r&&(n=null),n!==r&&(s=Ae())!==r?e=t=[t,a,n,s]:(ie=e,e=r)):(ie=e,e=r)):(ie=e,e=r),e}())===r&&(s=function(){var e,t,a,n;return e=ie,(t=je())!==r?((a=Fe())===r&&(a=null),a!==r&&(n=Ae())!==r?e=t=[t,a,n]:(ie=e,e=r)):(ie=e,e=r),e}())===r&&(s=Me()),s!==r?((o=function(){var t;return 43===e.charCodeAt(ie)?(t="+",ie++):(t=r,0===he&&fe(T)),t}())===r&&(o=function(){var t;return 35===e.charCodeAt(ie)?(t="#",ie++):(t=r,0===he&&fe(A)),t}()),o===r&&(o=null),o!==r?((i=function(){var t;return"!!"===e.substr(ie,2)?(t="!!",ie+=2):(t=r,0===he&&fe(J)),t===r&&("??"===e.substr(ie,2)?(t="??",ie+=2):(t=r,0===he&&fe(V)),t===r&&("!?"===e.substr(ie,2)?(t="!?",ie+=2):(t=r,0===he&&fe(Y)),t===r&&("?!"===e.substr(ie,2)?(t="?!",ie+=2):(t=r,0===he&&fe(H)),t===r&&(33===e.charCodeAt(ie)?(t="!",ie++):(t=r,0===he&&fe(K)),t===r&&(63===e.charCodeAt(ie)?(t="?",ie++):(t=r,0===he&&fe(q))))))),t}())===r&&(i=null),i!==r?a=n=[n,s,o,i]:(ie=a,a=r)):(ie=a,a=r)):(ie=a,a=r)):(ie=a,a=r),a!==r&&(t,a=ae(a)),t=a}function Le(){var e,t,a,n,s,o,i,l,c,u;if(e=ie,(t=function(){var e,t,a,n,s,o;return e=ie,(t=we())!==r?((a=xe())===r&&(a=null),a!==r?(n=ie,(s=xe())!==r&&(o=xe())!==r?n=s=[s,o]:(ie=n,n=r),n===r&&(n=null),n!==r?(e,e=t=t):(ie=e,e=r)):(ie=e,e=r)):(ie=e,e=r),e}())===r&&(t=null),t!==r){for(a=[],n=ke();n!==r;)a.push(n),n=ke();if(a!==r)if((n=Ie())!==r){if(s=[],o=ie,i=[],(l=ke())!==r)for(;l!==r;)i.push(l),l=ke();else i=r;for(i!==r&&(l=Re())!==r?(o,o=i=ne(0,0,l)):(ie=o,o=r);o!==r;){if(s.push(o),o=ie,i=[],(l=ke())!==r)for(;l!==r;)i.push(l),l=ke();else i=r;i!==r&&(l=Re())!==r?(o,o=i=ne(0,0,l)):(ie=o,o=r)}if(s!==r){if(o=ie,i=[],(l=ke())!==r)for(;l!==r;)i.push(l),l=ke();else i=r;if(i!==r&&(l=Ge())!==r?(o,o=i=l):(ie=o,o=r),o===r&&(o=null),o!==r){if(i=[],l=ie,c=[],(u=ke())!==r)for(;u!==r;)c.push(u),u=ke();else c=r;for(c!==r&&(u=We())!==r?(l,l=c=re(0,0,0,0,u)):(ie=l,l=r);l!==r;){if(i.push(l),l=ie,c=[],(u=ke())!==r)for(;u!==r;)c.push(u),u=ke();else c=r;c!==r&&(u=We())!==r?(l,l=c=re(0,0,0,0,u)):(ie=l,l=r)}i!==r?(e,e=t=function(e,t,a,n,r){var s={};return e&&(s.move_number=e),t&&(s.move=t),a&&a.length&&(s.nags=a),n&&n.length&&(s.ravs=n),r&&(s.comment=r),s}(t,n,s,i,o)):(ie=e,e=r)}else ie=e,e=r}else ie=e,e=r}else ie=e,e=r;else ie=e,e=r}else ie=e,e=r;return e}function Be(){var e,t,a,n,s,o,i,l;if(e=ie,(t=Le())!==r){if(a=[],n=ie,s=[],(o=ke())!==r)for(;o!==r;)s.push(o),o=ke();else s=r;for(s!==r&&(o=Le())!==r?n=s=[s,o]:(ie=n,n=r);n!==r;){if(a.push(n),n=ie,s=[],(o=ke())!==r)for(;o!==r;)s.push(o),o=ke();else s=r;s!==r&&(o=Le())!==r?n=s=[s,o]:(ie=n,n=r)}a!==r?(e,l=a,e=t=(i=t)?[i].concat(l.map((function(e){return e[1]}))):[]):(ie=e,e=r)}else ie=e,e=r;return e}function We(){var t,a,n,s,o,i,l,c;if(t=ie,40===e.charCodeAt(ie)?(a="(",ie++):(a=r,0===he&&fe(se)),a!==r){for(n=[],s=ke();s!==r;)n.push(s),s=ke();if(n!==r)if((s=Be())!==r){for(o=[],i=ke();i!==r;)o.push(i),i=ke();if(o!==r)if((i=Te())===r&&(i=null),i!==r){for(l=[],c=ke();c!==r;)l.push(c),c=ke();l!==r?(41===e.charCodeAt(ie)?(c=")",ie++):(c=r,0===he&&fe(oe)),c!==r?(t,t=a={moves:s,result:i}):(ie=t,t=r)):(ie=t,t=r)}else ie=t,t=r;else ie=t,t=r}else ie=t,t=r;else ie=t,t=r}else ie=t,t=r;return t}if((a=o())!==r&&ie===e.length)return a;throw a!==r&&ie<e.length&&fe({type:"end"}),ve(ue,ce<e.length?e.charAt(ce):null,ce<e.length?ge(ce,ce+1):ge(ce,ce))}}}},[[367,1,2]]]);
//# sourceMappingURL=main.4b74af93.chunk.js.map