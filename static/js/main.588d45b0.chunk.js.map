{"version":3,"sources":["pres/DarkMode.js","app/Analytics.js","app/OpeningGraph.js","app/UserProfile.js","app/Constants.js","app/OpeningTreeSerializer.js","pres/loader/Common.js","pres/MainContainer.js","app/util.js","pres/GlobalHeader.js","pres/loader/Filters.js","pres/loader/Actions.js","app/PGNReaderWorker.js","pres/StateManagement.js","app/OpeningBook.js","pres/SnackbarContentWrapper.js","pres/loader/Source.js","pres/loader/Dropzone.js","pres/loader/NotableChessGames.js","pres/loader/User.js","pres/loader/Variants.js","pres/loader/PGNLoader.js","pres/Settings.js","pres/ReportControls.js","pres/moves/MovesCommon.js","pres/moves/MovesSettings.js","pres/moves/MovesTable.js","pres/moves/ResultsTable.js","pres/moves/MovesList.js","pres/moves/BookMoves.js","pres/ControlsContainer.js","pres/loader/TimeControlLabels.js","pres/loader/FilterLabels.js","pres/loader/AdvancedFilters.js","app/OpeningManager.js","pres/Navigator.js","index.js","app/PGNReader.js","app/CookieManager.js","app/Common.js","app/chess/RacingKingsChess.js","app/chess/CrazyhouseChess.js","app/chess/ChessLogic.js","app/SitePolicy.js"],"names":["handleDarkMode","darkMode","document","body","classList","contains","toggle","logoName","rowContentColor","initializeAnalytics","segment","openingBookType","ReactGA","initialize","set","dimension2","dimension1","dimension3","trackPageView","pageview","window","location","pathname","trackEvent","category","action","label","value","nonInteraction","event","OpeningGraph","variant","this","graph","Graph","hasMoves","arrayEntries","pgnStats","parsedMoves","lastFen","playerColor","index","length","push","forEach","parsedMove","addMoveForFen","sourceFen","targetFen","moveSan","addGameResultOnFen","addStatsToRoot","fullFen","resultIndex","currNode","getNodeFromGraph","gameResults","targetNode","rootFen","details","hasData","blackWins","whiteWins","draws","totalOpponentElo","shortestGame","longestGame","lastPlayed","newDetails","getUpdatedMoveDetails","node","simplifiedFen","Number","isInteger","updateCalculatedValues","bestWin","bestWinGame","bestWinElo","getOpponentElo","worstLoss","worstLossGame","worstLossElo","lastPlayedGame","longestGameInfo","shortestGameInfo","count","fullSourceFen","fullTargetFen","move","resultObject","playedBy","moveCount","playedByMax","Math","max","book","fen","transform","Map","moves","fetch","map","black","white","san","averageElo","averageRating","get","addIfNull","nodes","GraphNode","currentMoveDetails","whiteWin","blackWin","draw","resultInt","result","Constants","opponentElo","currentBestWinGame","parseInt","currentWorstLossGame","currentLastPlayedGame","isDateMoreRecentThan","date","currentLongestGame","numberOfPlys","currentShortestGame","blackElo","whiteElo","Array","from","Object","entries","entry","chess","chessLogic","sloppy","targetNodeDetails","getDetailsForFen","orig","dest","to","level","levelFor","maxCount","UserProfile","userProfile","visitInfo","cookieManager","getVisitInfo","userType","userTypeDesc","numVisits","USER_PROFILE_FIRST_TIME_USER","USER_PROFILE_NEW_USER","USER_PROFILE_OCCAISONAL_USER","currentVisit","firstVisit","lastVisit","USER_PROFILE_POWER_USER","USER_PROFILE_FREQUENT_USER","TIME_CONTROL_ULTRA_BULLET","TIME_CONTROL_BULLET","TIME_CONTROL_BLITZ","TIME_CONTROL_RAPID","TIME_CONTROL_CLASSICAL","TIME_CONTROL_CORRESPONDENCE","TIME_CONTROL_DAILY","FILTER_NAME_RATED","FILTER_NAME_SELECTED_TIMEFRAME","FILTER_NAME_DOWNLOAD_LIMIT","FILTER_NAME_ELO_RANGE","SITE_LICHESS","SITE_CHESS_DOT_COM","SITE_PGN_FILE","SITE_EVENT_DB","SITE_PLAYER_DB","SITE_OPENING_TREE_FILE","SITE_ONLINE_TOURNAMENTS","MAX_DOWNLOAD_LIMIT","MAX_ELO_RATING","EVENT_CATEGORY_PGN_LOADER","EVENT_CATEGORY_SETTINGS","EVENT_CATEGORY_LICHESS_LOGIN","EVENT_CATEGORY_MAIN_ACTION","EVENT_CATEGORY_MOVES_LIST","EVENT_CATEGORY_CONTROLS","EVENT_CATEGORY_NAVIGATOR","EVENT_CATEGORY_CHESSBOARD","EVENT_CATEGORY_MESSAGE_SHOWN","EVENT_CATEGORY_GLOBAL_HEADER","ROOT_FEN","RACING_KINGS_ROOT_FEN","PLAYER_COLOR_WHITE","PLAYER_COLOR_BLACK","LOADER_ANIMATION_DURATION_MS","OPENING_TREE_EMAIL","OPENING_TREE_REDDIT","OPENING_TREE_LICHESS","OPENING_TREE_CHESS_COM","OPENING_TREE_DISCORD","OPENING_TREE_FILE_CURRENT_VERSION","ERROR_ACTION_VISIT_OLD_SITE","ERROR_ACTION_NONE","LICHESS_NOT_LOGGED_IN","LICHESS_STATE_PENDING","LICHESS_LOGGED_IN","LICHESS_FAILED_FETCH","ERROR_SEVERITY_ERROR","ERROR_SEVERITY_SUCCESS","VARIANT_STANDARD","VARIANT_RACING_KINGS","VARIANT_THREE_CHECK","VARIANT_KING_OF_THE_HILL","VARIANT_CRAZYHOUSE","CHESS_COM_RULES_STANDARD","CHESS_COM_RULES_THREE_CHECK","CHESS_COM_RULES_KING_OF_THE_HILL","CHESS_COM_RULES_CRAZYHOUSE","LICHESS_PERF_RACING_KINGS","LICHESS_PERF_THREE_CHECK","LICHESS_PERF_KING_OF_THE_HILL","LICHESS_PERF_CRAZYHOUSE","LICHESS_PERF_STANDARD","LICHESS_HEADER_RACING_KINGS","LICHESS_HEADER_THREE_CHECK","LICHESS_HEADER_KING_OF_THE_HILL","LICHESS_HEADER_STANDARD","LICHESS_HEADER_CRAZYHOUSE","OPENING_BOOK_TYPE_OFF","OPENING_BOOK_TYPE_MASTERS","OPENING_BOOK_TYPE_LICHESS","ALL_BOOK_RATINGS","SETTING_NAME_ORIENTATION","SETTING_NAME_DARK_MODE","SETTING_NAME_MOVES_SETTINGS","serializeOpeningTree","treeData","filename","callback","chunkedArray","chunks","chunk","header","arraySizes","arrays","arr","array","prototype","apply","chunkSize","startIndex","i","chunkIndex","slice","chunkArray","deflatedChunks","packControlWord","remainingChunks","hasError","zlib","deflate","Buffer","JSON","stringify","error","data","byteLength","saveAs","Blob","type","deserializeOpeningTree","file","reader","FileReader","onload","evt","target","version","unpackControlWord","numChunks","handleInflate","console","log","parse","e","sortedChunks","sort","a","b","flattenedChunks","el","flat","size","reconstructObjectFromChunks","inflate","getInflatedChunks","onerror","name","message","readAsArrayBuffer","control","view","DataView","getUint16","getUint32","buffer","ArrayBuffer","setUint16","setUint32","Accordion","withStyles","root","border","boxShadow","borderBottom","display","margin","expanded","MUIAccordion","getNumberIcon","n","alt","className","src","height","advancedFilters","state","createSubObjectWithProperties","copyText","elementId","getElementById","select","setSelectionRange","execCommand","MainContainer","props","selectedVariant","URLSearchParams","search","addStateManagement","resize","lastMove","gamesProcessed","openingGraph","settings","playerName","orientation","movesSettings","getMovesSettingsFromCookie","getDarkModeSettingFromCookie","downloadingGames","feedbackOpen","diagnosticsDataOpen","update","highlightedMove","chessboardWidth","getChessboardWidth","forBrushes","againstBrushes","addEventListener","handleResize","bind","getUserProfile","setState","getSettingsCookie","openingBookRating","openingBookTimeControls","openingBookScoreIndicator","openingBookWinsIndicator","darkModeCookie","getDarkModeCookie","undefined","lastMoveArray","snackBarOpen","Boolean","playerMoves","getPlayerMoves","bookMoves","getBookMoves","mergePlayerAndBookMoves","settingsChange","toggleFeedback","lg","order","xs","onChange","navigateTo","key","width","turnColor","movable","calcMovable","onMove","onMoveAction","drawable","enabled","visible","autoShapes","style","updateProcessedGames","reset","clear","showError","showInfo","setDownloading","isDownloading","importCallback","importGameState","variantChange","forceFetchBookMoves","highlightArrow","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","closeError","messageSeverity","subMessage","showReportButton","errorAction","actionText","errorActionText","isOpen","rel","href","getEmailLink","getRedditLink","checked","toggleDiagnosticsData","color","id","getDiagnosticsValue","rowsMax","onClick","copyDiagnostics","multiline","setImmediate","React","Component","mainObject","properties","subObject","property","fenComponents","split","getTimeControlsArray","site","timeControlState","selected","Common","filter","timeControl","monthLabels","getTimeframeSteps","steps","year","startYear","currentYear","Date","getFullYear","currentMonth","getMonth","toLongLabel","fromLongLabel","month","simplifyCount","toFixed","round","getSelectedTimeFrameData","timeframe","timeframeSteps","fromIndex","toIndex","fromTimeframe","toTimeframe","currentDate","fromMonth","fromYear","fromTimeStamp","getTimeStampInfoFor","toYear","toMonth","toTimeStamp","minOrMax","getTime","getDate","getDaysInMonth","getPerformanceDetails","totalGames","averageOpponentElo","playerWins","playerLosses","scorePercentage","ratingChange","performanceRating","results","score","abs","than","GlobalHeader","useState","setIsOpen","modal","setModal","toggleModal","isFAQOpen","setFAQOpen","toggleFAQModal","launch","url","eventName","rows","title","content","styles","rowTitleColor","rowTitleTextSize","rowContentTextSize","rowContentPaddingTop","config","dark","light","expand","navbar","icon","faLightbulb","faMoon","faYoutube","faDiscord","nav","faQuestionCircle","right","faCaretDown","divider","tag","User","isAdvancedFiltersOpen","assign","defaultAdvancedFilters","rated","newState","SitePolicy","setFilters","newValue","colorError","filtersChange","isDisabled","areAdvancedFiltersApplied","newProps","deepEqual","selectedNotablePlayer","expandedPanel","TransitionComponent","MuiCollapse","TransitionProps","timeout","handleExpansionChange","disabled","expandIcon","getSummary","component","playerColorChange","toggleState","faCaretUp","toggleRated","handleTimeControlChange","handleTimeframeChange","handleEloRangeChange","handleDownloadLimitChange","Actions","unload","pgnReader","stopDownloading","isGamesSubsectionOpen","exportingInProgress","streamsaver","mitm","encoder","TextEncoder","removeEventListener","importOpeningTree","files","err","subMesage","success","importOpeningTreeObject","exportOpeningTree","exportOpeningTreeObject","info","fileWriter","close","game","headers","join","moveObject","pendingDownloads","write","encode","getPgnString","then","abortDownloading","shouldDownloadToFile","fileStream","createWriteStream","selectedNotableEvent","getWriter","PGNReader","readerInstance","fetchPGNFromSite","selectedOnlineTournament","proxy","notify","downloadResponse","getTokens","lichess","getLichessAccessToken","readPgn","loadedSite","importTreeClicked","startIcon","disableElevation","downloadDisabledReason","load","download","placement","exportTreeClicked","stopDownloadingAction","switchToMovesTab","faList","openingTreeLoadActions","regularActions","mainComponent","in","wrap","Worker","turn","brushes","dests","SQUARES","s","ms","square","verbose","m","free","sanOrOrig","moveObj","promotion","previousMove","downloadLimit","parsedGame","totalGamesProcessed","addPGN","latestFen","moveToShape","brush","shapes","concat","fillArray","movesForFen","gameResultsForFen","len","settingsToPersist","CookieManager","setSettingsCookie","clearBookNodes","setDarkModeCookie","trackingEvent","severity","trackingLabel","diagnosticsOpen","val","importState","nearestMultipleOf8","innerWidth","min","innerHeight","navigator","userAgent","getSubject","getBody","newVariant","getBookNode","fetchBookMoves","addBookNode","playerMovesToShow","bookMovesToShow","bookMovesMap","movesToShow","createMap","bookMove","compareTo","bookScore","getCompareScores","userScore","values","getCompareToValues","obj","bookSettings","ratings","speeds","bookType","joinParams","request","response","paramName","r","variantIcon","CheckCircleIcon","warning","WarningIcon","ErrorIcon","InfoIcon","theme","backgroundColor","green","palette","primary","amber","fontSize","iconVariant","opacity","marginRight","spacing","alignItems","classes","other","Icon","clsx","aria-describedby","aria-label","SOURCE_VARIANT_COMBINATION","Source","source","addNumber","Backup","DateRange","People","Save","faChessRook","siteChange","newSite","supportedSources","includes","Collapse","AccordionSummary","ExpandMore","aria-controls","getSourceOption","AccordionDetails","RadioGroup","setSite","getSourceRadio","Divider","AccordionActions","continue","isSourceAvailable","FormControlLabel","Radio","Dropzone","newFiles","filesChange","acceptedFiles","dropzoneText","handleFileChange","dropzoneParagraphClass","showFileNames","useChipsForPreview","previewChipProps","dropzoneClass","filesLimit","maxFileSize","NotableChessGames","updateDetails","option","profile","imageUrl","subText","list","options","selectedDetail","placeholder","renderOption","renderDetails","tournamentUrl","selectedPlayer","selectedEvent","playerNameError","tournamentUrlError","player","nextProps","trim","startsWith","parsedUrl","URL","hostname","tournamentSite","endsWith","pathComponents","tournamentId","tournamentType","validateInputDetailsSet","playerDetailsChange","finalPlayerName","setTimeout","getLichessCardBody","getPlayerNameInput","lichessLoginState","Card","Spinner","CardBody","CardTitle","faInfoCircle","faSync","refreshLichessStatus","faSignOutAlt","logoutOfLichess","launchLichessOauth","lichessLoginName","faCheck","CardText","helperText","TextField","editPlayerName","onKeyUp","playerNameKeyUp","getOnlineTournamentCard","getOnlineTournamentInput","editTournamentUrl","keyCode","setPlayerDetails","notablePlayers","notablePlayerChange","notableEvents","notableEventChange","getPgnFileSelection","getLichessSelection","getChessComSelection","getGoatDBEventSelection","getGoatDBSelection","getOpeningTreeSelection","getOnlineTournamentSelection","getInputsToShow","getVariantIcon","getVariantText","faFlagCheckered","faDiceThree","faMountain","faHouseDamage","faChessKing","getVariantOption","changeLink","setVariant","getVariantRadio","PGNLoader","selectedSite","fetchLichessLoginStatus","panel","newExpanded","timestamp","floor","now","playername","openingTreeSave","saveVersion","setEntries","gamesDetails","fetchGOATGames","auth","bearer","responseObj","username","deleteLichessAccessToken","filters","pgnUrl","Filters","SettingsView","keyHandler","srcElement","tagName","Container","Row","sm","Col","faRetweet","clearAction","faTrashAlt","resetAction","faFastBackward","analyse","faDesktop","ReportControls","stopPropagation","simplifiedView","inputProps","spellCheck","copyFen","moveDetails","getFenField","switchToUserTab","faUser","performanceDetails","Table","eatClicks","isNaN","TableHead","TableRow","TableCell","TableBody","launchGame","faExternalLinkAlt","removeQuestionMarksFromDate","reportFooter","TableFooter","colSpan","indexOf","playerDetails","elo","MovesSettings","mSettings","getTransformedBookType","indicatorInfoOpen","isArray","newMovesSettings","Modal","cancel","ModalHeader","ModalBody","getOpeningBookType","getOpeningBookRating","getOpeningBookTimeControls","getIndicatorSwitch","Link","toggleIndicatorInfo","ModalFooter","Switch","updateMoveSetting","mastersBookAvailable","ToggleButtonGroup","exclusive","ToggleButton","MovesTable","openPerformanceIndex","moveSettingsOpen","prevProps","prevState","clickedEventName","moveIndex","compareToClicked","currMove","percent","stepPositions","getIndicator","constructAlt","compareToAlt","compareClicked","altTitle","click","transition","accomplished","performancePopoverOpen","openMove","Popover","trigger","namespace","togglePerformancePopover","getTranspositionWarningLevel","getInfoIcon","targetCount","difference","faWrench","toggleMovesSettings","updateSettings","getSingleItemRow","getMultiItemRow","tableFooter","isTouchDevice","highlightMove","onMouseOver","highlightArrowFn","onMouseOut","getPopover","compareScores","Progress","multi","bar","percentage","getProgressLabel","compareProgress","faExclamationTriangle","total","showAsPercentage","sampleResultWhite","sampleResultBlack","sampleResult","ResultsTable","whitePlayer","blackPlayer","MovesList","resultsTable","movesTable","switchToBookTab","BookMove","offCard","enableBook","tab","actionIcon","ControlsContainer","activeTab","activeGame","highlightPlayerMove","highlightBookMove","Nav","tabs","NavItem","NavLink","classnames","active","faBook","Badge","faChartBar","faCog","TabContent","TabPane","tabId","bookResults","timeClasses","selectedTimeControls","unselectedTimeControls","includesAll","subArray","every","v","getTimeControlLabel","timeClass","lichessTimeControlLabel","AdvancedFilters","currentlyOpenAdvancedFilter","timeframeMarks","downloadLimitMarks","eloRangeMarks","filterName","subSectionComponent","setCurrentlyOpenAdvancedFilter","getTimeControlFilters","getTimeFrameFilters","selectedEloRange","getEloRangeFilters","getDownloadLimitFilters","Slider","valueLabelDisplay","valueLabelFormat","step","marks","firstRow","middleRow","lastRow","colWidth","FormControl","FormGroup","getTimeControlFilterRow","controls","firstColumnWidth","position","clsName","Checkbox","changeCallback","children","getFilters","OpeningManager","plys","currentIndex","pgn","ChessLogic","pgnAsList","moveForward","pgnList","pgnSoFar","pgnListSoFar","moveNumber","whitePly","blackPly","moveTo","Navigator","openingManager","currentMove","previous","next","addPly","device","moveBack","opening","ChessEcoCodes","openingCode","code","Button","faStepBackward","faStepForward","ReactDOM","render","module","exports","Cookies","remove","path","domain","settingsCookie","lastVisitCookie","visitsCookie","firstVisitCookie","timesVisited","currDate","LICHESS_TIME_CONTROLS","CHESS_DOT_COM_TIME_CONTROLS","TIME_CONTROL_LABELS","lichessPerf","DP_TABLE","RacingKingsChess","Chess","substring","disambiguatedMove","problematicMove","potentialMoves","filteredMoves","potentialMove","charAt","disambiguate","CrazyhouseChess","locationOfAt","piece","PAWN","toLowerCase","put","toggleTurn","tokens","isAdvancedFiltersEnabled","isFilterPanelEnabled","treeSaveDisabledReason","exportFileName","extension"],"mappings":"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","file":"static/js/main.588d45b0.chunk.js","sourcesContent":["export const handleDarkMode = (darkMode) => {\n    const darkModeThemeIsCurrentlySet = document.body.classList.contains('dark-theme');\n    if (darkMode !== darkModeThemeIsCurrentlySet) {\n        document.body.classList.toggle('dark-theme');\n    }\n};\nexport const logoName = (darkMode) => {\n    return darkMode? 'opening-tree-logo-white.png':'opening-tree-logo.png'\n}\nexport const rowContentColor = (darkMode) => {\n    return darkMode ? 'white' : 'grey'\n}\n","import ReactGA from 'react-ga';\n\nexport function initializeAnalytics (segment, darkMode, openingBookType){\n    ReactGA.initialize('UA-159149755-1');\n    ReactGA.set({ dimension2: segment, \n        dimension1: darkMode,  \n        dimension3: openingBookType\n    });\n\n}\nexport function trackPageView() {\n    ReactGA.pageview(window.location.pathname);\n}\n\nexport function trackEvent(category, action, label, value, nonInteraction) {\n    ReactGA.event({\n        category: category,\n        action: action,\n        label: label,\n        value: value,\n        nonInteraction:nonInteraction\n      })\n}\n\n","import {simplifiedFen, isDateMoreRecentThan} from './util'\nimport * as Constants from './Constants'\nimport {chessLogic, rootFen} from '../app/chess/ChessLogic'\n\nexport default class OpeningGraph {\n    constructor(variant) {\n        this.graph=new Graph()\n        this.hasMoves = false\n        this.variant = variant\n    }\n    setEntries(arrayEntries, pgnStats){\n        this.graph=new Graph(arrayEntries, pgnStats)\n        this.hasMoves = true\n    }\n\n    clear() {\n        this.graph = new Graph()\n        this.hasMoves = false\n    }\n\n    addPGN(pgnStats, parsedMoves, lastFen, playerColor) {\n        pgnStats.index = this.graph.pgnStats.length\n        this.graph.pgnStats.push(pgnStats)\n        this.graph.playerColor = playerColor\n        this.hasMoves = true\n        parsedMoves.forEach(parsedMove => {\n            this.addMoveForFen(parsedMove.sourceFen, parsedMove.targetFen, parsedMove.moveSan, pgnStats)\n        })\n        this.addGameResultOnFen(lastFen, pgnStats.index)\n        this.addStatsToRoot(pgnStats, this.variant)\n    }\n\n    addGameResultOnFen(fullFen, resultIndex) {\n        var currNode = this.getNodeFromGraph(fullFen, true)\n        if(!currNode.gameResults) {\n            currNode.gameResults = []\n        }\n        currNode.gameResults.push(resultIndex)\n    }\n    addStatsToRoot(pgnStats, variant) {\n        var targetNode = this.getNodeFromGraph(rootFen(variant), true)\n        if(!targetNode.details) {\n            targetNode.details = emptyDetails()\n        }\n        let newDetails = this.getUpdatedMoveDetails(targetNode.details, pgnStats)\n        targetNode.details = newDetails\n    }\n\n    getDetailsForFen(fullFen) {\n        let node = this.getNodeFromGraph(simplifiedFen(fullFen), false)\n        let details = node && node.details\n        if (Number.isInteger(details)) {\n            details = this.getUpdatedMoveDetails(emptyDetails(), this.graph.pgnStats[details])\n        } else if(!details) {\n            return emptyDetails()\n        }\n        details = this.updateCalculatedValues(details)   \n        return details\n    }\n\n    updateCalculatedValues(details) {\n        if(Number.isInteger(details.bestWin)) {\n            details.bestWinGame = this.graph.pgnStats[details.bestWin]\n            details.bestWinElo = this.getOpponentElo(this.graph.playerColor,details.bestWinGame)\n        }\n        if(Number.isInteger(details.worstLoss)) {\n            details.worstLossGame = this.graph.pgnStats[details.worstLoss]\n            details.worstLossElo = this.getOpponentElo(this.graph.playerColor,details.worstLossGame)\n        }\n        if(Number.isInteger(details.lastPlayed)) {\n            details.lastPlayedGame = this.graph.pgnStats[details.lastPlayed]\n        }\n        if(Number.isInteger(details.longestGame)) {\n            details.longestGameInfo = this.graph.pgnStats[details.longestGame]\n        }\n        if(Number.isInteger(details.shortestGame)) {\n            details.shortestGameInfo = this.graph.pgnStats[details.shortestGame]\n        }\n        details.count = details.whiteWins+details.blackWins+details.draws\n        return details\n\n    }\n\n    addMoveForFen(fullSourceFen, fullTargetFen, move, resultObject) {\n        var targetNode = this.getNodeFromGraph(fullTargetFen, true)\n        let newDetails = this.getUpdatedMoveDetails(targetNode.details, resultObject)\n        targetNode.details = newDetails\n\n        var currNode = this.getNodeFromGraph(fullSourceFen, true)\n        if(!currNode.playedBy) {\n            currNode.playedBy = {}\n        }\n        let moveCount = currNode.playedBy[move]\n        if(!moveCount) {\n            moveCount = 0\n        }\n        moveCount = moveCount+1\n        currNode.playedBy[move] = moveCount\n        currNode.playedByMax = Math.max(currNode.playedByMax, moveCount)\n    }\n\n    addBookNode(fullFen, book) {\n        let fen = simplifiedFen(fullFen)\n        this.graph.book.set(fen, this.transform(book))\n    }\n    clearBookNodes(){\n        this.graph.book = new Map()\n    }\n    transform(book) {\n        if(!book || !book.moves) {\n            return book\n        }\n        return {\n            fetch:\"success\",\n            moves:book.moves.map((move)=>{\n                let count = move.black+move.white+move.draws\n                return {\n                    san:move.san,\n                    details:{\n                        hasData:true,\n                        blackWins:move.black,\n                        whiteWins:move.white,\n                        draws:move.draws,\n                        count:count,\n                        averageElo:move.averageRating\n                    },\n                    moveCount:count\n                }\n            })\n        }\n    }\n    getBookNode(fullFen) {\n        let fen = simplifiedFen(fullFen)\n        return this.graph.book.get(fen)\n    }\n\n    getNodeFromGraph(fullFen, addIfNull) {\n        let fen = simplifiedFen(fullFen)\n        var currNode = this.graph.nodes.get(fen)\n        if(!currNode && addIfNull) {\n            currNode = new GraphNode()\n            currNode.fen = fen\n            this.graph.nodes.set(fen, currNode)\n        }\n        return currNode\n    }\n\n    getUpdatedMoveDetails(currentMoveDetails, resultObject) {\n        if(Number.isInteger(currentMoveDetails)) {\n            // if this is the second stat object being added\n            // calculate the first move details and then merge it with the second one\n            currentMoveDetails = this.getUpdatedMoveDetails(emptyDetails(),\n                            this.graph.pgnStats[currentMoveDetails])\n        } else if(!currentMoveDetails) {\n            // if this is the first stat being added to this node,\n            // just write the index to calculate the stats later\n            return resultObject.index\n        }\n        \n        let whiteWin = 0, blackWin = 0, draw = 0, resultInt = 0;\n        let playerColor = this.graph.playerColor\n        if(resultObject.result === '1-0') {\n            whiteWin = 1\n            resultInt = playerColor === Constants.PLAYER_COLOR_WHITE? 1 : -1\n        } else if (resultObject.result === '0-1') {\n            blackWin = 1\n            resultInt = playerColor === Constants.PLAYER_COLOR_BLACK? 1 : -1\n        } else {\n            draw = 1\n        }\n\n        let opponentElo = this.getOpponentElo(playerColor, resultObject)\n        if(resultInt === 1) {\n            let currentBestWinGame = null\n            if(Number.isInteger(currentMoveDetails.bestWin)) {\n                currentBestWinGame = this.graph.pgnStats[currentMoveDetails.bestWin]\n            }\n            if(!currentBestWinGame || parseInt(opponentElo)>parseInt(this.getOpponentElo(playerColor, currentBestWinGame))) {\n                currentMoveDetails.bestWin = resultObject.index\n            }\n        }\n        if(resultInt === -1) {\n            let currentWorstLossGame = null\n            if(Number.isInteger(currentMoveDetails.worstLoss)) {\n                currentWorstLossGame = this.graph.pgnStats[currentMoveDetails.worstLoss]\n            }\n            if(!currentWorstLossGame || parseInt(opponentElo)<parseInt(this.getOpponentElo(playerColor, currentWorstLossGame))) {\n                currentMoveDetails.worstLoss = resultObject.index\n            }\n        }\n        let currentLastPlayedGame = null\n        if(Number.isInteger(currentMoveDetails.lastPlayed)) {\n            currentLastPlayedGame = this.graph.pgnStats[currentMoveDetails.lastPlayed]\n        }\n        if(!currentLastPlayedGame || \n            isDateMoreRecentThan(resultObject.date, currentLastPlayedGame.date)) {\n                currentMoveDetails.lastPlayed = resultObject.index\n        }\n        let currentLongestGame = null\n        if(Number.isInteger(currentMoveDetails.longestGame)) {\n            currentLongestGame = this.graph.pgnStats[currentMoveDetails.longestGame]\n        }\n        if(!currentLongestGame || \n            resultObject.numberOfPlys > currentLongestGame.numberOfPlys) {\n                currentMoveDetails.longestGame = resultObject.index\n        }\n\n        let currentShortestGame = null\n        if(Number.isInteger(currentMoveDetails.shortestGame)) {\n            currentShortestGame = this.graph.pgnStats[currentMoveDetails.shortestGame]\n        }\n        if(!currentShortestGame || \n            resultObject.numberOfPlys < currentShortestGame.numberOfPlys) {\n                currentMoveDetails.shortestGame = resultObject.index\n        }\n\n\n        currentMoveDetails.blackWins += blackWin\n        currentMoveDetails.whiteWins += whiteWin\n        currentMoveDetails.draws += draw\n        currentMoveDetails.totalOpponentElo += parseInt(opponentElo)\n        currentMoveDetails.hasData = true\n        return currentMoveDetails\n    }\n\n    getOpponentElo(playerColor, resultObject) {\n        if(playerColor === Constants.PLAYER_COLOR_WHITE) {\n            return resultObject.blackElo\n        }\n        return resultObject.whiteElo\n    }\n\n    gameResultsForFen(fullFen) {\n        let fen = simplifiedFen(fullFen)\n\n        var currNode = this.graph.nodes.get(fen)\n        if(currNode && currNode.gameResults) {\n            return currNode.gameResults.map((index)=>this.graph.pgnStats[index])\n        }\n        return null\n    }\n    movesForFen(fullFen) {\n        let fen = simplifiedFen(fullFen)\n\n        var currNode = this.graph.nodes.get(fen)\n        if(currNode && currNode.playedBy) {\n            return Array.from(Object.entries(currNode.playedBy)).map((entry)=> {\n                let chess = chessLogic(this.variant, fullFen)\n                let move = chess.move(entry[0], {sloppy: true})\n                let targetNodeDetails = this.getDetailsForFen(chess.fen())\n                return {\n                    orig:move.from,\n                    dest:move.to,\n                    level:this.levelFor(entry[1], currNode.playedByMax),\n                    san:move.san,\n                    details:targetNodeDetails,\n                    moveCount:entry[1]\n                }\n            })\n        }        \n        return null\n    }\n\n    levelFor(moveCount, maxCount){\n        if(maxCount <= 0 ||moveCount/maxCount > 0.8) {\n            return 3\n        }\n        if(moveCount/maxCount>0.3) {\n            return 2\n        }\n        return 1\n    }\n\n}\n\n\nclass Graph {\n    constructor(arrayEntries, pgnStats){\n        this.nodes = new Map()\n        this.book = new Map()\n        this.pgnStats = []\n        this.playerColor = ''\n        if(arrayEntries) {\n            arrayEntries.forEach((entry)=> {\n                this.nodes.set(entry[0],entry[1])\n            })\n        }\n        if(pgnStats) {\n            this.pgnStats = pgnStats\n        }\n    }\n}\n\nclass GraphNode {\n            playedByMax = 0 // used to keep track of how many times the most frequent move is played for ease of calculation later\n            //playedBy = {}\n            //gameResults = []\n}\n\nfunction emptyDetails() {\n    return {\n        hasData:false,\n//        count: 0,\n        blackWins: 0,\n        whiteWins: 0,\n        draws: 0,\n        totalOpponentElo: 0,\n        shortestGame:null,\n        longestGame:null,\n//        bestWin:null,\n//        bestWinGame:null,\n//        worstLoss:null,\n//        worstLossGame:null,\n        lastPlayed:null\n//        lastPlayedGame:null\n    }\n}\n","import cookieManager from './CookieManager'\n\nclass UserProfile {\n    userProfile = null\n    getUserProfile(){\n        if(this.userProfile !== null) {\n            return this.userProfile\n        }\n        let visitInfo = cookieManager.getVisitInfo();\n        let userType = null\n        let userTypeDesc = null\n        if(visitInfo.numVisits === 0) {\n            userType = USER_PROFILE_FIRST_TIME_USER\n            userTypeDesc = \"first\"\n        } else if(visitInfo.numVisits < 6) {\n            userType = USER_PROFILE_NEW_USER\n            userTypeDesc = \"new\"\n        } else if (visitInfo.numVisits < 12) {\n            userType = USER_PROFILE_OCCAISONAL_USER\n            userTypeDesc = \"occasional\"\n        } else if (visitInfo.currentVisit - visitInfo.firstVisit > 1000*60*60*24*30\n            && visitInfo.currentVisit - visitInfo.lastVisit < 1000*60*60*24*7) {\n            // power user classified if :\n            // 1. has more than 10 visits total\n            // 2. first visited more than a month ago \n            // 3. last visited within the past week\n            userType = USER_PROFILE_POWER_USER\n            userTypeDesc = \"power\"\n        } else {\n            userType = USER_PROFILE_FREQUENT_USER\n            userTypeDesc = \"frequent\"\n        }\n        this.userProfile = {\n            userType:userType,\n            userTypeDesc:userTypeDesc,\n            numVisits:visitInfo.numVisits\n        }\n        return this.userProfile\n    }\n}\nexport const USER_PROFILE_FIRST_TIME_USER = 1\nexport const USER_PROFILE_NEW_USER = 2\nexport const USER_PROFILE_OCCAISONAL_USER = 3\nexport const USER_PROFILE_FREQUENT_USER = 4\nexport const USER_PROFILE_POWER_USER = 5\n\nexport default new UserProfile();","export const TIME_CONTROL_ULTRA_BULLET = \"ultraBullet\"\nexport const TIME_CONTROL_BULLET = \"bullet\"\nexport const TIME_CONTROL_BLITZ = \"blitz\"\nexport const TIME_CONTROL_RAPID = \"rapid\"\nexport const TIME_CONTROL_CLASSICAL = \"classical\"\nexport const TIME_CONTROL_CORRESPONDENCE = \"correspondence\"\nexport const TIME_CONTROL_DAILY = \"daily\"\nexport const FILTER_NAME_RATED = \"rated\"\nexport const FILTER_NAME_SELECTED_TIMEFRAME = \"selectedTimeframe\"\nexport const FILTER_NAME_DOWNLOAD_LIMIT = \"downloadLimit\"\nexport const FILTER_NAME_ELO_RANGE = \"eloRange\"\n\nexport const SITE_LICHESS = \"lichess\"\nexport const SITE_CHESS_DOT_COM = \"chesscom\"\nexport const SITE_PGN_FILE = \"pgnfile\"\nexport const SITE_EVENT_DB = \"eventdb\"\nexport const SITE_PLAYER_DB = \"playerdb\"\nexport const SITE_OPENING_TREE_FILE = \"opntfile\"\nexport const SITE_ONLINE_TOURNAMENTS = \"tournament\"\n\nexport const MAX_DOWNLOAD_LIMIT = 2000\nexport const MAX_ELO_RATING = 3000\n\nexport const EVENT_CATEGORY_PGN_LOADER = \"loader\"\nexport const EVENT_CATEGORY_OPENING_BOOK = \"openingBook\"\nexport const EVENT_CATEGORY_SETTINGS = \"settings\"\nexport const EVENT_CATEGORY_LICHESS_LOGIN = \"lichess\"\nexport const EVENT_CATEGORY_MAIN_ACTION = \"mainAction\"\nexport const EVENT_CATEGORY_SEGMENT = \"segment\"\nexport const EVENT_CATEGORY_MOVES_LIST = \"moves\"\nexport const EVENT_CATEGORY_CONTROLS = \"controls\"\nexport const EVENT_CATEGORY_NAVIGATOR = \"navigator\"\nexport const EVENT_CATEGORY_CHESSBOARD = \"chessboard\"\nexport const EVENT_CATEGORY_ERROR = \"error\"\nexport const EVENT_CATEGORY_MESSAGE_SHOWN = \"message\"\nexport const EVENT_CATEGORY_GLOBAL_HEADER = \"globalHeader\"\n\nexport const ROOT_FEN = \"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\"\nexport const RACING_KINGS_ROOT_FEN=\"8/8/8/8/8/8/krbnNBRK/qrbnNBRQ w - - 0 1\"\n\nexport const PLAYER_COLOR_WHITE = 'white'\nexport const PLAYER_COLOR_BLACK = 'black'\n\nexport const LOADER_ANIMATION_DURATION_MS = 500\n\nexport const OPENING_TREE_EMAIL = 'feedback@openingtree.com'\nexport const OPENING_TREE_REDDIT = 'opening_tree'\nexport const OPENING_TREE_LICHESS = 'vannooz'\nexport const OPENING_TREE_CHESS_COM = 'vannooz'\nexport const OPENING_TREE_DISCORD = 'https://discord.gg/hCwKkN8'\n\nexport const OPENING_TREE_FILE_CURRENT_VERSION = 2\n\nexport const ERROR_ACTION_REPORT = 'report'\nexport const ERROR_ACTION_VISIT_OLD_SITE = 'visitOld'\nexport const ERROR_ACTION_NONE = 'noAction'\nexport const LICHESS_NOT_LOGGED_IN = 0;\nexport const LICHESS_STATE_PENDING = 1;\nexport const LICHESS_LOGGED_IN = 2;\nexport const LICHESS_FAILED_FETCH = 3;\n\nexport const ERROR_SEVERITY_ERROR = \"error\";\nexport const ERROR_SEVERITY_WARNING = \"warning\";\nexport const ERROR_SEVERITY_SUCCESS = \"success\";\n\nexport const VARIANT_STANDARD = \"standard\";\nexport const VARIANT_RACING_KINGS = \"racingkings\";\nexport const VARIANT_THREE_CHECK = \"threecheck\";\nexport const VARIANT_KING_OF_THE_HILL = \"kingofthehill\";\nexport const VARIANT_CRAZYHOUSE = \"crazyhouse\";\n\nexport const CHESS_COM_RULES_STANDARD = \"chess\";\nexport const CHESS_COM_RULES_THREE_CHECK = \"threeCheck\";\nexport const CHESS_COM_RULES_KING_OF_THE_HILL = \"kingofthehill\";\nexport const CHESS_COM_RULES_CRAZYHOUSE = \"crazyhouse\";\n\nexport const LICHESS_PERF_RACING_KINGS = \"racingKings\"\nexport const LICHESS_PERF_THREE_CHECK = \"threeCheck\"\nexport const LICHESS_PERF_KING_OF_THE_HILL = \"kingOfTheHill\"\nexport const LICHESS_PERF_CRAZYHOUSE = \"crazyhouse\"\nexport const LICHESS_PERF_STANDARD = \"standard\"\n\nexport const LICHESS_HEADER_RACING_KINGS = \"Racing Kings\"\nexport const LICHESS_HEADER_THREE_CHECK = \"Three-check\"\nexport const LICHESS_HEADER_KING_OF_THE_HILL = \"King of the Hill\"\nexport const LICHESS_HEADER_STANDARD = \"Standard\"\nexport const LICHESS_HEADER_CRAZYHOUSE = \"Crazyhouse\"\n\nexport const OPENING_BOOK_TYPE_OFF = 'off'\nexport const OPENING_BOOK_TYPE_MASTERS = 'master'\nexport const OPENING_BOOK_TYPE_LICHESS = 'lichess'\n\nexport const ALL_BOOK_RATINGS = ['1600','1800','2000','2200','2500']\n\nexport const SETTING_NAME_ORIENTATION = 'orientation'\nexport const SETTING_NAME_DARK_MODE = 'darkMode'\nexport const SETTING_NAME_MOVES_SETTINGS = 'movesSettings'\n","import zlib from 'zlib'\nimport {Buffer} from 'buffer'\nimport { saveAs } from 'file-saver';\n\nexport function serializeOpeningTree(treeData, filename, callback) {\n    let chunkedArray = chunk(treeData)\n    let deflatedChunks = []\n    //push version number 1 for later backward compatibility\n    deflatedChunks.push(packControlWord(0x1))\n    deflatedChunks.push(packControlWord(chunkedArray.length))\n    let remainingChunks = chunkedArray.length\n    let hasError = false;\n    chunkedArray.forEach((chunk)=>{\n        zlib.deflate(\n            new Buffer(JSON.stringify(chunk)), \n            (error,data)=>{\n                remainingChunks--\n                if(error) {\n                    hasError = true\n                }\n                deflatedChunks.push(packControlWord(data.byteLength))\n                deflatedChunks.push(data)\n                if(remainingChunks<=0) {\n                    if(hasError) {\n                        callback(\"Could not save file\")\n                        return\n                    }\n                    saveAs(new Blob(deflatedChunks, {type: \"application/octet-stream\"}), filename)\n                    callback(null, `Saved opening tree to file ${filename}`)\n                }\n            });\n        })\n}\n\nexport function deserializeOpeningTree(file, callback) {\n    let reader = new FileReader()\n    reader.onload = function(evt) {\n        let data = evt.target.result\n        let index = 0\n        let version = unpackControlWord(data.slice(index,index+8))\n        index = index + 8\n        if(version !== 0x1) {\n            callback(\"File is not an openingtree save file.\", null,\"Are you loading the correct file?\")\n            return\n        }\n        let numChunks = unpackControlWord(data.slice(index,index+8))\n        index = index + 8\n        if(!numChunks) {\n            callback(\"Input file not in correct format\", null)\n            return\n        }\n        getInflatedChunks(data, index, numChunks, callback)\n    };\n    reader.onerror = function(e) {\n        callback(\"Failed to read openingtree file\", null, `${e.target.error.name}:${e.target.error.message}`)\n    }\n    reader.readAsArrayBuffer(file)\n}\n\nfunction getInflatedChunks(data, startIndex, numChunks, callback) {\n    let index = startIndex\n    let deflatedChunks = []\n    let remainingChunks = numChunks\n    let hasError=false\n    let handleInflate = (error, data)=> {\n        remainingChunks--\n        if(error) {\n            console.log(error)\n            hasError=true\n        }\n        try {\n            deflatedChunks.push(JSON.parse(data))\n        } catch (e) {\n            console.log(e)\n            hasError=true\n        }\n        if(remainingChunks===0) {\n            if(hasError) {\n                callback(\"Input file seems corrupted\", null)\n            }\n            \n            callback(null, reconstructObjectFromChunks(deflatedChunks))\n        }\n        \n    }\n    while(numChunks>0) {\n        let chunkSize = unpackControlWord(data.slice(index,index+8))\n        index = index + 8\n        zlib.inflate(\n            Buffer.from(data,index,chunkSize), handleInflate)\n        index = index + chunkSize\n        numChunks--\n    }\n}\n\nfunction reconstructObjectFromChunks(deflatedChunks) {\n    let sortedChunks = deflatedChunks.sort((a,b)=>a.index-b.index)\n    let flattenedChunks = sortedChunks.slice(1).map(el=>el.chunk).flat()\n    let header = sortedChunks[0]\n    let arrays = []\n    let index = 0\n    let arraySizes = header.arraySizes || [flattenedChunks.length]\n    arraySizes.forEach((size)=>{\n        arrays.push(flattenedChunks.slice(index,index+size))\n        index+=size\n    })\n    return {\n        header:header.chunk,\n        arrays:arrays\n    }\n}\n\nfunction unpackControlWord(control) {\n    let view = new DataView(control)\n    if(view.getUint16(0)!==0x1337 || view.getUint16(6)!==0xC0D3) {\n        return null\n    }\n    return view.getUint32(2)\n}\n\nfunction packControlWord(control) {\n    var buffer = new ArrayBuffer(8); \n    var view = new DataView(buffer); \n    view.setUint16(0, 0x1337)\n    view.setUint32(2, control>>>0)\n    view.setUint16(6, 0xC0D3)\n    return buffer\n}\n\nfunction chunk(treeData) {\n    let chunk1 = {chunk:treeData.header, index:0, \n        arraySizes:treeData.arrays.map(arr=>arr.length)}\n    let chunks = [chunk1]\n    treeData.arrays.forEach((array)=>{\n        Array.prototype.push.apply(chunks, chunkArray(array, 1000, chunks.length));\n    })\n    return chunks\n}\n\nfunction chunkArray(array, chunkSize, startIndex) {\n    let chunkedArray=[]\n    \n    for (let i=0, chunkIndex=1; i<array.length; i+=chunkSize, chunkIndex++) {\n        chunkedArray.push({chunk:array.slice(i,i+chunkSize), index:startIndex+chunkIndex});\n    }\n    return chunkedArray\n}\n","import { withStyles } from '@material-ui/core/styles';\nimport MUIAccordion from '@material-ui/core/Accordion';\nimport React from 'react'\nimport { createSubObjectWithProperties } from '../../app/util'\nimport * as Constants from '../../app/Constants'\n\nexport const Accordion = withStyles({\n    root: {\n        border: '1px solid rgba(0, 0, 0, .125)',\n        boxShadow: 'none',\n        '&:not(:last-child)': {\n            borderBottom: 0,\n        },\n        '&:before': {\n            display: 'none',\n        },\n        '&$expanded': {\n            margin: 'auto',\n        },\n    },\n    expanded: {},\n})(MUIAccordion);\n\nexport function getNumberIcon(n) {\n    return <img alt={`step ${n}`} className = 'lowOpacity styledNumbers' src={`/images/styled-${n}.png`} height={24}/>\n}\n\nexport function advancedFilters(state) {\n    return createSubObjectWithProperties(state,\n        [Constants.TIME_CONTROL_ULTRA_BULLET, Constants.TIME_CONTROL_BULLET,\n        Constants.TIME_CONTROL_BLITZ, Constants.TIME_CONTROL_RAPID,\n        Constants.TIME_CONTROL_CORRESPONDENCE, Constants.TIME_CONTROL_DAILY,\n        Constants.TIME_CONTROL_CLASSICAL, Constants.FILTER_NAME_RATED,\n        Constants.FILTER_NAME_SELECTED_TIMEFRAME, Constants.FILTER_NAME_DOWNLOAD_LIMIT,\n        Constants.FILTER_NAME_ELO_RANGE])\n}\n\nexport function copyText(elementId) {\n    /* Get the text field */\n    var copyText = document.getElementById(elementId);\n    try {\n        /* Select the text field */\n        copyText.select();\n        copyText.setSelectionRange(0, 99999); /*For mobile devices*/\n\n        /* Copy the text inside the text field */\n        document.execCommand(\"copy\");\n        return true\n    } catch(e) {\n        return false\n    }\n}","import React from 'react'\nimport Chessground from 'react-chessground'\nimport 'react-chessground/dist/styles/chessground.css'\nimport {\n  Button,\n  Col,\n  Collapse,\n  Container,\n  Modal,\n  ModalBody,\n  ModalFooter,\n  ModalHeader,\n  Row\n} from 'reactstrap'\n\nimport {\n  Checkbox,\n  FormControlLabel,\n  Snackbar,\n  TextField\n} from '@material-ui/core'\n\nimport * as Constants from '../app/Constants'\nimport OpeningGraph from '../app/OpeningGraph'\nimport { chessLogic } from '../app/chess/ChessLogic'\nimport cookieManager from '../app/CookieManager'\nimport { handleDarkMode } from '../pres/DarkMode';\nimport UserProfile, { USER_PROFILE_NEW_USER } from '../app/UserProfile'\nimport {initializeAnalytics} from '../app/Analytics'\n\nimport Navigator from './Navigator'\nimport GlobalHeader from './GlobalHeader'\nimport ControlsContainer from './ControlsContainer'\nimport { addStateManagement } from './StateManagement'\nimport SnackbarContentWrapper from './SnackbarContentWrapper'\nexport default class MainContainer extends React.Component {\n\n  constructor(props){\n    super(props)\n\n    let urlVariant = new URLSearchParams(window.location.search).get(\"variant\")\n    let selectedVariant = urlVariant || Constants.VARIANT_STANDARD\n    this.chess = chessLogic(selectedVariant)\n    addStateManagement(this)\n    this.state = {\n        resize:0,\n        fen: this.chess.fen(),\n        lastMove: null,\n        gamesProcessed:0,\n        openingGraph:new OpeningGraph(selectedVariant),\n        settings:{\n          playerName:'',\n          orientation:Constants.PLAYER_COLOR_WHITE,\n          playerColor:'',\n          movesSettings:this.getMovesSettingsFromCookie(),\n          darkMode: this.getDarkModeSettingFromCookie()\n        },\n        message:'',\n        downloadingGames:false,\n        feedbackOpen:false,\n        diagnosticsDataOpen:false,\n        variant:selectedVariant,\n        update:0,//increase count to force update the component\n        highlightedMove:null\n      }\n    this.chessboardWidth = this.getChessboardWidth()\n\n    this.forBrushes = ['blue','paleGrey', 'paleGreen', 'green']\n    this.againstBrushes = ['blue','paleRed', 'paleRed', 'red']\n    window.addEventListener('resize', this.handleResize.bind(this))\n    let userProfile = UserProfile.getUserProfile()\n    initializeAnalytics(userProfile.userTypeDesc, this.state.settings.darkMode?\"dark\":\"light\", \n      this.state.settings.movesSettings.openingBookType)\n\n  }\n  handleResize() {\n    this.setState({resize:this.state.resize+1})\n    this.chessboardWidth = this.getChessboardWidth()\n  }\n\n  getMovesSettingsFromCookie() {\n    let { movesSettings } = cookieManager.getSettingsCookie() || {};\n\n    if (!movesSettings) {\n      // default settings\n      movesSettings = {\n          openingBookType:Constants.OPENING_BOOK_TYPE_LICHESS,\n          openingBookRating:Constants.ALL_BOOK_RATINGS,\n          openingBookTimeControls: [\n            Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_BLITZ,\n            Constants.TIME_CONTROL_RAPID,\n            Constants.TIME_CONTROL_CLASSICAL\n          ],\n          openingBookScoreIndicator:false,\n          openingBookWinsIndicator:UserProfile.getUserProfile().userType>USER_PROFILE_NEW_USER\n        }\n    }\n    return movesSettings;\n  }\n\n  getDarkModeSettingFromCookie () {\n    const darkModeCookie = cookieManager.getDarkModeCookie();\n    if(darkModeCookie === undefined){\n      return true// default value\n    }\n    return darkModeCookie === 'true';\n  }\n\n  render() {\n    let lastMoveArray = this.state.lastMove ? [this.state.lastMove.from, this.state.lastMove.to] : null\n    let snackBarOpen = Boolean(this.state.message)\n\n    let playerMoves = this.getPlayerMoves()\n    let bookMoves = this.getBookMoves()\n    this.mergePlayerAndBookMoves(playerMoves, bookMoves)\n\n    return <div className=\"rootView\">\n      <GlobalHeader settings={this.state.settings} \n                    settingsChange={this.settingsChange.bind(this)}\n                    toggleFeedback = {this.toggleFeedback(false)}/>\n      <Container className=\"mainContainer\">\n        <Row>\n          <Col lg={{order:0, size:2}} xs={{order:2}}>\n            <Navigator fen = {this.state.fen} move={this.state.lastMove}\n              onChange ={this.navigateTo.bind(this)}\n              variant = {this.state.variant} />\n          </Col>\n          <Col lg=\"6\">\n            <Chessground key={this.state.resize}\n              height={this.chessboardWidth}\n              width={this.chessboardWidth}\n              orientation={this.orientation()}\n              turnColor={this.turnColor()}\n              movable={this.calcMovable()}\n              lastMove={lastMoveArray}\n              fen={this.state.fen}\n              onMove={this.onMoveAction.bind(this)}\n              drawable ={{\n                enabled: true,\n                visible: true,\n                autoShapes: this.autoShapes(playerMoves, this.state.highlightedMove)\n              }}\n              style={{ margin: 'auto' }}\n            />\n          </Col>\n          <Col lg=\"4\" className=\"paddingTop\">\n            <ControlsContainer fen={this.state.fen}\n              resize ={this.state.resize}\n              gamesProcessed={this.state.gamesProcessed}\n              updateProcessedGames={this.updateProcessedGames.bind(this)}\n              settingsChange={this.settingsChange.bind(this)}\n              settings={this.state.settings}\n              reset={this.reset.bind(this)}\n              clear={this.clear.bind(this)}\n              playerMoves={playerMoves}\n              bookMoves={bookMoves}\n              gameResults={this.gameResults()}\n              onMove={this.onMove.bind(this)}\n              turnColor={this.turnColor()}\n              showError={this.showError.bind(this)}\n              showInfo={this.showInfo.bind(this)}\n              setDownloading={this.setDownloading.bind(this)}\n              isDownloading={this.state.downloadingGames}\n              openingGraph={this.state.openingGraph}\n              importCallback={this.importGameState.bind(this)}\n              variant={this.state.variant}\n              variantChange={this.variantChange.bind(this)}\n              forceFetchBookMoves={this.forceFetchBookMoves.bind(this)}\n              highlightArrow={this.highlightArrow.bind(this)}\n            />\n          </Col>\n        </Row>\n      </Container>\n      <Snackbar anchorOrigin={{ vertical:'bottom', horizontal:\"left\" }}\n        open={snackBarOpen} autoHideDuration={6000}\n        onClose={this.closeError.bind(this)}\n      >\n        <SnackbarContentWrapper\n          onClose={this.closeError.bind(this)}\n          variant={this.state.messageSeverity}\n          message={this.state.message}\n          subMessage={this.state.subMessage}\n          showReportButton={this.state.messageSeverity==='error'}\n          action={this.state.errorAction}\n          actionText={this.state.errorActionText}\n        />\n      </Snackbar>\n\n      <Modal isOpen={this.state.feedbackOpen} toggle={this.toggleFeedback(false)}>\n        <ModalHeader toggle={this.toggleFeedback(false)}>\n          Feedback\n        </ModalHeader>\n        <ModalBody>\n          Your feedback is greatly appreciated. Reach out to me for feedback, suggestions, bug report or just a game of chess.\n          <ul>\n            <li>Email me: <a rel=\"noopener noreferrer\" href={this.getEmailLink()} target=\"_blank\">{Constants.OPENING_TREE_EMAIL}</a></li>\n            <li>Message me on reddit <a rel=\"noopener noreferrer\" href={this.getRedditLink()} target=\"_blank\">u/{Constants.OPENING_TREE_REDDIT}</a></li>\n            <li>Message me on lichess: <a rel=\"noopener noreferrer\" href={`https://lichess.org/inbox/${Constants.OPENING_TREE_LICHESS}`} target=\"_blank\">{Constants.OPENING_TREE_LICHESS}</a></li>\n            <li>Message me on chess.com: <a rel=\"noopener noreferrer\" href={`https://www.chess.com/messages/compose/${Constants.OPENING_TREE_CHESS_COM}`} target=\"_blank\">{Constants.OPENING_TREE_CHESS_COM}</a></li>\n            <li>Join my <a rel=\"noopener noreferrer\" href={Constants.OPENING_TREE_DISCORD}target=\"_blank\">discord server</a> to chat</li>\n          </ul>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={this.state.diagnosticsDataOpen}\n                onChange={this.toggleDiagnosticsData}\n                name=\"diagnostics\"\n                color=\"primary\"\n              />}\n            label=\"Add diagnostics data to message\"\n          />\n          <Collapse isOpen={this.state.diagnosticsDataOpen}>\n            <TextField id=\"diagnosticsText\" label=\"Click to copy.\" variant=\"outlined\"\n            className=\"fullWidth\" value={this.getDiagnosticsValue()}\n            rowsMax={4} onClick={this.copyDiagnostics} multiline />\n          </Collapse>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggleFeedback(false)}>Done</Button>\n        </ModalFooter>\n      </Modal>\n    </div>\n  }\n\n  componentDidMount() {\n      handleDarkMode(this.state.settings.darkMode);\n      \n      // hack to fix https://github.com/openingtree/openingtree/issues/243\n      // refreshing the chessboard after its initial render seems to fix this issue\n      setImmediate(this.handleResize.bind(this))\n  }\n}\n","import * as Constants from '../app/Constants'\nimport * as Common from '../app/Common'\n\nexport function createSubObjectWithProperties(mainObject, properties) {\n    let subObject = {}\n    properties.forEach(property => {\n        subObject[property] = mainObject[property]\n    });\n    return subObject\n}\nexport function simplifiedFen(fen) {\n    let fenComponents = fen.split(' ')\n    if(fenComponents.length <=4) {\n        return fen\n    }\n    //exclude move and halfMove components\n    return `${fenComponents[0]} ${fenComponents[1]} ${fenComponents[2]}`\n}\n\nexport function getTimeControlsArray(site,timeControlState, selected) {\n    let allTimeControls = site === Constants.SITE_LICHESS ? \n        Common.LICHESS_TIME_CONTROLS : Common.CHESS_DOT_COM_TIME_CONTROLS\n    return allTimeControls.filter((timeControl)=>!!timeControlState[timeControl] === selected)\n}\nlet monthLabels = [\n    \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"\n]\nexport function getTimeframeSteps() {\n    let steps = [{\n        year:2007,\n        value:0\n    }]\n    let value = 1;\n    let startYear = 2010\n    let currentYear = new Date().getFullYear()\n    let currentMonth = new Date().getMonth()\n    while(startYear < currentYear-1) {\n        steps.push({\n            toLongLabel:`${monthLabels[11]} ${startYear}`,\n            fromLongLabel:`${monthLabels[0]} ${startYear}`,\n            year:startYear,\n            value:value\n        })\n        startYear++\n        value++\n    }\n    for(let i=11;i>0;i--) {\n\n        let month = (currentMonth+12-i)%12\n        let year = month<currentMonth?currentYear:currentYear-1\n        steps.push({\n            fromLongLabel: `${monthLabels[month]} ${year}`,\n            toLongLabel: `${monthLabels[month]} ${year}`,\n            month:month,\n            year: year,\n            value:value\n        })\n        value++\n    }\n    steps.push({\n        month:12,\n        year: currentYear,\n        value:value\n    })\n    return steps\n}\n\n\nexport function simplifyCount(count){\n    if(count>=1000000){\n        return `${(count/1000000).toFixed(1)}M`\n    }        \n    if(count>=10000){\n        return `${Math.round(count/1000)}k`\n    }\n\n    return count\n}\n\nexport function getSelectedTimeFrameData(timeframe, timeframeSteps) {\n    let fromIndex = timeframe[0]\n    let toIndex = timeframe[1]\n    let fromTimeframe = timeframeSteps[fromIndex]\n    let toTimeframe = timeframeSteps[toIndex]\n    \n    if(fromIndex === timeframeSteps.length-1 && toIndex === timeframeSteps.length-1) {\n        let currentDate = new Date()\n        return {\n            label:\"Current month\",\n            fromMonth:currentDate.getMonth(),\n            fromYear:currentDate.getFullYear(),\n            fromTimeStamp:getTimeStampInfoFor(currentDate.getMonth(), currentDate.getFullYear(), \"min\")\n        }\n    }\n    if(fromIndex === 0 && toIndex === 0) {\n        return {label:\"Anytime\"}\n    }\n    if(fromIndex === 0 && toIndex === timeframeSteps.length-1) {\n        return {label:\"Anytime\"}\n    }\n    if(toIndex === timeframeSteps.length-1) {\n        let month = fromTimeframe.month ? fromTimeframe.month : 0\n        return {\n            label:`Since ${fromTimeframe.fromLongLabel}`,\n            fromYear: fromTimeframe.year,\n            fromMonth: month,\n            fromTimeStamp: getTimeStampInfoFor(month, fromTimeframe.year, \"min\")\n        }\n    }\n    if(fromIndex === 0) {\n        let month = toTimeframe.month ? toTimeframe.month : 11\n        return {\n            label:`Until ${toTimeframe.toLongLabel}`,\n            toYear: toTimeframe.year,\n            toMonth: month,\n            toTimeStamp: getTimeStampInfoFor(month, toTimeframe.year, \"max\")\n        }\n    }\n    let fromMonth = fromTimeframe.month ? fromTimeframe.month : 0\n    let toMonth = toTimeframe.month ? toTimeframe.month : 11\n    return {\n        label:`From ${fromTimeframe.fromLongLabel} to ${toTimeframe.toLongLabel}`,\n        fromYear: fromTimeframe.year,\n        fromMonth: fromMonth,\n        fromTimeStamp: getTimeStampInfoFor(fromMonth, fromTimeframe.year, \"min\"),\n        toYear: toTimeframe.year,\n        toMonth: toMonth,\n        toTimeStamp: getTimeStampInfoFor(toMonth, toTimeframe.year, \"max\")\n    }\n}\n\nfunction getTimeStampInfoFor(month, year, minOrMax) {\n    if(minOrMax === \"min\") {\n        return new Date(year, month).getTime()\n    } else {\n        return new Date(year,month,getDaysInMonth(year, month)).getTime()\n    }\n}\n\nfunction getDaysInMonth(year,month) {\n    return new Date(year, month + 1, 0).getDate();\n}\n\nexport function getPerformanceDetails(totalOpponentElo, averageElo, white, draws, black, playerColor) {\n    let totalGames = white + draws + black\n    let averageOpponentElo = totalOpponentElo?Math.round(totalOpponentElo/totalGames):null\n    let playerWins = playerColor === Constants.PLAYER_COLOR_BLACK?black:white\n    let playerLosses = playerColor !== Constants.PLAYER_COLOR_BLACK?black:white\n    let score = playerWins+(draws/2)\n    let scorePercentage = score*100/totalGames\n    let ratingChange = Common.DP_TABLE[Math.round(scorePercentage)]\n    let performanceRating = null\n    if(averageOpponentElo) {\n        performanceRating = averageOpponentElo+ratingChange\n    }\n    return {\n        results:`+${simplifyCount(playerWins)}-${simplifyCount(playerLosses)}=${simplifyCount(draws)}`,\n        performanceRating:performanceRating,\n        averageOpponentElo: averageOpponentElo,// avg elo rating of opponents only\n        averageElo:averageElo, // avg elo rating of all players\n        score:`${Number.isInteger(scorePercentage)?scorePercentage:scorePercentage.toFixed(1)}% for ${playerColor === Constants.PLAYER_COLOR_BLACK?'black':'white'}`,\n        ratingChange:`${ratingChange===0?'':(ratingChange>0?'+':'-')}${Math.abs(ratingChange)}`\n    }\n}\n\nexport function isOpponentEloInSelectedRange(elo, range) {\n    if(range[1]===Constants.MAX_ELO_RATING) {\n        return elo>=range[0]\n    }\n    return elo<=range[1] && elo>=range[0]\n}\n\nexport function isDateMoreRecentThan(date, than) {\n    // give priority to game which has a date\n    if(!than) {\n        return false\n    }\n    if(!date) {\n        return true\n    } \n    return new Date(date)>new Date(than)\n}","import React, { useState } from 'react';\nimport Faq from 'react-faq-component';\nimport {\n  Navbar,\n  NavbarBrand,\n  NavbarToggler,\n  Collapse,\n  Nav,\n  UncontrolledDropdown,\n  DropdownToggle,\n  DropdownMenu,\n  DropdownItem,\n  Modal,\n  ModalHeader,\n  ModalFooter,\n  Button,\n  ListGroup,\n  ListGroupItem,\n  NavItem, NavLink, ModalBody\n} from 'reactstrap';\n\nimport {logoName, rowContentColor} from './DarkMode';\n\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faLightbulb, faCaretDown, faQuestionCircle, faMoon } from '@fortawesome/free-solid-svg-icons';\nimport { faDiscord, faYoutube} from '@fortawesome/free-brands-svg-icons';\n\nimport * as Constants from '../app/Constants';\nimport {trackEvent} from '../app/Analytics';\n\nconst GlobalHeader = (props) => {\n  const darkMode = props.settings.darkMode\n  const [isOpen, setIsOpen] = useState(false)\n  const toggle = () => setIsOpen(!isOpen)\n\n  const [modal, setModal] = useState(false);\n  const toggleModal = () => {\n    if(!modal) {\n      trackEvent(Constants.EVENT_CATEGORY_GLOBAL_HEADER, \"AcknowledgementsOpen\")\n    }\n    setModal(!modal)\n  }\n  const toggleDarkMode = () => {\n    trackEvent(Constants.EVENT_CATEGORY_GLOBAL_HEADER, \"DarkModeToggle\")\n    props.settingsChange(Constants.SETTING_NAME_DARK_MODE, !darkMode)\n  }\n\n  const [isFAQOpen, setFAQOpen] = useState(false);\n  const toggleFAQModal = () => {\n    if(!isFAQOpen) {\n      trackEvent(Constants.EVENT_CATEGORY_GLOBAL_HEADER, \"FaqOpen\")\n    }\n    setFAQOpen(!isFAQOpen)\n  }\n\n  const launch = (url, eventName) => {\n    return () => {\n      if(eventName) {\n        trackEvent(Constants.EVENT_CATEGORY_GLOBAL_HEADER, eventName)\n      }\n      window.open(url, \"_blank\")\n    }\n  }\n\n  const getHelpDropDown = ()=>{\n    return <UncontrolledDropdown>\n    <DropdownToggle className=\"bootNavColor\" nav>\n    <FontAwesomeIcon icon={faQuestionCircle} className=\"moreIcon\"/>Help\n    </DropdownToggle>\n    <DropdownMenu right>\n      <DropdownItem onClick={toggleFAQModal}>\n        <span>\n          FAQ\n        </span>\n      </DropdownItem>\n      <DropdownItem onClick={props.toggleFeedback}>\n        <span>\n          Send feedback\n        </span>\n      </DropdownItem>\n      <DropdownItem onClick={launch(\"https://www.openingtree.com/old\", \"OldVersion\")}>\n          <span>\n            Old version\n          </span>\n        </DropdownItem>\n    </DropdownMenu>\n  </UncontrolledDropdown>\n  }\n\n  const getMoreDropDown = ()=> {\n      return <UncontrolledDropdown>\n      <DropdownToggle className=\"bootNavColor\" nav>\n      <FontAwesomeIcon icon={faCaretDown} className=\"moreIcon\"/>More\n      </DropdownToggle>\n      <DropdownMenu right>\n        <DropdownItem onClick={toggleModal}>\n          <span>\n            Acknowledgements\n          </span>\n        </DropdownItem>\n        <DropdownItem onClick={launch(\"https://github.com/openingtree/openingtree\",\"github\")}>\n          <span>\n            Github\n          </span>\n        </DropdownItem>\n        <DropdownItem divider />\n        <DropdownItem onClick={launch(\"https://lichess.org/\",\"lichess\")}>\n          <span>\n            Lichess.org\n          </span>\n        </DropdownItem>\n        <DropdownItem onClick={launch(\"https://www.lichess4545.com/\",\"lichess4545\")}>\n          <span>\n            Lichess4545\n          </span>\n        </DropdownItem>\n        <DropdownItem onClick={launch(\"https://www.chess.com\",\"chessDotCom\")}>\n          <span>\n            Chess.com\n          </span>\n        </DropdownItem>\n      </DropdownMenu>\n    </UncontrolledDropdown>\n\n  }\n\n  const data = {\n    rows: [\n      {\n          title: \"What is OpeningTree.com?\",\n          content: `OpeningTree.com is an open source website that helps you analyze anyone's lichess or chess.com games. You can use it to prepare for your opponents, improve your own game or learn from openings that grandmasters play.`,\n      },\n      {\n        title: \"How do I use OpeningTree?\",\n        content: `To try it out, you can load Magnus Carlsen's games by choosing, lichess as the source, enter \"DrNykterstein\" in the user name, choose \"white\" and click \"Analyze games\". Hit the stop link when a few hundred games have loaded and click \"View moves\". You can see the moves that Carlsen played as white in his recent games and his win percentages there. You can dig deeper into various lines. The moves shown for black are the moves that were played by his opponents against him.`,\n      },\n      {\n        title: \"What are some of the advanced features of OpeningTree?\",\n        content: `You can analyze games of notable grandmasters from Morphy to Nakamura. You can also analyze games from lichess tournaments to see which moves are being played by others. You can also save openingtree files locally and load them fast or load them from pgn files.`,\n      },\n\n      {\n        title: \"Do I need to login to lichess?\",\n        content: `You dont need to, but logging in increases the speed of download of games from lichess. So if you plan on processing hundreds of games, it is recommended that you login.`,\n      },\n      {\n        title: \"Do I need to keep reloading games everytime I want to analyze the same player? OR What is a .tree file?\",\n        content: `If you plan to keep reloading the same player's games over and over again. The better option is to use the \"Save .tree file\" button after your games have loaded. This saves a pre-processed file of all the games on your local computer. You can then load the file using the \"Load .tree file\" option as the source and load the same file. It can load thousands of games in a matter of seconds.`,\n      },\n      {\n        title: \"Is there a way to filter games by time control, choose only recent games etc.?\",\n        content:`Yes. You can click on \"Advanced filters\" under the \"Color and filters\" panel of openingtree to see many different filtering options that are available.`,\n      },\n      {\n        title: \"What do the triangles under the bars indicate?\",\n        content: `Little triangles indicate the openingbook statistics on the moves tab and the player statistics on the openingbook tab.\n        Everything left of the white triangle is a win for white, everything right of the black triangle is a win for black and everything in the middle is a draw.\n        If there is only a black triangle and no white, it means there are no draws.`,\n      }\n    ]\n  };\n\n  const styles = {\n    // bgColor: 'white',\n    rowTitleColor: \"black\",\n    rowContentColor: rowContentColor(darkMode),\n    rowTitleTextSize:'small',\n    rowContentTextSize:'small',\n    rowContentPaddingTop:'1'\n    // arrowColor: \"red\",\n  };\n\n  const config = {\n    // animate: true,\n    // arrowIcon: \"V\",\n    // tabFocus: true\n  };\n\n  const getFAQModal = ()=> {\n    return <Modal isOpen={isFAQOpen} toggle={toggleFAQModal}>\n      <ModalHeader toggle={toggleFAQModal}>Frequently asked questions</ModalHeader>\n      <ModalBody>\n      <Faq data={data} styles={styles} config={config} />\n      </ModalBody>\n      <ModalFooter>\n        <Button color=\"secondary\" onClick={toggleFAQModal}>Done</Button>\n      </ModalFooter>\n    </Modal>\n  };\n\n  const getAcknowledgementsModal = ()=> {\n    return <Modal isOpen={modal} toggle={toggleModal}>\n      <ModalHeader toggle={toggleModal}>Acknowledgements</ModalHeader>\n      <ListGroup className=\"acknowledgement\">\n        <ListGroupItem tag=\"a\" href=\"https://lichess.org/api\" target=\"_blank\" action>Lichess API</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.chess.com/club/chess-com-developer-community\" target=\"_blank\" action>Chess.com API</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://github.com/ruilisi/react-chessground\" target=\"_blank\" action>ChessGround</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://github.com/jhlywa/chess.js\" target=\"_blank\" action>Chess.js</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://github.com/niklasf/eco\" target=\"_blank\" action>Eco</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://github.com/jimmywarting/StreamSaver.js\" target=\"_blank\" action>StreamSaver.js</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.flaticon.com/authors/google/\" target=\"_blank\" action>Icons made by google</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.flaticon.com/\" target=\"_blank\" action>FlatIcons.com</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.freelogodesign.org\" target=\"_blank\" action>Free logo design</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://github.com/kevinludwig/pgn-parser\" target=\"_blank\" action>PGN Parser</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.npmjs.com/package/material-ui-dropzone\" target=\"_blank\" action>Dropzone</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.pgnmentor.com\" target=\"_blank\" action>PGN Mentor</ListGroupItem>\n        <ListGroupItem tag=\"a\" href=\"https://www.twitch.tv/imrosen\" target=\"_blank\" action>IM Eric Rosen</ListGroupItem>\n      </ListGroup>\n      <ModalFooter>\n        <Button color=\"secondary\" onClick={toggleModal}>\n          Done\n        </Button>\n      </ModalFooter>\n    </Modal>\n  }\n\n  return (\n    <div>\n      <Navbar color={darkMode?\"dark\":\"light\"} dark={darkMode} light={!darkMode} expand=\"md\">\n        <img src={logoName(darkMode)} height=\"32px\" width=\"32px\" alt=\"Logo\"/>\n        <NavbarBrand href=\"/\">&nbsp;OpeningTree.com</NavbarBrand>\n        <NavbarToggler onClick={toggle}/>\n        <Collapse isOpen={isOpen} navbar>\n          <Nav className={`mr-auto`} navbar>\n            <NavItem>\n              <NavLink className=\"navLinkButton\" onClick={launch(\"https://www.youtube.com/watch?v=AJ66-HqdpXE\",\"mainVideo\")}>\n                <span>\n                  \"It's so powerful\" - IM Eric Rosen\n                </span>\n                <span className=\"smallText\">\n                  [Video]\n                </span>\n              </NavLink>\n            </NavItem>\n          </Nav>\n          <Nav className=\"ml-auto\" navbar>\n            <NavItem>\n              <NavLink className=\"navLinkButton\" onClick={toggleDarkMode}>\n                <FontAwesomeIcon icon={darkMode?faLightbulb:faMoon} className=\"largeHeaderIcon\"/>\n                <span>\n                  {darkMode?\"Light mode\":\"Dark mode\"}\n                </span>\n              </NavLink>\n            </NavItem>\n          </Nav>\n          <Nav className=\"\" navbar>\n            <NavItem>\n              <NavLink className=\"navLinkButton\" onClick={launch(\"https://youtu.be/9w7GdGuJoyk\", \"tutorial\")}>\n                <FontAwesomeIcon icon={faYoutube} className=\"largeHeaderIcon\"/>\n                <span>\n                  Tutorial\n                </span>\n              </NavLink>\n            </NavItem>\n          </Nav>\n          <Nav className=\"\" navbar>\n            <NavItem>\n              <NavLink className=\"navLinkButton\" onClick={launch(Constants.OPENING_TREE_DISCORD,\"discord\")}>\n                <FontAwesomeIcon icon={faDiscord} className=\"discordIcon\"/>\n                <span>\n                  Discord\n                </span>\n              </NavLink>\n            </NavItem>\n          </Nav>\n          {getHelpDropDown()}\n          {getMoreDropDown()}\n        </Collapse>\n      </Navbar>\n\n      {getAcknowledgementsModal()}\n      {getFAQModal()}\n    </div>\n  )\n}\n\nexport default GlobalHeader\n","import React from 'react'\nimport {getNumberIcon} from './Common'\nimport { AccordionDetails, AccordionSummary } from '@material-ui/core';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Divider from '@material-ui/core/Divider';\nimport AccordionActions from '@material-ui/core/AccordionActions';\nimport {Accordion} from './Common'\nimport * as Constants from '../../app/Constants'\nimport { Collapse } from 'reactstrap'\nimport { trackEvent } from '../../app/Analytics'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { Button as MaterialUIButton } from '@material-ui/core'\nimport { faCaretDown, faCaretUp} from '@fortawesome/free-solid-svg-icons'\nimport AdvancedFilters from './AdvancedFilters'\nimport {advancedFilters} from './Common'\nimport MuiCollapse from '@material-ui/core/Collapse';\nimport * as SitePolicy from '../../app/SitePolicy'\nimport { Radio, FormControlLabel, RadioGroup, FormHelperText, FormControl, FormLabel} from '@material-ui/core';\nimport deepEqual from 'deep-equal'\n\nexport default class User extends React.Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            playerColor: this.props.playerColor,\n            isAdvancedFiltersOpen: false\n        }\n        this.timeframeSteps=this.props.timeframeSteps\n        Object.assign(this.state, this.props.advancedFilters)\n        this.defaultAdvancedFilters = this.props.advancedFilters\n    }\n\n    toggleRated() {\n        if (this.state.rated === 'all') {\n            this.setState({ rated: 'rated' })\n        } else if (this.state.rated === 'rated') {\n            this.setState({ rated: 'casual' })\n        } else {\n            this.setState({ rated: 'all' })\n        }\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"AdvancedFilterChange\", \"rated\")\n    }\n    toggleState(property) {\n        return () => {\n            let newState = {}\n            newState[property] = !this.state[property]\n            this.setState(newState)\n            trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"ToggleAdvancedFilters\", this.state.site)\n        }\n    }\n    playerColorChange(event) {\n        let playerColor = event.target.value\n        this.setState({ playerColor: playerColor })\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"ColorChange\", playerColor)\n        if(!SitePolicy.isAdvancedFiltersEnabled(this.props.site)) {\n            setImmediate(this.setFilters.bind(this))\n        }\n}\n    handleTimeControlChange(event) {\n        this.setState({ [event.target.name]: event.target.checked });\n    }\n    handleTimeframeChange(event, newValue) {\n        this.setState({ [Constants.FILTER_NAME_SELECTED_TIMEFRAME]: newValue });\n    }\n    handleEloRangeChange(event, newValue) {\n        this.setState({ [Constants.FILTER_NAME_ELO_RANGE]: newValue });\n    }\n    handleDownloadLimitChange(event, newValue) {\n        this.setState({ [Constants.FILTER_NAME_DOWNLOAD_LIMIT]: newValue });\n    }\n\n    setFilters(){\n        if(!this.state.playerColor) {\n            this.setState({colorError:\"Please select a color\"})\n            return\n        }\n        this.setState({colorError:\"\", isAdvancedFiltersOpen:false})\n        this.props.filtersChange(this.state)\n    }\n    getSummary(isDisabled) {\n        if(this.props.playerColor && !isDisabled) {\n            return <span>\n                {getNumberIcon('done')}\n                Color: <b>{this.props.playerColor===Constants.PLAYER_COLOR_WHITE?\"White\":\"Black\"} </b>\n                {this.areAdvancedFiltersApplied()?<span className=\"smallText\">(Filters applied)</span>:null}</span>\n\n        }\n        return <span>{getNumberIcon(3)} Color and filters</span>\n    }\n    componentWillReceiveProps(newProps) {\n        this.setState({...newProps.advancedFilters, playerColor:newProps.playerColor})\n    }\n\n    areAdvancedFiltersApplied(){\n        for (let [key, value] of Object.entries(this.defaultAdvancedFilters)) {\n            if(this.props.advancedFilters[key]===value) {\n                continue\n            }\n            if(!deepEqual(this.props.advancedFilters[key], value)) {\n                return true\n            }\n        }\n        return false\n    }\n\n\n    render(){\n        let isDisabled = !SitePolicy.isFilterPanelEnabled(this.props.site, this.props.playerName, this.props.selectedNotablePlayer)\n        return <Accordion expanded={this.props.expandedPanel === 'filters'}\n            TransitionComponent={MuiCollapse}\n            TransitionProps={{timeout:Constants.LOADER_ANIMATION_DURATION_MS}}\n            onChange={this.props.handleExpansionChange}\n            disabled={isDisabled}>\n            <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                {this.getSummary(isDisabled)}\n            </AccordionSummary>\n            <AccordionDetails>\n                <div className=\"pgnloadersection\">\n                    <FormControl component=\"fieldset\" error={!!this.state.colorError}>\n                        <FormLabel component=\"legend\">Games where <b>{this.props.playerName}</b> is playing as:</FormLabel>\n                        <RadioGroup onChange={this.playerColorChange.bind(this)} value={this.state.playerColor}>\n                            <FormControlLabel className=\"whitelabel\" control={<Radio color=\"primary\" />} value={Constants.PLAYER_COLOR_WHITE} label={this.state.playerColor === Constants.PLAYER_COLOR_WHITE?<b>White</b>:\"White\"}/>\n                            <FormControlLabel className=\"blacklabel\" control={<Radio color=\"primary\" />} value={Constants.PLAYER_COLOR_BLACK} label={this.state.playerColor === Constants.PLAYER_COLOR_BLACK?<b>Black</b>:\"Black\"}/>\n                        </RadioGroup>\n                        <FormHelperText>{this.state.colorError}</FormHelperText>\n                    </FormControl>\n                </div>\n                {SitePolicy.isAdvancedFiltersEnabled(this.props.site)?<div className=\"pgnloadersection\"><span className=\"linkStyle\" onClick={this.toggleState('isAdvancedFiltersOpen').bind(this)}>Advanced filters <FontAwesomeIcon icon={this.state.isAdvancedFiltersOpen ? faCaretUp : faCaretDown} /></span>\n                    <Collapse isOpen={this.state.isAdvancedFiltersOpen}>\n                            <AdvancedFilters\n                                site={this.props.site}\n                                toggleRated={this.toggleRated.bind(this)}\n                                handleTimeControlChange={this.handleTimeControlChange.bind(this)}\n                                handleTimeframeChange={this.handleTimeframeChange.bind(this)}\n                                handleEloRangeChange={this.handleEloRangeChange.bind(this)}\n                                timeframeSteps={this.timeframeSteps}\n                                handleDownloadLimitChange={this.handleDownloadLimitChange.bind(this)}\n                                advancedFilters={advancedFilters(this.state)}\n                            />\n                    </Collapse>\n                </div>:null}\n            </AccordionDetails>\n            <Divider />\n            <AccordionActions>\n                <MaterialUIButton size=\"small\" color=\"primary\" onClick={this.setFilters.bind(this)}>Continue</MaterialUIButton>\n            </AccordionActions>\n        </Accordion>\n\n    }\n}","import React from 'react'\nimport * as Constants from '../../app/Constants'\nimport { trackEvent } from '../../app/Analytics'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { Button as MaterialUIButton } from '@material-ui/core'\nimport PGNReader from '../../app/PGNReaderWorker'\nimport { faList} from '@fortawesome/free-solid-svg-icons'\nimport GetApp from '@material-ui/icons/GetApp'\nimport Equalizer from '@material-ui/icons/Equalizer'\nimport Fade from '@material-ui/core/Fade'\nimport Save from '@material-ui/icons/Save';\nimport * as SitePolicy from '../../app/SitePolicy'\nimport {Tooltip} from '@material-ui/core'\nimport HourglassEmptyIcon from '@material-ui/icons/HourglassEmpty';\nimport {serializeOpeningTree, deserializeOpeningTree} from '../../app/OpeningTreeSerializer'\nimport {proxy} from 'comlink'\nimport streamsaver from 'streamsaver'\nimport cookieManager from '../../app/CookieManager'\n\nexport default class Actions extends React.Component {\n    constructor(props) {\n        super(props) \n        this.state = {\n            isGamesSubsectionOpen : false,\n            exportingInProgress : false\n        }\n        streamsaver.mitm = \"download/download-mitm.html\"\n        this.encoder = new TextEncoder()\n\n    }\n    unload = () => {\n        if (this.pgnReader) {\n            this.pgnReader.stopDownloading()\n        }\n    }\n    componentDidMount() {\n        window.addEventListener(\"beforeunload\", this.unload);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"beforeunload\", this.unload);\n    }\n    importTreeClicked() {\n        this.setState({exportingInProgress:true})\n        trackEvent(Constants.EVENT_CATEGORY_MAIN_ACTION, \"LoadTree\", this.props.site, this.props.playerColor === Constants.PLAYER_COLOR_WHITE ? 1 : 0)\n        setImmediate(this.importOpeningTree.bind(this))\n    }\n    importOpeningTree() {\n        deserializeOpeningTree(this.props.files[0], \n            (err,data, subMesage)=> {\n                if(err) {\n                    this.props.showError(err, null, subMesage)\n                    this.setState({exportingInProgress:false})\n                    return\n                }\n                let success = this.props.importOpeningTreeObject(data)\n                this.setState({exportingInProgress:false})\n                if(success) {\n                    this.props.showInfo(\"Successfuly loaded openingtree\")                \n                }\n            })\n    }\n    exportTreeClicked() {\n        this.setState({exportingInProgress:true})\n        trackEvent(Constants.EVENT_CATEGORY_MAIN_ACTION, \"SaveTree\", this.props.site, this.props.playerColor === Constants.PLAYER_COLOR_WHITE ? 1 : 0)\n        setImmediate(this.exportOpeningTree.bind(this))\n    }\n    exportOpeningTree() {\n        serializeOpeningTree(this.props.exportOpeningTreeObject(), \n            SitePolicy.exportFileName(this.props.site, this.props.playerName, this.props.playerColor, null, \"tree\"), \n            (err, info) => {\n                if(err) {\n                    this.props.showError(err)                    \n                } else {\n                    this.props.showInfo(info)\n                }\n                this.setState({exportingInProgress:false})\n            })\n    }\n    abortDownloading() {\n        if(this.fileWriter) {\n            this.fileWriter.close()\n            this.fileWriter = null\n        }\n    }\n\n    getPgnString(game){\n        return `${Object.entries(game.headers).map(header=>`[${header[0]} \"${header[1]}\"]`).join(\"\\n\")}\n                \\n${game.moves.map((moveObject, index)=>{\n                    return `${index%2!==0?'':index/2+1+\".\"} ${moveObject.move}`\n                }).join(' ')} ${game.result}\\n\\n\\n`\n    }\n    downloadResponse(result, pendingDownloads) {\n        this.fileWriter.write(this.encoder.encode(result.map(game=>this.getPgnString(game)).join(\"\"))).then(()=>{\n            if(!pendingDownloads) {\n                this.abortDownloading()\n                return false\n            }\n        })\n        return true\n    }\n\n    readPgn(shouldDownloadToFile) {\n        if(shouldDownloadToFile) {\n            let fileStream =  streamsaver.createWriteStream(\n                SitePolicy.exportFileName(\n                    this.props.site, this.props.playerName, \n                    this.props.playerColor, this.props.selectedNotableEvent, \"pgn\"))\n            this.fileWriter = fileStream.getWriter()\n        }\n\n        new PGNReader(this.props.variant).then((readerInstance) => {\n            this.pgnReader = readerInstance\n            this.pgnReader.fetchPGNFromSite(this.props.playerName,\n                this.props.playerColor,\n                this.props.site,\n                this.props.selectedNotablePlayer,\n                this.props.selectedNotableEvent,\n                this.props.selectedOnlineTournament,\n                shouldDownloadToFile,\n                this.props.advancedFilters,\n                proxy(this.props.notify),\n                proxy(this.props.showError),\n                proxy(this.stopDownloading.bind(this)),\n                this.props.files,\n                proxy(this.downloadResponse.bind(this)),\n                this.getTokens())\n        })\n    }\n    \n    getTokens(){\n        return {\n            lichess:cookieManager.getLichessAccessToken()\n        }\n    }\n    download() {\n        this.readPgn(true)\n        trackEvent(Constants.EVENT_CATEGORY_MAIN_ACTION, \"Download\", this.props.site, this.props.playerColor === Constants.PLAYER_COLOR_WHITE ? 1 : 0)\n\n    }\n\n    getPlayerName() {\n        if(this.props.site === Constants.SITE_PLAYER_DB) {\n            return this.props.selectedNotablePlayer.name\n        }\n        return this.props.playerName\n    }\n    componentWillReceiveProps(newProps) {\n        if(newProps.gamesProcessed>0) {\n            this.setState({isGamesSubsectionOpen:true})\n        }\n    }\n\n    load() {\n        this.props.clear()\n        this.setState({ isGamesSubsectionOpen: true, loadedSite:this.props.site })\n        // set the player name and color in the global state\n        this.props.onChange(\"playerName\", this.props.playerName)\n        this.props.onChange(\"playerColor\", this.props.playerColor)\n        this.readPgn(false)\n        this.props.setDownloading(true)\n        trackEvent(Constants.EVENT_CATEGORY_MAIN_ACTION, \"Load\", this.props.site, this.props.playerColor === Constants.PLAYER_COLOR_WHITE ? 1 : 0)\n    }\n    stopDownloading() {\n        this.props.setDownloading(false)\n    }\n    stopDownloadingAction() {\n        this.stopDownloading()\n        trackEvent(Constants.EVENT_CATEGORY_MAIN_ACTION, \"StopDownloading\", this.props.site)\n    }\n    openingTreeLoadActions() {\n        return <div className=\"pgnloadersection\">\n            <MaterialUIButton\n            onClick={this.importTreeClicked.bind(this)}\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={this.state.exportingInProgress?<HourglassEmptyIcon/>:<GetApp/>}\n            className=\"mainButton\" disableElevation\n            disabled={this.state.exportingInProgress}\n            >\n                {this.state.exportingInProgress?\"Loading from file\":\"Load openingtree\"}\n        </MaterialUIButton></div>\n    }\n    regularActions() {\n        let downloadDisabledReason = SitePolicy.treeSaveDisabledReason(\n                                        this.state.loadedSite, \n                                        this.props.site,\n                                        this.props.gamesProcessed, \n                                        this.props.isDownloading)\n        return <div>\n        <div className=\"pgnloadersection\"><MaterialUIButton\n            onClick={this.load.bind(this)}\n            variant=\"contained\"\n            color=\"primary\"\n            startIcon={<Equalizer />}\n            className=\"mainButton\" disableElevation\n        >\n            Analyze games\n        </MaterialUIButton></div>\n        <div className=\"pgnloadersection\"><MaterialUIButton\n            onClick={this.download.bind(this)}\n            variant=\"contained\"\n            color=\"default\"\n            startIcon={<GetApp />}\n            className=\"mainButton\" disableElevation\n        >\n            Export as PGN\n        </MaterialUIButton></div>\n        {\n            <div className=\"pgnloadersection\"><Tooltip placement=\"top\" title={downloadDisabledReason||\"Save a .tree file locally for faster reload later\"}>\n                <span><MaterialUIButton\n                onClick={this.exportTreeClicked.bind(this)}\n                variant=\"contained\"\n                color=\"default\"\n                startIcon={this.state.exportingInProgress?<HourglassEmptyIcon/>:<Save/>}\n                className=\"mainButton\" disableElevation\n                disabled={!!downloadDisabledReason || this.state.exportingInProgress}\n                >\n                    {this.state.exportingInProgress?\"Saving to file\":\"Save .tree file\"}\n                </MaterialUIButton></span></Tooltip></div>\n            }\n        {\n            this.state.isGamesSubsectionOpen ?\n                <div>\n                    <div className=\"pgnloadersection\">\n                        {!this.props.playerColor?\"Games\":this.props.playerColor === Constants.PLAYER_COLOR_WHITE?\"White games\":\"Black games\"}{` loaded: ${this.props.gamesProcessed} `}{this.props.isDownloading ? <span className=\"stopDownloading\">[<span className=\"linkStyle\" onClick={this.stopDownloadingAction.bind(this)}><img alt=\"loading spinner\" src=\"./spinner.gif\" height=\"15\" />stop</span>]</span> : \"\"}\n                    </div>\n                    <div onClick={() => this.props.switchToMovesTab()} className=\"navLinkButton pgnloadersection\">\n                        <FontAwesomeIcon icon={faList} /> View Moves&gt;&gt;\n                </div>\n                </div>\n                : \"\"\n        }\n        </div>\n    }\n    mainComponent() {\n        if(this.props.site === Constants.SITE_OPENING_TREE_FILE) {\n            return this.openingTreeLoadActions()\n        }\n        return this.regularActions()\n    }\n    render(){\n        if(this.props.expandedPanel) {\n            return <Fade timeout={Constants.LOADER_ANIMATION_DURATION_MS*2}>\n            {this.mainComponent()}\n        </Fade>\n        }\n        return <Fade in timeout={Constants.LOADER_ANIMATION_DURATION_MS*3}>\n            {this.mainComponent()}\n        </Fade>\n    }\n}","import {wrap} from 'comlink'\n\nconst PGNReader = wrap(new Worker('./PGNReader.js', { type: 'module' }))\n\nexport default PGNReader","import * as Constants from '../app/Constants'\nimport {trackEvent} from '../app/Analytics'\nimport {copyText} from './loader/Common'\nimport {chessLogic} from '../app/chess/ChessLogic'\nimport OpeningGraph from '../app/OpeningGraph'\nimport {fetchBookMoves} from '../app/OpeningBook'\nimport CookieManager from '../app/CookieManager'\nimport { handleDarkMode } from './DarkMode';\n\nfunction turnColor() {\n    return fullTurnName(this.chess.turn())\n}\n\nfunction fullTurnName(shortName) {\n    return shortName === 'w' ? Constants.PLAYER_COLOR_WHITE : Constants.PLAYER_COLOR_BLACK\n}\n\nfunction playerColor() {\n    return this.state.settings.playerColor\n}\n\nfunction brushes() {\n    if(!this.playerColor() || this.playerColor() === this.turnColor()) {\n        return this.forBrushes\n    }\n    return this.againstBrushes\n}\nfunction highlightArrow(move) {\n    this.setState({highlightedMove:move})\n}\n\nfunction calcMovable() {\nconst dests = {}\n    this.chess.SQUARES.forEach(s => {\n        const ms = this.chess.moves({square: s, verbose: true})\n        if (ms.length) dests[s] = ms.map(m => m.to)\n    })\n    return {\n        free: false,\n        dests,\n        color: this.turnColor()\n    }\n}\n\nfunction orientation() {\n    return this.state.settings.orientation\n}\n\nfunction onMove(sanOrOrig, dest) {\n    let moveObj = null\n    if(dest) {\n        moveObj = { from:sanOrOrig, to:dest, promotion: 'q'}\n    } else {\n        moveObj = sanOrOrig\n    }\n    const chess = this.chess\n    let move = chess.move(moveObj)\n    this.setState({ fen: chess.fen(), lastMove: move})\n}\n\n\nfunction onMoveAction(sanOrOrig, dest) {\n    this.onMove(sanOrOrig, dest)\n    trackEvent(Constants.EVENT_CATEGORY_CHESSBOARD, \"Move\")\n}\n\nfunction navigateTo(fen, previousMove){\n    this.chess = chessLogic(this.state.variant, fen)\n    this.setState({fen:fen, lastMove:previousMove})\n}\nfunction updateProcessedGames(downloadLimit, n, parsedGame) {\n    let totalGamesProcessed = this.state.gamesProcessed+n\n    this.state.openingGraph.addPGN(parsedGame.pgnStats, parsedGame.parsedMoves,\n            parsedGame.latestFen,parsedGame.playerColor, this.state.variant)\n    this.setState({\n        gamesProcessed: totalGamesProcessed,\n        downloadingGames: (totalGamesProcessed<downloadLimit || downloadLimit>=Constants.MAX_DOWNLOAD_LIMIT)?this.state.downloadingGames:false\n    })\n    // continue to download games if\n    // 1. we have not reached download limit OR\n    //    there is no download limit set (downloadLimit>MAX condition)\n    // 2. user did not hit stop button\n    return (totalGamesProcessed < downloadLimit || downloadLimit>=Constants.MAX_DOWNLOAD_LIMIT)&& this.state.downloadingGames\n}\nfunction moveToShape(move) {\n    return {\n        orig:move.orig,\n                    dest: move.dest !== move.orig? move.dest:null,\n                    brush: this.brushes()[move.level]\n    }\n}\n\nfunction autoShapes(moves, highlightedMove) {\n    var shapes = []\n    if(highlightedMove) {\n        if(!highlightedMove.orig || !highlightedMove.dest) {\n            let chess = chessLogic(this.state.variant, this.state.fen)\n            let move = chess.move(highlightedMove.san)\n            highlightedMove.orig=move.from\n            highlightedMove.dest=move.to\n        }\n        highlightedMove.level = 0\n        shapes.push(this.moveToShape(highlightedMove))\n    }\n    if(moves) {\n        shapes = shapes.concat(moves.filter((m)=>{\n            if(!highlightedMove) {\n                return true\n            }\n            if (highlightedMove.orig === m.orig && highlightedMove.dest === m.dest) {\n                return false\n            }\n            return true\n        }).map(this.moveToShape.bind(this)))\n    }\n    return this.fillArray(shapes,  25)\n}\n\nfunction getPlayerMoves() {\n    if(!this.state.openingGraph.hasMoves) {\n        return null;\n    }\n    var moves = this.state.openingGraph.movesForFen(this.chess.fen())\n    return moves?moves.sort((a,b)=>b.moveCount-a.moveCount):[]\n}\n\nfunction gameResults() {\n    return this.state.openingGraph.gameResultsForFen(this.chess.fen())\n}\n\nfunction fillArray(arr, len) {\n    for (var i = arr.length; i < len; i++) {\n        arr.push({'orig':'i'+i, 'dest':'i'+(i+1), brush:this.brushes()[0]});\n    }\n    return arr;\n}\n\nfunction reset() {\n    this.chess = chessLogic(this.state.variant)\n    this.setState({fen: this.chess.fen(), lastMove:null})\n}\n\nfunction clear() {\n    this.state.openingGraph.clear()\n    this.state.gamesProcessed = 0\n    this.reset()\n}\n\nfunction settingsChange(name, value) {\n    if(name === Constants.SETTING_NAME_MOVES_SETTINGS ) {\n        let settingsToPersist = {}\n        settingsToPersist[name] = value\n        CookieManager.setSettingsCookie(settingsToPersist)\n        this.state.openingGraph.clearBookNodes()\n    } else if (name === Constants.SETTING_NAME_DARK_MODE) {\n        CookieManager.setDarkModeCookie(value)\n    }\n\n    let settings = this.state.settings\n    settings[name] = value;\n    this.setState({ settings });\n\n    if (name === Constants.SETTING_NAME_DARK_MODE) {\n        setImmediate(()=>handleDarkMode(value));\n    }\n}\n\nfunction launch(url) {\n    return () => {\n        window.open(url, \"_blank\")\n    }\n}\n\n\nfunction showError(message, trackingEvent, subMessage, action, severity) {\n    let errorActionText, errorAction\n    let messageSeverity = severity || Constants.ERROR_SEVERITY_ERROR\n    if(action === Constants.ERROR_ACTION_VISIT_OLD_SITE) {\n        errorActionText=\"Visit old site\"\n        errorAction = launch(\"https://www.openingtree.com/old\")\n    } else if(action !== Constants.ERROR_ACTION_NONE){\n        errorActionText=\"Report this\"\n        errorAction = this.toggleFeedback(true)\n    }\n    this.setState({message:message, subMessage:subMessage,\n        errorAction:errorAction, errorActionText:errorActionText,\n        messageSeverity:messageSeverity})\n    let eventName = messageSeverity+\"Shown\"\n    if(trackingEvent) {\n        eventName = eventName+\":\"+trackingEvent\n    }\n    trackEvent(Constants.EVENT_CATEGORY_MESSAGE_SHOWN,eventName, message)\n}\n\nfunction showInfo(message, trackingLabel) {\n    this.setState({message:message, messageSeverity:Constants.ERROR_SEVERITY_SUCCESS})\n    trackEvent(Constants.EVENT_CATEGORY_MESSAGE_SHOWN,\"infoShown\",\n        trackingLabel?trackingLabel:message)\n}\n\nfunction closeError() {\n    this.setState({message:'', subMessage:''})\n}\n\nfunction toggleFeedback(diagnosticsOpen) {\n    return () => {\n        let feedbackOpen = this.state.feedbackOpen\n        if(!feedbackOpen) {\n            trackEvent(Constants.EVENT_CATEGORY_GLOBAL_HEADER, \"feedbackOpen\")\n        }\n        this.closeError()\n        this.setState({feedbackOpen:!feedbackOpen,\n                diagnosticsDataOpen:diagnosticsOpen})\n    }\n}\n\nfunction setDownloading(val) {\n    this.setState({downloadingGames:val})\n}\n\nfunction toggleDiagnosticsData() {\n    this.setState({diagnosticsDataOpen:!this.state.diagnosticsDataOpen})\n}\n\nfunction copyDiagnostics() {\n    copyText(\"diagnosticsText\")\n    this.showInfo(\"Copied Diagnostics data\")\n}\n\n\nfunction importGameState(importState) {\n    let newSettings=importState.settings\n    //transfer objects from current settings that do not need serialization\n    newSettings.movesSettings=this.state.settings.movesSettings\n    this.setState({\n      settings:importState.settings,\n      openingGraph:importState.openingGraph,\n      gamesProcessed:importState.gamesProcessed,\n      variant:importState.variant?importState.variant:Constants.VARIANT_STANDARD\n    })\n    setImmediate(this.reset.bind(this))// setImmediate because we want the variant change to take effect\n  }\n  function getChessboardWidth(){\n    // getting nearest multiple of 8 because chessground has\n    // css alignment issues if board width is not a multple of 8\n\n    return `${nearestMultipleOf8(getChessboardWidthInternal())}px`\n  }\n  function nearestMultipleOf8(n){\n      while(n%8!==0) {\n          n++;\n      }\n      return n;\n  }\n  function getChessboardWidthInternal(){\n    // have to manually set the width to pixels instead of \"vw\" value\n    // this is because chessground component does not behave well with \"vw\" values\n    if (window.innerWidth<=768) {\n      return Math.round(window.innerWidth*95/100) //95vw\n    } else if ((window.innerWidth<=1424)) {\n      return Math.round(Math.min(window.innerWidth*48/100,Math.max(512,window.innerHeight-100))) // 40vw\n    } else {\n      return Math.round(Math.min(712,Math.max(512,window.innerHeight-100)))// innherHeight-100 to leave some space for header and footer\n    }\n\n  }\n\nfunction getDiagnosticsValue() {\n  return `--------------------\n  ${navigator.userAgent}\n  -------------------\n  ${JSON.stringify(this.state)}\n  -------------------\n  `\n}\nfunction getRedditLink() {\n    return `https://www.reddit.com/message/compose/?to=${Constants.OPENING_TREE_REDDIT}&subject=${this.getSubject()}&message=%0D%0A%0D%0A%0D%0A${this.getBody()}`\n}\n\nfunction getEmailLink() {\n    return `mailto:${Constants.OPENING_TREE_EMAIL}?subject=${this.getSubject()}&body=%0D%0A%0D%0A%0D%0A${this.getBody()}`\n}\n\nfunction getSubject() {\n    return this.state.diagnosticsDataOpen?\"Possible Openingtree bug\":\"Feedback on Openingtree\"\n}\nfunction getBody() {\n    return this.state.diagnosticsDataOpen?this.getDiagnosticsValue():\"\"\n}\n\nfunction variantChange(newVariant) {\n    this.setState({variant:newVariant, openingGraph:new OpeningGraph(newVariant)})\n    setImmediate(this.reset.bind(this))\n}\n\n// fetch the book moves openinggraph directly if they are available\n// otherwise\n//  1. fetch them from lichess\n//  2. store them in openinggraph\n//  3. update the component so that getBookMoves gets called again\nfunction getBookMoves() {\n    let moves = this.state.openingGraph.getBookNode(this.chess.fen())\n    if(this.state.settings.movesSettings.openingBookType === Constants.OPENING_BOOK_TYPE_OFF) {\n        return {fetch:'off'}\n    }\n\n    if(!moves) {\n        moves = this.forceFetchBookMoves()\n    }\n    return moves\n}\n\nfunction forceFetchBookMoves() {\n    let moves = fetchBookMoves(this.state.fen, this.state.variant, this.state.settings.movesSettings, (moves)=>{\n        this.state.openingGraph.addBookNode(this.chess.fen(), moves)\n        this.setState({update:this.state.update+1})\n    })\n    this.state.openingGraph.addBookNode(this.chess.fen(), moves)\n    setImmediate(()=>this.setState({update:this.state.update+1}))\n    return moves\n}\n\nfunction mergePlayerAndBookMoves(playerMovesToShow, bookMovesToShow) {\n    if(!playerMovesToShow) {\n        return\n    }\n    let bookMovesMap = createMap(bookMovesToShow.moves)\n    playerMovesToShow.forEach((move)=>{\n        let bookMove = bookMovesMap.get(move.san)\n        if(!bookMove) {\n            return\n        }\n        move.compareTo = {\n            bookScore:getCompareScores(bookMove),\n            userScore:getCompareScores(move),\n            values:getCompareToValues(bookMove)\n        }\n        bookMove.compareTo = {\n            bookScore:getCompareScores(bookMove),\n            userScore:getCompareScores(move),\n            values:getCompareToValues(move)\n        }\n    })\n}\nfunction getCompareScores(move){\n    return (move.details.whiteWins+move.details.draws/2)/move.details.count*100\n}\n\nfunction getCompareToValues(move) {\n    return [move.details.whiteWins/move.details.count*100,\n        (move.details.whiteWins+move.details.draws)/move.details.count*100]\n}\n\nfunction createMap(movesToShow){\n    let map = new Map()\n    if(!movesToShow) {\n        return map\n    }\n    movesToShow.forEach((move)=> {\n        map.set(move.san, move)\n    })\n    return map\n}\n\n\nfunction addStateManagement(obj){\n    obj.orientation  = orientation\n    obj.turnColor = turnColor\n    obj.calcMovable = calcMovable\n    obj.onMove = onMove\n    obj.onMoveAction = onMoveAction\n    obj.autoShapes = autoShapes\n    obj.updateProcessedGames = updateProcessedGames\n    obj.settingsChange = settingsChange\n    obj.reset = reset\n    obj.clear = clear\n    obj.navigateTo = navigateTo\n    obj.playerColor = playerColor\n    obj.fillArray = fillArray\n    obj.brushes = brushes\n    obj.moveToShape = moveToShape\n    obj.getPlayerMoves = getPlayerMoves\n    obj.gameResults = gameResults\n    obj.showError = showError\n    obj.showInfo = showInfo\n    obj.closeError = closeError\n    obj.toggleFeedback = toggleFeedback.bind(obj)\n    obj.setDownloading = setDownloading\n    obj.toggleDiagnosticsData = toggleDiagnosticsData.bind(obj)\n    obj.copyDiagnostics = copyDiagnostics.bind(obj)\n    obj.importGameState = importGameState\n    obj.getDiagnosticsValue = getDiagnosticsValue\n    obj.getChessboardWidth = getChessboardWidth\n    obj.getEmailLink = getEmailLink\n    obj.getSubject = getSubject\n    obj.getBody = getBody.bind(obj)\n    obj.getRedditLink = getRedditLink\n    obj.variantChange = variantChange\n    obj.getBookMoves = getBookMoves\n    obj.forceFetchBookMoves = forceFetchBookMoves\n    obj.mergePlayerAndBookMoves = mergePlayerAndBookMoves\n    obj.highlightArrow = highlightArrow\n}\n\nexport {addStateManagement}","import request from 'request'\nimport * as Common from './Common'\n\nexport function fetchBookMoves(fen, variant, bookSettings, callback) {\n    let ratings = bookSettings.openingBookRating\n    let speeds = bookSettings.openingBookTimeControls\n    let bookType = bookSettings.openingBookType\n    let url = `https://explorer.lichess.ovh/${bookType}?fen=${fen}&play=&variant=${Common.lichessPerf(variant)}${joinParams('ratings',ratings)}${joinParams('speeds',speeds)}`\n    request.get(url, (error, response) =>{\n        if(error) {\n            callback({fetch:\"failed\"})\n            return \n        }\n        try{\n            callback(JSON.parse(response.body))\n            return\n        } catch (e) {\n            console.log(e)\n        }\n        callback({fetch:\"failed\"})\n    })\n    return {fetch:\"pending\"}\n    //https://explorer.lichess.ovh/lichess?fen=rnbqkbnr%2Fpppppppp%2F8%2F8%2F8%2F8%2FPPPPPPPP%2FRNBQKBNR%20w%20KQkq%20-%200%201&play=&variant=kingOfTheHill&speeds%5B%5D=bullet&speeds%5B%5D=blitz&speeds%5B%5D=rapid&speeds%5B%5D=classical&ratings%5B%5D=1600&ratings%5B%5D=1800&ratings%5B%5D=2000&ratings%5B%5D=2200&ratings%5B%5D=2500\n\n}\n\nfunction joinParams(paramName, ratings) {\n    return ratings.map(r=>`&${paramName}[]=${r}`).join('')\n}\n","import green from '@material-ui/core/colors/green';\nimport amber from '@material-ui/core/colors/amber';\nimport IconButton from '@material-ui/core/IconButton';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport Button from '@material-ui/core/Button'\nimport {withStyles} from '@material-ui/core/styles';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport CloseIcon from '@material-ui/icons/Close';\nimport ErrorIcon from '@material-ui/icons/Error';\nimport InfoIcon from '@material-ui/icons/Info';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport * as React from 'react';\n\nconst variantIcon = {\n    success: CheckCircleIcon,\n    warning: WarningIcon,\n    error: ErrorIcon,\n    info: InfoIcon,\n};\n\nconst styles = (theme) => ({\n    success: {\n        backgroundColor: green[600],\n    },\n    error: {\n        backgroundColor: theme.palette.error.dark,\n    },\n    info: {\n        backgroundColor: theme.palette.primary.dark,\n    },\n    warning: {\n        backgroundColor: amber[700],\n    },\n    icon: {\n        fontSize: 20,\n    },\n    iconVariant: {\n        opacity: 0.9,\n        marginRight: theme.spacing(1),\n    },\n    message: {\n        display: 'flex',\n        alignItems: 'center',\n    },\n});\n\nfunction SnackbarContentWrapper(props) {\n    const {classes, className, message, onClose, variant, subMessage, action, actionText, showReportButton, ...other} = props;\n    const Icon = variantIcon[variant];\n\n    return (\n        <SnackbarContent\n            className={clsx(classes[variant], className)}\n            aria-describedby=\"client-snackbar\"\n            message={\n                <div><span id=\"client-snackbar\" className={classes.message}>\n                    <Icon className={clsx(classes.icon, classes.iconVariant)} />\n                    {message} \n                    \n                </span>\n                {!subMessage?null:<div className=\"smallText\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{subMessage}</div>}\n                </div>\n            }\n            action={[ \n                !showReportButton?null:<Button key=\"report\" onClick = {action} color=\"inherit\" size=\"small\">\n                  {actionText}\n                </Button>,\n                <IconButton\n                    key=\"close\"\n                    aria-label=\"Close\"\n                    color=\"inherit\"\n                    className={classes.close}\n                    onClick={onClose}\n                >\n                    <CloseIcon className={classes.icon} />\n                </IconButton>\n            ]}\n            {...other}\n        />\n    );\n}\n\nSnackbarContentWrapper.propTypes = {\n    classes: PropTypes.object.isRequired,\n    className: PropTypes.string,\n    message: PropTypes.node,\n    onClose: PropTypes.func,\n    onReport: PropTypes.func,\n    subMessage: PropTypes.string,\n    showReportButton: PropTypes.bool,\n    variant: PropTypes.oneOf(['success', 'warning', 'error', 'info']).isRequired,\n};\n\nexport default withStyles(styles)(SnackbarContentWrapper);","import { Accordion, getNumberIcon } from './Common';\nimport * as Constants from '../../app/Constants';\n\nimport React from 'react';\n\nimport {\n    AccordionActions,\n    AccordionDetails,\n    AccordionSummary,\n    Button as MaterialUIButton,\n    Collapse,\n    Divider,\n    FormControlLabel,\n    Radio,\n    RadioGroup\n} from '@material-ui/core';\n\nimport {\n    Backup,\n    DateRange,\n    ExpandMore,\n    People,\n    Save\n} from '@material-ui/icons';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChessRook } from '@fortawesome/free-solid-svg-icons';\n\nconst SOURCE_VARIANT_COMBINATION = {\n    [Constants.VARIANT_RACING_KINGS]:[Constants.SITE_LICHESS, Constants.SITE_ONLINE_TOURNAMENTS, Constants.SITE_OPENING_TREE_FILE, Constants.SITE_PGN_FILE],\n    [Constants.VARIANT_KING_OF_THE_HILL]:[Constants.SITE_CHESS_DOT_COM, Constants.SITE_LICHESS, Constants.SITE_ONLINE_TOURNAMENTS, Constants.SITE_OPENING_TREE_FILE, Constants.SITE_PGN_FILE],\n    [Constants.VARIANT_THREE_CHECK]:[Constants.SITE_CHESS_DOT_COM, Constants.SITE_LICHESS, Constants.SITE_ONLINE_TOURNAMENTS, Constants.SITE_OPENING_TREE_FILE, Constants.SITE_PGN_FILE],\n    [Constants.VARIANT_CRAZYHOUSE]:[Constants.SITE_CHESS_DOT_COM, Constants.SITE_LICHESS, Constants.SITE_ONLINE_TOURNAMENTS, Constants.SITE_OPENING_TREE_FILE, Constants.SITE_PGN_FILE]\n}\n\nexport default class Source extends React.Component {\n    getSourceOption(source, addNumber) {\n        if (source === Constants.SITE_LICHESS) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<img alt=\"lichess\" className=\"siteimage\" src=\"./lichesslogo.png\" /><span className=\"sourceName\"> lichess.org </span></span>\n        } else if (source === Constants.SITE_CHESS_DOT_COM) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<img alt=\"chess.com\" className=\"siteimage\" src=\"./chesscomlogo.png\" /></span>\n        } else if (source === Constants.SITE_PGN_FILE) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<Backup className=\"lowOpacity\"/><span className=\"sourceName\"> Load <i>PGN</i> file</span></span>\n        } else if (source === Constants.SITE_EVENT_DB) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<DateRange className=\"lowOpacity\"/><span className=\"sourceName\"> Notable chess events</span></span>\n        } else if (source === Constants.SITE_PLAYER_DB) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<People className=\"lowOpacity\"/><span className=\"sourceName\"> Notable chess players</span></span>\n        }  else if (source === Constants.SITE_OPENING_TREE_FILE) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<Save className=\"lowOpacity\"/><span className=\"sourceName\"> Load <b>.tree</b> file</span></span>\n        } else if (source === Constants.SITE_ONLINE_TOURNAMENTS) {\n            return <span>{addNumber?getNumberIcon('done', addNumber):null}<FontAwesomeIcon icon={faChessRook} className=\"lowOpacity\" /><span className=\"sourceName\"> Lichess tournaments</span></span>\n        }\n        return <span>{getNumberIcon(1, addNumber)}Select a source</span>\n    }\n    continue(){\n        this.props.siteChange(this.props.site)\n    }\n    setSite(event) {\n        let newSite = event.target.value\n        this.props.siteChange(newSite)\n    }\n    isSourceAvailable(source, variant) {\n        let supportedSources = SOURCE_VARIANT_COMBINATION[variant]\n        if(!supportedSources) {\n            return true\n        }\n        return supportedSources.includes(source)\n    }\n    render() {\n        return <Accordion TransitionComponent={Collapse}\n            TransitionProps={{timeout:Constants.LOADER_ANIMATION_DURATION_MS}}\n            expanded={this.props.expandedPanel === 'source'}\n            onChange={this.props.handleExpansionChange}>\n            <AccordionSummary\n                expandIcon={<ExpandMore />}\n                aria-controls=\"panel1c-content\"\n                id=\"panel1c-header\"\n            >\n                <div>\n                    {this.getSourceOption(this.props.site, true)}\n                </div>\n            </AccordionSummary>\n            <AccordionDetails>\n                <RadioGroup onChange={this.setSite.bind(this)} value={this.props.site}>\n                {this.getSourceRadio(Constants.SITE_LICHESS)}\n                {this.getSourceRadio(Constants.SITE_CHESS_DOT_COM)}\n                {this.getSourceRadio(Constants.SITE_ONLINE_TOURNAMENTS)}\n                {this.getSourceRadio(Constants.SITE_OPENING_TREE_FILE)}\n                {this.props.variant === Constants.VARIANT_STANDARD?<Divider className=\"dividerMargin\"/>:null}\n                {this.getSourceRadio(Constants.SITE_PLAYER_DB)}\n                {this.getSourceRadio(Constants.SITE_EVENT_DB)}\n                {this.getSourceRadio(Constants.SITE_PGN_FILE)}\n               </RadioGroup>\n            </AccordionDetails>\n            {this.props.site?\n            <span>\n            <Divider />\n\n            <AccordionActions>\n                    <MaterialUIButton size=\"small\" color=\"primary\" onClick={this.continue.bind(this)}>Continue</MaterialUIButton>\n                </AccordionActions></span>:\n                null\n            }\n        </Accordion>\n\n    }\n\n    getSourceRadio(source) {\n        if(!this.isSourceAvailable(source,this.props.variant)) {\n            return null\n        }\n        return <FormControlLabel\n                className=\"sitelabel\"\n                value={source}\n                control={<Radio color=\"primary\" />}\n                label={this.getSourceOption(source)} />\n    }\n}","import React from 'react'\nimport {DropzoneArea} from 'material-ui-dropzone'\nimport { trackEvent } from '../../app/Analytics'\nimport * as Constants from '../../app/Constants'\n\nexport default class Dropzone extends React.Component{\n    handleFileChange(newFiles) {\n      trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"FileSaved\", newFiles.length>0?newFiles[0].name:null)\n      this.props.filesChange(newFiles)\n    }\n    render(){\n      return (\n        <DropzoneArea \n        acceptedFiles={[]}\n        dropzoneText={this.props.dropzoneText}\n          onChange={this.handleFileChange.bind(this)}\n          dropzoneParagraphClass=\"dropzonetext\"\n          showFileNames={true}\n          useChipsForPreview={true}\n          previewChipProps={{className:\"previewChip\"}}\n          dropzoneClass=\"dropzone\"\n          filesLimit={this.props.filesLimit}\n          maxFileSize={3000000000000}\n          />\n      )  \n    }\n  } ","import SelectSearch from 'react-select-search';\nimport React from 'react'\nimport * as Constants from '../../app/Constants'\nimport { trackEvent } from '../../app/Analytics';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\n\nexport default class NotableChessGames extends React.Component {\n\n    updateDetails = (value) => {\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"NotableGameSelected\", value.value)\n        this.props.onChange(value)\n    }\n    \n    renderDetails(option) {\n        return (<div>\n                <span><LazyLoadImage alt={option.name} className=\"profilePicture\" width=\"40\" height=\"40\" src={option.profile.imageUrl} /></span>\n                <div>{option.name}</div>\n                <div className=\"smallText\">{option.profile.subText}</div>\n                </div>);\n    }\n    render() {\n        if(!this.props.list) {\n            return <div className=\"lowOpacity textCenter\"><img alt=\"loading\" width='25' height='25' src=\"./spinner.gif\"/> Loading List</div>\n        } else if(!this.props.list.length) {\n            return <div className=\"lowOpacity textCenter\"> Could not fetch list</div>\n        }\n        let options = this.props.list.map(option=>{return {...option, value:option.name}})\n        return <SelectSearch\n            name=\"goatPlayers\"\n            value={this.props.selectedDetail.value}\n            options={options}\n            placeholder={this.props.placeholder}\n            renderOption={this.renderDetails}\n            onChange={this.updateDetails}\n        />\n    }\n}\n","import React from 'react'\nimport {getNumberIcon} from './Common'\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport { Button as MaterialUIButton, TextField, AccordionDetails } from '@material-ui/core'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faInfoCircle} from '@fortawesome/free-solid-svg-icons'\nimport {faCheck, faSync, faSignOutAlt} from '@fortawesome/free-solid-svg-icons'\nimport Divider from '@material-ui/core/Divider';\nimport AccordionActions from '@material-ui/core/AccordionActions';\nimport {Accordion} from './Common'\nimport * as Constants from '../../app/Constants'\nimport Collapse from '@material-ui/core/Collapse';\nimport Dropzone from './Dropzone'\nimport NotableChessGames from './NotableChessGames';\nimport {Card, CardBody, CardText, CardTitle} from 'reactstrap'\nimport LockOpen from '@material-ui/icons/Lock'\nimport ExitToApp from '@material-ui/icons/ExitToApp'\nimport {Spinner} from 'reactstrap'\nimport { trackEvent } from '../../app/Analytics'\n\nexport default class User extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            playerName:'',\n            tournamentUrl:'',\n            files:[],\n            selectedPlayer:{},\n            selectedEvent:{}\n        }\n        \n    }\n\n    editPlayerName(event) {\n        this.setState({\n            playerName: event.target.value,\n            playerNameError:''\n        })\n    }\n    editTournamentUrl(event) {\n        this.setState({\n            tournamentUrl: event.target.value,\n            tournamentUrlError:''\n        })\n    }\n    filesChange(files) {\n        this.setState({files:files})\n    }\n\n    notablePlayerChange(player) {\n        this.setState({\n            selectedPlayer:player})\n    }\n    notableEventChange(event) {\n        this.setState({\n            selectedEvent:event})\n    }\n\n    componentWillReceiveProps(nextProps) {\n        this.setState({playerNameError:'', tournamentUrlError: ''})\n    }\n    \n    validateInputDetailsSet() {\n        if(this.props.site === Constants.SITE_EVENT_DB){\n            if(!this.state.selectedEvent){\n                this.props.showError(\"Please select an event\")\n                return false\n            } \n        } else if(this.props.site === Constants.SITE_PLAYER_DB){\n            if(!this.state.selectedPlayer){\n                this.props.showError(\"Please select a player\")\n                return false\n            } \n        } else if(this.props.site === Constants.SITE_LICHESS ||\n            this.props.site === Constants.SITE_CHESS_DOT_COM) {\n                if(!this.state.playerName){\n                    this.setState({\n                        playerNameError:'Please enter a username'\n                    })\n                    return false\n                } \n        } else if(this.props.site === Constants.SITE_PGN_FILE) {\n            if(this.state.files.length === 0) {\n                this.props.showError(\"Please upload a PGN file\")\n                return false\n            }\n        } else if(this.props.site === Constants.SITE_OPENING_TREE_FILE) {\n            if(this.state.files.length === 0) {\n                this.props.showError(\"Please upload an openingtree file\")\n                return false\n            }\n        } else if(this.props.site === Constants.SITE_ONLINE_TOURNAMENTS) {\n            if(!this.state.tournamentUrl){\n                this.setState({\n                    tournamentUrlError:'Please enter a url'\n                })\n                return false\n            } else {\n                \n                let url = this.state.tournamentUrl.trim()\n                if(!url.startsWith(\"http\")) {\n                    url = \"https://\"+url\n                }\n                let parsedUrl = null\n                try {\n                    parsedUrl = new URL(url)\n                } catch (e) {\n                    this.setState({\n                        tournamentUrlError:'Please enter a valid url'\n                    })\n                    return false\n                }\n                let hostname = parsedUrl.hostname\n                let tournamentSite = null;\n                if(hostname === 'lichess.org' || hostname.endsWith('.lichess.org')) {\n                    tournamentSite = Constants.SITE_LICHESS\n                } else if(hostname === 'chess.com' || hostname.endsWith('.chess.com')) {\n                    this.setState({\n                        tournamentUrlError:'chess.com tournaments are not currently supported'\n                    })\n                    return false;\n                }\n                if(!tournamentSite) {\n                    this.setState({\n                        tournamentUrlError:'Please enter a lichess.org url'\n                    })\n                    return false;\n                }\n                let pathComponents = parsedUrl.pathname.split(\"/\")\n                let tournamentId = null\n                let tournamentType = null\n                for(let i=0;i<pathComponents.length;i++) {\n                    if(pathComponents[i]) {\n                        tournamentType = pathComponents[i]\n                        break\n                    }\n                }\n\n                for(let i=pathComponents.length-1;i>=0;i--) {\n                    if(pathComponents[i]) {\n                        tournamentId = pathComponents[i]\n                        break\n                    }\n                }\n                if(!tournamentId) {\n                    this.setState({\n                        tournamentUrlError:'Please enter a valid tournament url'\n                    })\n                    return false;\n                }\n                \n                this.selectedOnlineTournament = {\n                    tournamentSite:tournamentSite,\n                    tournamentId:tournamentId,\n                    tournamentType:tournamentType\n                \n                }\n            }\n        }\n        return true\n    }\n    finalPlayerName(source, playerName, selectedNotablePlayer) {\n        if(source === Constants.SITE_PLAYER_DB) {\n            return selectedNotablePlayer.name\n        }\n        if(source === Constants.SITE_EVENT_DB) {\n            return ''\n        }\n        if(!playerName) {\n            return playerName\n        }\n        return playerName.trim()\n    }\n    setPlayerDetails() {\n         if(this.validateInputDetailsSet()) {\n            this.props.playerDetailsChange(\n                this.finalPlayerName(\n                    this.props.site, \n                    this.state.playerName,\n                    this.state.selectedPlayer), \n                this.state.files, \n                this.state.selectedEvent, \n                this.state.selectedPlayer,\n                this.selectedOnlineTournament)\n        }\n    }\n    \n    getSummary() {\n        if(this.props.site === Constants.SITE_PLAYER_DB){\n            if(this.props.selectedPlayer && this.props.selectedPlayer.name) {\n                return <span>\n                        {getNumberIcon('done')}\n                        {this.props.selectedPlayer.profile.title}{'\\u00A0'}\n                        <b>{this.props.selectedPlayer.name}</b>\n                    </span>\n            }\n        } else if(this.props.site === Constants.SITE_LICHESS || \n            this.props.site === Constants.SITE_CHESS_DOT_COM){\n            if(this.props.playerName) {\n                return <span>{getNumberIcon('done')}User: <b>{this.props.playerName}</b></span>\n            }\n        } else if(this.props.site === Constants.SITE_PGN_FILE || \n            this.props.site === Constants.SITE_OPENING_TREE_FILE){\n            if(this.props.files.length===1) {\n                return <span>{getNumberIcon('done')}File: <b>{this.props.files[0].name}</b></span>\n            }\n            if(this.props.files.length>1) {\n                return <span>{getNumberIcon('done')}{this.props.files.length} PGN files uploaded</span>\n            }\n        } else if(this.props.site === Constants.SITE_EVENT_DB) {\n            if(this.props.selectedEvent && this.props.selectedEvent.name) {\n                return <span>{getNumberIcon('done')}{this.props.selectedEvent.name}</span>\n            }\n        }\n        else if(this.props.site === Constants.SITE_ONLINE_TOURNAMENTS) {\n            if(this.props.selectedOnlineTournament) {\n                return <span>{getNumberIcon('done')}Id: <b>{this.props.selectedOnlineTournament.tournamentId}</b></span>\n            }\n        }\n        return <span>{getNumberIcon(2)}{this.title(this.props.site)}</span>\n    }\n\n    title(site){\n        if(site === Constants.SITE_ONLINE_TOURNAMENTS \n            || site === Constants.SITE_EVENT_DB) {\n            return \"Tournament details\"\n        } else if(site === Constants.SITE_OPENING_TREE_FILE \n            || site === Constants.SITE_PGN_FILE) {\n                return \"File details\"\n        } \n        return \"Player details\"\n    }\n\n    launchLichessOauth() {\n        trackEvent(\n            Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessLogin\")\n        setTimeout(()=>{\n            window.location.href = \n                'https://oauth.lichess.org/oauth/authorize?response_type=code&client_id=EBXrB9R9OXpaRvOU&scope=preference:read&redirect_uri=https%3A%2F%2Flichesslogin.openingtree.com&state='+window.location.pathname\n            }, 150)\n        }\n    getLichessSelection() {\n        return <div>\n            {this.getLichessCardBody()}\n            <br/>\n            {this.getPlayerNameInput('lichess username')}\n        </div>\n    }\n\n    getLichessCardBody() {\n        if (this.props.lichessLoginState === Constants.LICHESS_STATE_PENDING) {\n            return <Card>\n                <div className=\"center\">\n                    <Spinner className=\"bigSpinner dividerMargin\" /><br/>\n                </div>\n            </Card>\n        } else if(this.props.lichessLoginState === Constants.LICHESS_FAILED_FETCH) {\n            return <Card><CardBody className=\"singlePadding\">\n            <CardTitle className=\"smallBottomMargin redColor\"><FontAwesomeIcon icon={faInfoCircle} className=\"lowOpacity\"/> Failed to fetch login status</CardTitle>\n            <CardTitle className=\"smallBottomMargin\"><FontAwesomeIcon icon={faSync} className=\"lowOpacity smallText leftMargin2\"/>\n            <span onClick={this.props.refreshLichessStatus} className=\"smallText linkStyle leftMargin4\"> Retry fetching status</span>\n            </CardTitle>\n            <CardTitle><FontAwesomeIcon icon={faSignOutAlt} className=\"lowOpacity smallText leftMargin2\"/>\n            <span onClick={this.props.logoutOfLichess} className=\"smallText linkStyle leftMargin4\"> Logout of lichess</span>\n            </CardTitle>\n    \n                    <MaterialUIButton\n                onClick={this.launchLichessOauth}\n                variant=\"contained\"\n                color=\"default\"\n                className=\"mainButton\" disableElevation\n                startIcon={<LockOpen />}\n                >\n                    LOGIN AGAIN\n                </MaterialUIButton>\n            </CardBody></Card>\n        } else if (this.props.lichessLoginState === Constants.LICHESS_LOGGED_IN && this.props.lichessLoginName) {\n            return <Card>\n                <CardBody className=\"singlePadding\">\n                    <CardTitle>\n                        <FontAwesomeIcon icon={faCheck} className=\"lowOpacity greenColor\"/> Logged in as\n                        <b> {this.props.lichessLoginName}</b>\n                        \n                    </CardTitle>\n                    \n                    <MaterialUIButton\n                        onClick={this.props.logoutOfLichess}\n                        variant=\"contained\"\n                        color=\"default\"\n                        className=\"mainButton\" disableElevation\n                        startIcon={<ExitToApp />}\n                        >\n                            LOGOUT\n                    </MaterialUIButton>\n                </CardBody>\n            </Card>\n        }\n        return <Card><CardBody className=\"singlePadding\">\n        <CardTitle className=\"smallBottomMargin\"><FontAwesomeIcon icon={faInfoCircle} className=\"lowOpacity\"/> Speed up tree building (optional)</CardTitle>\n        <CardText className=\"smallText\">\n            Lichess allows much faster download of games if you login. You can learn more about this <a href = 'https://lichess.org/api#operation/apiGamesUser' rel=\"noopener noreferrer\" target=\"_blank\">here</a>. \n            Recommended for viewing your own games or when your opponent has lots of games.\n        </CardText>\n        <MaterialUIButton\n                onClick={this.launchLichessOauth}\n                variant=\"contained\"\n                color=\"default\"\n                className=\"mainButton\" disableElevation\n                startIcon={<LockOpen />}\n                >\n                    LOGIN TO LICHESS\n                </MaterialUIButton>\n        </CardBody>\n        </Card>\n    }\n\n    getChessComSelection() {\n        return this.getPlayerNameInput('chess.com username')\n    }\n\n    getPlayerNameInput(label, helperText) {\n        return <TextField\n            className=\"playernameField\" name=\"playerName\" id=\"playerNameTextBox\" \n            margin=\"dense\" onChange={this.editPlayerName.bind(this)}\n            label={label} variant=\"outlined\" value={this.state.playerName}\n            helperText={this.state.playerNameError? this.state.playerNameError:helperText}\n            error={this.state.playerNameError?true:false} onKeyUp={this.playerNameKeyUp.bind(this)}/>\n    }\n\n    getOnlineTournamentSelection() {\n        return <div>\n            {this.getOnlineTournamentCard()}\n            <br/>\n            {this.getOnlineTournamentInput('Enter tournament url', 'eg. https://lichess.org/tournament/QlooVt7W')}\n        </div>\n    }\n    getOnlineTournamentCard(){\n        return <Card>\n        <CardBody className=\"singlePadding\">\n        <CardTitle className=\"smallBottomMargin\"><FontAwesomeIcon icon={faInfoCircle} className=\"lowOpacity\"/> How it works</CardTitle>\n        <CardText className=\"smallText\">\n            You can load all of the games of a lichess tournament by copying the  url from your address bar on those sites and pasting it below.\n            <br/><br/>\n            <b>Why is chess.com not supported?</b>\n            <br/>chess.com API has a few bugs in returning tournament games so we are not able to support them currently. Bugs have been reported to chess.com.\n            \n        </CardText>\n        </CardBody>\n        </Card>\n    }\n    \n\n    getOnlineTournamentInput(label, helperText) {\n        return <TextField\n            className=\"urlField\" name=\"onlineTournament\" id=\"onlineTournamentTextBox\" \n            margin=\"dense\" onChange={this.editTournamentUrl.bind(this)}\n            label={label} variant=\"outlined\" value={this.state.tournamentUrl}\n            helperText={this.state.tournamentUrlError? this.state.tournamentUrlError:helperText}\n            error={this.state.tournamentUrlError?true:false} onKeyUp={this.playerNameKeyUp.bind(this)}/>\n    }\n\n    playerNameKeyUp(evt) {\n        if(evt.keyCode === 13) { // enter key pressed\n            this.setPlayerDetails()\n        }\n    }\n    getGoatDBSelection(){\n        return <NotableChessGames \n            list={this.props.notablePlayers} \n            placeholder=\"Select a player\"\n            onChange={this.notablePlayerChange.bind(this)}\n            selectedDetail={this.state.selectedPlayer}/>\n    }\n    getGoatDBEventSelection(){\n        return <NotableChessGames \n            list={this.props.notableEvents} \n            placeholder=\"Select an event\"\n            onChange={this.notableEventChange.bind(this)}\n            selectedDetail={this.state.selectedEvent}/>\n    }\n\n    getPgnFileSelection() {\n        return <div><Dropzone filesChange={this.filesChange.bind(this)} filesLimit={10}\n        dropzoneText=\"Drag and drop up to 10 pgn files here or click here to select files\"\n                />\n                {this.getPlayerNameInput('player name in PGN', 'Leave blank to load all games')}\n                </div>\n    }\n\n    getOpeningTreeSelection() {\n        return <div>\n            <Card>\n                <CardBody className=\"singlePadding\">\n                <CardTitle className=\"smallBottomMargin\"><FontAwesomeIcon icon={faInfoCircle} className=\"lowOpacity\"/> How it works</CardTitle>\n                <CardText className=\"smallText\">\n                    If you plan to revisit the same player, you can save a <b>.tree</b> file locally by loading a tree and then clicking <i>\"Save .tree file\"</i>.\n                    To reload the same tree, drop the <b>.tree</b> file in the dropzone below.\n                </CardText>\n                </CardBody>\n                </Card><br/>\n            <Dropzone filesChange={this.filesChange.bind(this)} filesLimit={1}\n                    dropzoneText=\"Drag and drop openingtree save file here or click here to select a file\"\n                />\n        </div>\n    }\n\n    getInputsToShow() {\n        if(this.props.site === Constants.SITE_PGN_FILE) {\n            return this.getPgnFileSelection()\n        } else if (this.props.site === Constants.SITE_LICHESS) {\n            return this.getLichessSelection()\n        } else if (this.props.site === Constants.SITE_CHESS_DOT_COM) {\n            return this.getChessComSelection()\n        } else if (this.props.site === Constants.SITE_EVENT_DB) {\n            return this.getGoatDBEventSelection()\n        } else if (this.props.site === Constants.SITE_PLAYER_DB) {\n            return this.getGoatDBSelection()\n        } else if(this.props.site === Constants.SITE_OPENING_TREE_FILE) {\n            return this.getOpeningTreeSelection()\n        } else if(this.props.site === Constants.SITE_ONLINE_TOURNAMENTS) {\n            return this.getOnlineTournamentSelection()\n        }\n        return <div/>\n    }\n\n    render() {\n        return <Accordion expanded={this.props.expandedPanel === 'user'}\n                TransitionComponent={Collapse}\n                TransitionProps={{timeout:Constants.LOADER_ANIMATION_DURATION_MS}}\n                onChange={this.props.handleExpansionChange} \n                disabled={this.props.site===''}>\n                <AccordionSummary expandIcon={<ExpandMoreIcon />}>{this.getSummary()}</AccordionSummary>\n                <AccordionDetails>\n                        {this.getInputsToShow()}\n                </AccordionDetails>\n                <Divider />\n                <AccordionActions>\n                    <MaterialUIButton size=\"small\" color=\"primary\" onClick={this.setPlayerDetails.bind(this)}>Continue</MaterialUIButton>\n                </AccordionActions></Accordion>\n            \n    }\n}","import { Accordion, getNumberIcon } from './Common';\nimport * as Constants from '../../app/Constants';\n\nimport React from 'react';\n\nimport {\n    AccordionActions,\n    AccordionDetails,\n    AccordionSummary,\n    Button as MaterialUIButton,\n    Collapse,\n    Divider,\n    FormControlLabel,\n    Radio,\n    RadioGroup\n} from '@material-ui/core';\n\nimport { ExpandMore } from '@material-ui/icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFlagCheckered, faChessKing, faDiceThree, faMountain, faHouseDamage } from '@fortawesome/free-solid-svg-icons';\n\nexport default class Source extends React.Component {\n\n\n    getVariantOption(variant, addNumber) {\n        return <span>\n            {addNumber?getNumberIcon('done', addNumber):null}\n            <FontAwesomeIcon icon={this.getVariantIcon(variant)} /> <span> {this.getVariantText(variant)} </span>\n        </span>\n    }\n\n    getVariantText(variant) {\n        if (variant === Constants.VARIANT_RACING_KINGS) {\n            return \"Racing kings\"\n        } else if (variant === Constants.VARIANT_THREE_CHECK) {\n            return \"Three check\"\n        } else if (variant === Constants.VARIANT_KING_OF_THE_HILL) {\n            return \"King of the hill\"\n        } else if (variant === Constants.VARIANT_CRAZYHOUSE) {\n            return \"Crazyhouse\"\n        }\n        return \"Standard rules\"\n    }\n\n    getVariantIcon(variant) {\n        if (variant === Constants.VARIANT_RACING_KINGS) {\n            return faFlagCheckered\n        } else if (variant === Constants.VARIANT_THREE_CHECK) {\n            return faDiceThree\n        } else if (variant === Constants.VARIANT_KING_OF_THE_HILL) {\n            return faMountain\n        } else if (variant === Constants.VARIANT_CRAZYHOUSE) {\n            return faHouseDamage\n        }\n        return faChessKing\n    }\n    changeLink(){\n        return this.props.expandedPanel === 'variant'?null:<span className=\"smallText\" style={{\"verticalAlign\":\"text-bottom\"}}>&nbsp;[<span className=\"linkStyle\">change</span>]</span>\n    }\n    getVariantRadio(source) {\n        return <FormControlLabel\n                className=\"sitelabel\"\n                value={source}\n                control={<Radio color=\"primary\" />}\n                label={this.getVariantOption(source)} />\n    }\n    continue(){\n        this.props.variantChange(this.props.variant)\n    }\n    setVariant(event){\n        let newVariant = event.target.value\n        this.props.variantChange(newVariant)\n    }\n\n    render() {\n        return <Accordion TransitionComponent={Collapse}\n            TransitionProps={{timeout:Constants.LOADER_ANIMATION_DURATION_MS}}\n            expanded={this.props.expandedPanel === 'variant'}\n            onChange={this.props.handleExpansionChange}>\n            <AccordionSummary\n                expandIcon={<ExpandMore />}\n                aria-controls=\"panel1c-content\"\n                id=\"panel1c-header\"\n            >\n                <div>\n                    {this.getVariantOption(this.props.variant, true)}\n                </div>\n                <div>\n                    {this.changeLink()}\n                </div>\n            </AccordionSummary>\n            <AccordionDetails>\n                <RadioGroup onChange={this.setVariant.bind(this)} value={this.props.variant}>\n                    {this.getVariantRadio(Constants.VARIANT_STANDARD)}\n                    {this.getVariantRadio(Constants.VARIANT_CRAZYHOUSE)}\n                    {this.getVariantRadio(Constants.VARIANT_THREE_CHECK)}\n                    {this.getVariantRadio(Constants.VARIANT_KING_OF_THE_HILL)}\n                    {this.getVariantRadio(Constants.VARIANT_RACING_KINGS)}\n               </RadioGroup>\n            </AccordionDetails>\n            <Divider />\n\n            <AccordionActions>\n                <MaterialUIButton size=\"small\" color=\"primary\" onClick={this.continue.bind(this)}>Continue</MaterialUIButton>\n            </AccordionActions>\n        </Accordion>\n\n    }\n}","import React from 'react'\nimport { createSubObjectWithProperties, getTimeframeSteps } from '../../app/util'\nimport * as Constants from '../../app/Constants'\nimport { trackEvent } from '../../app/Analytics'\nimport Source from './Source'\nimport User from './User'\nimport Filters from './Filters'\nimport Actions from './Actions'\nimport Variants from './Variants'\nimport request from 'request'\nimport * as SitePolicy from '../../app/SitePolicy'\nimport cookieManager from '../../app/CookieManager'\n\nexport default class PGNLoader extends React.Component {\n\n    constructor(props) {\n        super(props)\n        let selectedSite = new URLSearchParams(window.location.search).get(\"source\")\n\n        this.state = {\n            playerName: '',\n            site: selectedSite?selectedSite:'',\n            playerColor: this.props.settings.playerColor,\n            isAdvancedFiltersOpen: false,\n            isGamesSubsectionOpen: false,\n            expandedPanel: selectedSite?'user':'source',\n            notablePlayers:null,\n            notableEvents:null,\n            files:[],\n            selectedNotableEvent:{},\n            selectedNotablePlayer:{},\n            lichessLoginState: Constants.LICHESS_NOT_LOGGED_IN,\n            lichessLoginName: null\n\n        }\n        if(selectedSite === Constants.SITE_LICHESS) {\n            this.fetchLichessLoginStatus()\n        }\n        this.timeframeSteps = getTimeframeSteps()\n        this.state[Constants.FILTER_NAME_SELECTED_TIMEFRAME] = [0, this.timeframeSteps.length - 1]\n        this.state[Constants.FILTER_NAME_DOWNLOAD_LIMIT] = Constants.MAX_DOWNLOAD_LIMIT\n        this.state[Constants.TIME_CONTROL_ULTRA_BULLET] = true\n        this.state[Constants.TIME_CONTROL_BULLET] = true\n        this.state[Constants.TIME_CONTROL_BLITZ] = true\n        this.state[Constants.TIME_CONTROL_RAPID] = true\n        this.state[Constants.TIME_CONTROL_CLASSICAL] = true\n        this.state[Constants.TIME_CONTROL_CORRESPONDENCE] = true\n        this.state[Constants.TIME_CONTROL_DAILY] = true\n        this.state[Constants.FILTER_NAME_RATED] = \"all\"\n        this.state[Constants.FILTER_NAME_ELO_RANGE] = [0, Constants.MAX_ELO_RATING]\n    }\n\n\n    advancedFilters() {\n        return createSubObjectWithProperties(this.state,\n            [Constants.TIME_CONTROL_ULTRA_BULLET, Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_BLITZ, Constants.TIME_CONTROL_RAPID,\n            Constants.TIME_CONTROL_CORRESPONDENCE, Constants.TIME_CONTROL_DAILY,\n            Constants.TIME_CONTROL_CLASSICAL, Constants.FILTER_NAME_RATED,\n            Constants.FILTER_NAME_SELECTED_TIMEFRAME, Constants.FILTER_NAME_DOWNLOAD_LIMIT,\n            Constants.FILTER_NAME_ELO_RANGE])\n    }\n\n\n    handleExpansionChange(panel) {\n        return (event, newExpanded) => {\n            this.setState({ expandedPanel: newExpanded ? panel : false });\n        };\n    }\n\n    exportOpeningTreeObject(){\n        return {\n            header:{\n                version:2,// current openingtree file version. used to check compatibility of files\n                timestamp:Math.floor(Date.now() / 1000),\n                gamesProcessed:this.props.gamesProcessed,\n                settings:this.props.settings,\n                playerName:this.state.playername,\n                site: this.state.site,\n                advancedFilters:this.advancedFilters(),\n                variant:this.props.variant\n            },\n            arrays: [[...this.props.openingGraph.graph.nodes.entries()],\n                        [...this.props.openingGraph.graph.pgnStats]]\n        }\n    }\n\n    importOpeningTreeObject(openingTreeSave) {\n        let saveVersion = 1;\n        if(openingTreeSave.header.version) {\n            saveVersion = openingTreeSave.header.version\n        }\n        if(saveVersion < Constants.OPENING_TREE_FILE_CURRENT_VERSION) {\n            this.props.showError(\"This is an old format of openingtree file.\", null, \n                \"You can try loading it by visiting the old website\", Constants.ERROR_ACTION_VISIT_OLD_SITE)\n            return false\n        }\n        this.setState({\n            ...openingTreeSave.header.advancedFilters,\n            playerColor:openingTreeSave.header.settings.playerColor,\n            site:openingTreeSave.header.site,\n            playerName:openingTreeSave.header.settings.playerName,\n        })\n        this.props.openingGraph.setEntries(openingTreeSave.arrays[0], openingTreeSave.arrays[1])\n        this.props.importCallback({\n            settings:openingTreeSave.header.settings,\n            gamesProcessed:openingTreeSave.header.gamesProcessed,\n            openingGraph:this.props.openingGraph,\n            variant:openingTreeSave.header.variant\n        })\n        return true\n    }\n\n    playerDetailsChange(playerName, files, selectedNotableEvent, selectedNotablePlayer, selectedOnlineTournament) {\n        this.setState({\n            playerName: playerName,\n            expandedPanel:SitePolicy.isFilterPanelEnabled(this.state.site, playerName, selectedNotablePlayer)?'filters':'',\n            files:files,\n            selectedNotableEvent:selectedNotableEvent,\n            selectedNotablePlayer:selectedNotablePlayer,\n            playerColor:'',\n            selectedOnlineTournament:selectedOnlineTournament\n        })\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"PlayerNameSaved\")\n    }\n    fetchGOATGames(url, callback){\n        request.get(url, (error, response) =>{\n            if(error) {\n                this.props.showError(\"Could not fetch player list. Failed to connect to DB.\")\n                callback([])\n                return \n            }\n            let gamesDetails\n            try{\n                gamesDetails = JSON.parse(response.body).list\n            } catch (e) {\n                console.log(e)\n            }\n            if(!gamesDetails) {\n                this.props.showError(\"Failed to load games.\")\n                callback([])\n            } else {\n                callback(gamesDetails)\n            }\n        })\n    }\n\n\n\n    siteChange(newSite) {\n        if(newSite === Constants.SITE_PLAYER_DB && !this.state.notablePlayers) {\n            this.fetchGOATGames('https://goatchess.github.io/list.json', (gamesDetails)=>{\n                this.setState({notablePlayers:gamesDetails})\n            })\n        }\n        if(newSite === Constants.SITE_EVENT_DB && !this.state.notableEvents) {\n            this.fetchGOATGames('https://goatevents.github.io/list.json', (gamesDetails)=>{\n                this.setState({notableEvents:gamesDetails})\n            })\n        }\n        if(newSite === Constants.SITE_LICHESS) {\n            this.fetchLichessLoginStatus()\n        }\n\n        this.setState({ site: newSite, expandedPanel:'user'})\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"ChangeSite\", newSite)\n    }\n    fetchLichessLoginStatus(){\n        let lichessAccessToken = cookieManager.getLichessAccessToken()\n        if(lichessAccessToken) {\n            trackEvent(Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessTokenFound\")\n\n            this.setState({lichessLoginState:Constants.LICHESS_STATE_PENDING})\n            \n            request.get(\"https://lichess.org/api/account\", {timeout:5000, auth:{bearer:cookieManager.getLichessAccessToken()}}, (error, response)=>{\n                if(!error && response) {\n                    let responseObj = JSON.parse(response.body) \n                    if(responseObj && responseObj.username) {\n                        this.setState({\n                            lichessLoginState:Constants.LICHESS_LOGGED_IN,\n                            lichessLoginName:responseObj.username\n                        })\n                        trackEvent(Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessFetchSuccess\")\n                        return\n                    } \n                } \n                trackEvent(Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessFetchFailed\")\n                this.setState({lichessLoginState:Constants.LICHESS_FAILED_FETCH})\n            })\n        } else {\n            trackEvent(Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessNoToken\")\n        }\n    }\n    logoutOfLichess() {\n        cookieManager.deleteLichessAccessToken()\n        this.setState({\n            lichessLoginState:Constants.LICHESS_NOT_LOGGED_IN,\n            lichessLoginName:''\n        })\n        trackEvent(Constants.EVENT_CATEGORY_LICHESS_LOGIN, \"lichessLogout\")\n    }\n\n    filtersChange(filters) {\n        this.setState({...filters, expandedPanel:''})\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"FitlersSaved\", this.state.site)\n    }\n    variantChange(newVariant) {\n        this.setState({expandedPanel:'source'})\n        this.props.variantChange(newVariant)\n        trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"VariantChange\", newVariant)\n    }\n\n    render() {\n        return <div><div className=\"pgnloadersection\">\n            <Variants expandedPanel={this.state.expandedPanel}\n                handleExpansionChange={this.handleExpansionChange('variant').bind(this)}\n                variantChange={this.variantChange.bind(this)} variant={this.props.variant}/>\n            <Source expandedPanel={this.state.expandedPanel}\n                handleExpansionChange={this.handleExpansionChange('source').bind(this)}\n                site={this.state.site} siteChange={this.siteChange.bind(this)}\n                variant={this.props.variant}/>\n            <User expandedPanel={this.state.expandedPanel} playerName={this.state.playerName}\n                handleExpansionChange={this.handleExpansionChange('user').bind(this)} \n                showError={this.props.showError} files={this.state.files} notablePlayers={this.state.notablePlayers}\n                notableEvents={this.state.notableEvents} site={this.state.site} playerDetailsChange={this.playerDetailsChange.bind(this)}\n                pgnUrl={this.state.pgnUrl} selectedPlayer={this.state.selectedNotablePlayer} selectedEvent={this.state.selectedNotableEvent}\n                lichessLoginState={this.state.lichessLoginState} lichessLoginName={this.state.lichessLoginName}\n                logoutOfLichess={this.logoutOfLichess.bind(this)} refreshLichessStatus={this.fetchLichessLoginStatus.bind(this)}\n                selectedOnlineTournament={this.state.selectedOnlineTournament}\n            />\n            <Filters expandedPanel={this.state.expandedPanel} playerColor={this.state.playerColor}\n                handleExpansionChange={this.handleExpansionChange('filters').bind(this)}\n                site={this.state.site} playerName={this.state.playerName} advancedFilters={this.advancedFilters()}\n                timeframeSteps={this.timeframeSteps} filtersChange={this.filtersChange.bind(this)}\n                selectedNotablePlayer={this.state.selectedNotablePlayer} />\n            </div>\n            <Actions expandedPanel={this.state.expandedPanel} playerColor={this.state.playerColor} files={this.state.files}\n                playerName={this.state.playerName} site={this.state.site} advancedFilters={this.advancedFilters()}\n                notify={this.props.notify} showError={this.props.showError} onChange={this.props.onChange}\n                setDownloading={this.props.setDownloading} clear={this.props.clear} isDownloading={this.props.isDownloading}\n                switchToMovesTab={this.props.switchToMovesTab} gamesProcessed={this.props.gamesProcessed} \n                selectedNotablePlayer={this.state.selectedNotablePlayer} selectedNotableEvent={this.state.selectedNotableEvent}\n                exportOpeningTreeObject={this.exportOpeningTreeObject.bind(this)} showInfo={this.props.showInfo}\n                importOpeningTreeObject={this.importOpeningTreeObject.bind(this)} selectedOnlineTournament={this.state.selectedOnlineTournament}\n                variant={this.props.variant}/>\n        </div>\n    }\n\n}","import React from 'react';\nimport { Button, Col, Container, Row } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faDesktop, faFastBackward, faMoon, faLightbulb, faRetweet, faTrashAlt } from '@fortawesome/free-solid-svg-icons';\n\nimport { trackEvent } from '../app/Analytics';\nimport * as Constants from '../app/Constants';\n\nexport default class SettingsView extends React.Component {\n    constructor(props){\n        super(props)\n        window.addEventListener(\"keydown\",this.keyHandler.bind(this))\n    }\n\n    keyHandler(e){\n        if (e.srcElement && e.srcElement.tagName === 'INPUT') {\n            return;\n        }\n\n        switch(e.keyCode) {\n            case 70: // F key\n                this.toggle(Constants.SETTING_NAME_ORIENTATION)();\n                break;\n            default:\n                break;\n        }\n    }\n\n    toggle(eventName) {\n        return (() => {\n            let newValue;\n            switch (eventName) {\n                case Constants.SETTING_NAME_ORIENTATION:\n                    newValue = this.props.settings[eventName] === Constants.PLAYER_COLOR_WHITE\n                        ? Constants.PLAYER_COLOR_BLACK\n                        : Constants.PLAYER_COLOR_WHITE;\n                    trackEvent(Constants.EVENT_CATEGORY_CONTROLS, \"ChangeOrientation\")\n                    break;\n                case Constants.SETTING_NAME_DARK_MODE:\n                    newValue = !this.props.settings[eventName];\n                    trackEvent(Constants.EVENT_CATEGORY_CONTROLS, \"DarkMode\");\n                    break;\n                default:\n                    break;\n            }\n            this.props.onChange(eventName, newValue);\n        })\n    }\n\n    analyse() {\n        window.open(`https://www.lichess.org/analysis/standard/${this.props.fen}`, '_blank');\n        trackEvent(Constants.EVENT_CATEGORY_CONTROLS, \"AnalyzeGame\")\n    }\n\n    resetAction() {\n        this.props.reset()\n        trackEvent(Constants.EVENT_CATEGORY_CONTROLS, \"Reset\")\n    }\n\n    clearAction() {\n        this.props.clear()\n        trackEvent(Constants.EVENT_CATEGORY_CONTROLS, \"Clear\")\n    }\n\n    render() {\n        return <div>\n            <Container>\n                <Row sm=\"12\">\n                    <Col sm=\"6\">\n                        <Button className=\"settingButton\" onClick = {this.toggle(Constants.SETTING_NAME_ORIENTATION)} color=\"\">\n                            <h3>\n                                <FontAwesomeIcon icon={faRetweet} />\n                            </h3>\n                            <span>\n                                Flip board\n                            </span>\n                        </Button>\n                    </Col>\n                    <Col sm=\"6\">\n                        <Button className=\"settingButton\" onClick = {this.clearAction.bind(this)} color=\"\">\n                            <h3>\n                                <FontAwesomeIcon icon={faTrashAlt} />\n                            </h3>\n                            <span>\n                                Clear games\n                            </span>\n                        </Button>\n                    </Col>\n                    <Col sm=\"6\">\n                        <Button className=\"settingButton\" onClick = {this.resetAction.bind(this)} color=\"\">\n                            <h3>\n                                <FontAwesomeIcon icon={faFastBackward} />\n                            </h3>\n                            <span>\n                                Starting position\n                            </span>\n                        </Button>\n                    </Col>\n                    <Col sm=\"6\">\n                        <Button className=\"settingButton\" onClick = {this.analyse.bind(this)} color=\"\">\n                            <h3>\n                                <FontAwesomeIcon icon={faDesktop} />\n                            </h3>\n                            <span>\n                                Computer analysis\n                            </span>\n                        </Button>\n                    </Col>\n                    <Col sm=\"6\">\n                        <Button className=\"settingButton\" onClick={this.toggle(Constants.SETTING_NAME_DARK_MODE)} color=\"\">\n                            <h3>\n                                <FontAwesomeIcon icon={this.props.settings.darkMode?faLightbulb:faMoon} />\n                            </h3>\n                            <span>\n                                {this.props.settings.darkMode?\"Light mode\":\"Dark mode\"}\n                            </span>\n                        </Button>\n                    </Col>\n                </Row>\n            </Container>\n        </div>\n    }\n}","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faExternalLinkAlt, faUser } from '@fortawesome/free-solid-svg-icons'\nimport { Table, TableRow, TableHead, TableBody, TableCell, TableFooter, TextField } from '@material-ui/core';\nimport React from 'react'\nimport {getPerformanceDetails} from '../app/util'\nimport {copyText} from './loader/Common'\n\nexport default class ReportControls extends React.Component {\n    eatClicks(e) {\n        e.stopPropagation()\n    }\n\n    copyFen() {\n        copyText(\"fenField\")/* Get the text field */\n        /* Alert the copied text */\n        this.props.showInfo(\"FEN copied\");\n    }\n\n    getFenField() {\n        return this.props.simplifiedView?null:\n            <div className=\"fenDiv\">\n            <TextField\n                id=\"fenField\"\n                multiline\n                label=\"FEN\"\n                rowsMax=\"2\"\n                value={this.props.fen}\n                inputProps={{\n                    style: {fontSize: 12},\n                    spellCheck: false,\n                  }}\n                  variant=\"outlined\"\n                className=\"fenField\"\n                margin=\"dense\"\n                onClick = {this.copyFen.bind(this)}\n                /></div>\n    }\n\n\n    render() {\n        let moveDetails = this.props.moveDetails\n        if(!moveDetails.hasData) {\n            return <div>{this.getFenField()}<div className = \"infoMessage\" >No data to show. Please enter a lichess or chess.com user name in the\n                <span className = \"navLinkButton\" onClick={()=>this.props.switchToUserTab()}> <FontAwesomeIcon icon={faUser} /> User</span> tab and click \"Load\"</div>\n                </div>\n        }\n        let performanceDetails = {}\n        if(this.props.isOpen) {\n            performanceDetails = getPerformanceDetails(moveDetails.totalOpponentElo,\n                                                        moveDetails.averageElo,\n                                                        moveDetails.whiteWins,\n                                                        moveDetails.draws,\n                                                        moveDetails.blackWins,\n                                                        this.props.settings.playerColor)\n        }\n\n        return <div className=\"performanceOverlay\">\n            {this.getFenField()}\n            <Table onClick={this.eatClicks}>\n            {!performanceDetails.performanceRating || (isNaN(performanceDetails.performanceRating) || !this.props.settings.playerName)?\n            null:\n            <TableHead className={`performanceRatingRow${this.props.simplifiedView?\" performanceHeader\":\"\"}`}>\n                <TableRow>\n                <TableCell className=\"performanceRatingRow\"><b>Performance</b></TableCell>\n                <TableCell className=\"performanceRatingRow\"><b>{performanceDetails.performanceRating}</b></TableCell>\n                </TableRow>\n            </TableHead>}\n            <TableBody>\n            <TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Results</TableCell>\n                <TableCell className=\"performanceRatingRow\">{performanceDetails.results}</TableCell>\n            </TableRow>\n            {(isNaN(performanceDetails.averageOpponentElo) || performanceDetails.averageOpponentElo <= 0 || !this.props.settings.playerName)?null:\n            <TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Avg opponent</TableCell>\n                <TableCell className=\"performanceRatingRow\">{performanceDetails.averageOpponentElo}</TableCell>\n            </TableRow>}\n            {(isNaN(performanceDetails.averageElo))?null:\n            <TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Avg Elo</TableCell>\n                <TableCell className=\"performanceRatingRow\">{performanceDetails.averageElo}</TableCell>\n            </TableRow>}\n            <TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Score</TableCell>\n                <TableCell className=\"performanceRatingRow\">{performanceDetails.score}</TableCell>\n            </TableRow>\n            {((this.props.simplifiedView || isNaN(performanceDetails.averageElo)) || !this.props.settings.playerName)?null:\n            <TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Rating change</TableCell>\n                <TableCell className=\"performanceRatingRow\">{performanceDetails.ratingChange}</TableCell>\n            </TableRow>\n            }\n            {(this.props.settings.playerName && !this.props.simplifiedView && moveDetails.bestWinElo)?<TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Best win</TableCell>\n                <TableCell className=\"performanceRatingRow\">{moveDetails.bestWinElo} <FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(moveDetails.bestWinGame)} icon={faExternalLinkAlt}/></TableCell>\n            </TableRow>:null}\n            {(this.props.settings.playerName && !this.props.simplifiedView && moveDetails.worstLossElo)?<TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Worst loss</TableCell>\n                <TableCell className=\"performanceRatingRow\">{moveDetails.worstLossElo} <FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(moveDetails.worstLossGame)} icon={faExternalLinkAlt}/></TableCell>\n            </TableRow>:null}\n            {(!this.props.simplifiedView && moveDetails.longestGameInfo)?<TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Longest game</TableCell>\n                <TableCell className=\"performanceRatingRow\">{moveDetails.longestGameInfo.numberOfPlys} Plys <FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(moveDetails.longestGameInfo)} icon={faExternalLinkAlt}/></TableCell>\n            </TableRow>:null}\n            {(!this.props.simplifiedView && moveDetails.shortestGameInfo)?<TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Shortest game</TableCell>\n                <TableCell className=\"performanceRatingRow\">{moveDetails.shortestGameInfo.numberOfPlys} Plys <FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(moveDetails.shortestGameInfo)} icon={faExternalLinkAlt}/></TableCell>\n            </TableRow>:null}\n\n            {moveDetails.lastPlayedGame?<TableRow className=\"performanceRatingRow\">\n                <TableCell className=\"performanceRatingRow\">Last played</TableCell>\n                <TableCell className=\"performanceRatingRow\">{this.removeQuestionMarksFromDate(moveDetails.lastPlayedGame.date)} <FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(moveDetails.lastPlayedGame)} icon={faExternalLinkAlt}/></TableCell>\n            </TableRow>:null}\n            </TableBody>\n            {!this.props.reportFooter?null:\n            <TableFooter>\n                <TableRow>\n                    <TableCell colSpan=\"2\">{this.props.reportFooter}</TableCell>\n                </TableRow>\n            </TableFooter>\n            }\n        </Table></div>\n    }\n\n    removeQuestionMarksFromDate(date) {\n        if(!date || date.indexOf('?') === -1) {\n            return date\n        }\n        return date.slice(0, date.indexOf('.'))\n    }\n}","export function playerDetails(name, elo) {\n    return `${name}${elo?`(${elo})`:''}`\n}\n","import React from 'react'\nimport {\n    Modal,\n    ModalHeader,\n    ModalBody,\n    ModalFooter,\n    Button\n} from 'reactstrap'\nimport Switch from '@material-ui/core/Switch';\nimport {\n    FormControlLabel\n} from '@material-ui/core'\nimport {\n    ToggleButtonGroup,\n    ToggleButton\n} from '@material-ui/lab'\nimport * as Constants from '../../app/Constants'\nimport { Collapse, CardBody, Card, CardText } from 'reactstrap';\nimport Link from '@material-ui/core/Link'\nimport {trackEvent} from '../../app/Analytics'\n\nexport default class MovesSettings extends React.Component {\n    constructor(props) {\n        super(props)\n        let mSettings = Object.assign({},this.props.settings.movesSettings)\n        mSettings.openingBookType = this.getTransformedBookType(mSettings.openingBookType)\n        this.state={\n            movesSettings: mSettings,\n            indicatorInfoOpen:false\n        }\n    }\n\n    updateMoveSetting(key) {\n        return (e, value) => {\n            if(Array.isArray(value) && value.length <1) {\n                return\n            }\n            let newMovesSettings = Object.assign({},this.state.movesSettings)\n            newMovesSettings[key] = value\n            this.setState({\n                movesSettings:newMovesSettings\n            })\n        }\n    }\n\n    cancel() {\n        //reset to original settings\n        this.setState({movesSettings: this.props.settings.movesSettings})\n        this.props.toggle()\n        trackEvent(Constants.EVENT_CATEGORY_SETTINGS, \"MoveSettingsCancel\")\n    }\n\n    set() {\n        //reset to  new settings\n        this.props.settingsChange(Constants.SETTING_NAME_MOVES_SETTINGS, this.state.movesSettings)\n        this.props.toggle()\n        trackEvent(Constants.EVENT_CATEGORY_SETTINGS, \"MoveSettingsSet\")\n    }\n\n    toggleIndicatorInfo(e) {\n        this.setState({indicatorInfoOpen:!this.state.indicatorInfoOpen})\n        if(!this.state.indicatorInfoOpen) {\n            trackEvent(Constants.EVENT_CATEGORY_SETTINGS, \"MoveSettingsIndicatorInfo\")\n        }\n    }\n\n    render() {\n        return <Modal isOpen={this.props.isOpen} toggle={this.cancel.bind(this)}>\n            <ModalHeader toggle={this.cancel.bind(this)}>Opening book settings</ModalHeader>\n            <ModalBody>\n                <div className=\"littlePaddingTop\">{this.getOpeningBookType()}</div>\n                {this.state.movesSettings.openingBookType === Constants.OPENING_BOOK_TYPE_LICHESS?\n                <div className=\"littlePaddingTop\">{this.getOpeningBookRating()}</div>\n                :null}   \n                {this.state.movesSettings.openingBookType === Constants.OPENING_BOOK_TYPE_LICHESS?\n                <div className=\"littlePaddingTop\">{this.getOpeningBookTimeControls()}</div>\n                :null}   \n                <div className=\"littlePaddingTop\">{this.getIndicatorSwitch(\"openingBookWinsIndicator\", <span>Book indicators <Link href=\"#\" className=\"smallText\" onClick={this.toggleIndicatorInfo.bind(this)}>whats this?</Link></span>)}</div>\n                <Collapse isOpen={this.state.indicatorInfoOpen}>\n                <Card>\n                    <CardBody className=\"singlePadding\">\n                    <img src=\"./images/bookIndicator.png\" alt=\"bookIndicator\"/>\n                    <CardText className=\"smallText\">\n                        Little triangles indicate the openingbook statistics on the moves tab and the player \n                        statistics on the openingbook tab. <br/>Everything left of the white triangle is a win for white, \n                        everything right of the black triangle is a win for black and everything in the middle is a draw.<br/>\n                        If there is only a black triangle and no white, it means there are no draws.</CardText>\n                    </CardBody>\n                    </Card>\n                </Collapse>\n            </ModalBody>\n            <ModalFooter>\n            <Button color=\"link\" onClick={this.cancel.bind(this)}>Cancel</Button>\n            <Button color=\"primary\" onClick={this.set.bind(this)}>Set</Button>\n\n            </ModalFooter>\n        </Modal>\n    }\n\n    getIndicatorSwitch(name, label) {\n        return <div><FormControlLabel\n            control={\n                <Switch\n                    checked={this.state.movesSettings[name]}\n                    name={name}\n                    color=\"primary\"\n                />\n            }\n            onChange={this.updateMoveSetting(name)}\n            label={label}\n      /></div>\n    }\n\n    mastersBookAvailable() {\n        // masters book is only available for standard mode\n        return this.props.variant === Constants.VARIANT_STANDARD\n    }\n\n    getTransformedBookType(value){\n        //if masters book is not available, use lichess book\n        if(value === Constants.OPENING_BOOK_TYPE_MASTERS\n            && !this.mastersBookAvailable()) {\n            return Constants.OPENING_BOOK_TYPE_LICHESS\n        }\n        return value\n    }\n\n    getOpeningBookType() {\n        return <div>Book type<br/><ToggleButtonGroup size=\"small\" exclusive={true} value={this.getTransformedBookType(this.state.movesSettings.openingBookType)} onChange={this.updateMoveSetting('openingBookType')} aria-label=\"book type\">\n            <ToggleButton value={Constants.OPENING_BOOK_TYPE_OFF} aria-label={Constants.OPENING_BOOK_TYPE_OFF}>\n                Off\n            </ToggleButton> {\n                this.mastersBookAvailable()?\n                <ToggleButton value={Constants.OPENING_BOOK_TYPE_MASTERS} aria-label={Constants.OPENING_BOOK_TYPE_MASTERS}>\n                    Masters\n                </ToggleButton>\n                :null\n            }\n            <ToggleButton value={Constants.OPENING_BOOK_TYPE_LICHESS} aria-label={Constants.OPENING_BOOK_TYPE_LICHESS}>\n                Lichess\n            </ToggleButton>\n        </ToggleButtonGroup></div>\n    }\n    getOpeningBookRating() {\n        return <div>Rating<br/><ToggleButtonGroup size=\"small\" value={this.state.movesSettings.openingBookRating} onChange={this.updateMoveSetting('openingBookRating')} aria-label=\"text formatting\">\n            <ToggleButton value=\"1600\" aria-label=\"1600\">\n                1600\n            </ToggleButton>\n            <ToggleButton value=\"1800\" aria-label=\"1800\">\n                1800\n            </ToggleButton>\n            <ToggleButton value=\"2000\" aria-label=\"2000\">\n                2000\n            </ToggleButton>\n            <ToggleButton value=\"2200\" aria-label=\"2200\">\n                2200\n            </ToggleButton>\n            <ToggleButton value=\"2500\" aria-label=\"2500\">\n                2500\n            </ToggleButton>\n        </ToggleButtonGroup></div>\n    }\n\n    getOpeningBookTimeControls() {\n        return <div>Time controls<br/><ToggleButtonGroup size=\"small\" value={this.state.movesSettings.openingBookTimeControls} onChange={this.updateMoveSetting('openingBookTimeControls')} aria-label=\"text formatting\">\n            <ToggleButton value=\"bullet\" aria-label=\"bullet\">\n            Bullet\n            </ToggleButton>\n            <ToggleButton value=\"blitz\" aria-label=\"blitz\">\n            Blitz\n            </ToggleButton>\n            <ToggleButton value=\"rapid\" aria-label=\"rapid\">\n            Rapid\n            </ToggleButton>\n            <ToggleButton value=\"classical\" aria-label=\"classical\">\n            Classical\n            </ToggleButton>\n        </ToggleButtonGroup></div>\n    }\n\n}\n","import React from 'react'\nimport {Progress, Popover } from \"reactstrap\"\nimport { Table, TableRow, TableHead, TableBody, TableCell, TableFooter } from '@material-ui/core';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faExternalLinkAlt, faInfoCircle, faExclamationTriangle, faWrench } from '@fortawesome/free-solid-svg-icons'\nimport ReportControls from '../ReportControls'\nimport {Container, Row, Col} from 'reactstrap'\nimport \"react-step-progress-bar/styles.css\";\nimport {trackEvent} from '../../app/Analytics'\nimport * as Constants from '../../app/Constants'\nimport { ProgressBar,Step } from \"react-step-progress-bar\";\nimport {playerDetails} from './MovesCommon'\nimport {simplifyCount} from '../../app/util'\nimport MovesSettings from './MovesSettings'\n\nexport default class MovesTable extends React.Component {\n    constructor(props){\n        super(props)\n        this.state = {\n            openPerformanceIndex: null,\n            moveSettingsOpen:false\n        }\n    }\n    isTouchDevice() {\n        return 'ontouchstart' in window;\n    }\n      \n      \n\n    componentDidUpdate(prevProps, prevState) {\n        if(prevProps.turnColor !== this.props.turnColor) {\n            this.setState({\n                openPerformanceIndex: null,\n            })\n        }\n    }\n\n    move(san) {\n        return () => {\n            this.props.onMove(san)\n            trackEvent(Constants.EVENT_CATEGORY_MOVES_LIST, this.props.clickedEventName)\n        }\n    }\n\n    toggleMovesSettings(){\n        if(!this.state.moveSettingsOpen) {\n            trackEvent(Constants.EVENT_CATEGORY_SETTINGS, \"MoveSettingsOpen\")\n        }\n        this.setState({moveSettingsOpen:!this.state.moveSettingsOpen})\n    }\n\n    togglePerformancePopover(moveIndex) {\n        return (e) => {\n            if(this.state.openPerformanceIndex !== null) {\n                this.setState({openPerformanceIndex:null})\n            } else {\n                this.setState({openPerformanceIndex: moveIndex})\n            }\n            e.stopPropagation()\n        }\n    }\n    \n    compareClicked(san){\n        return (e)=>{\n            e.stopPropagation()\n            this.props.compareToClicked(san)\n        }\n    }\n\n    compareScores(currMove) {\n        let compareTo = currMove.compareTo\n        if(!compareTo) {\n            return null\n        }\n        let values = [compareTo.bookScore, compareTo.userScore]\n        return (\n            <ProgressBar\n              percent={0}\n              stepPositions={values}\n            >\n                {this.getIndicator(\"./images/book.png\", \"12\", \"12\", \n                    this.constructAlt(this.props.compareToAlt,values),\n                    this.compareClicked(currMove.san))}\n                {this.getIndicator(\"./images/user.png\", \"12\", \"12\", \n                    this.constructAlt(this.props.compareToAlt,values),\n                    this.compareClicked(currMove.san))}\n            </ProgressBar>\n          )\n    }\n\n    compareProgress(currMove){\n        let compareTo = currMove.compareTo\n        if(!compareTo) {\n            return null\n        }\n        return (\n            <ProgressBar\n              percent={0}\n              stepPositions={compareTo.values}\n            >\n                {this.getIndicator(\"./images/arrow-white.png\", \"20\", \"16\", \n                    this.constructAlt(this.props.compareToAlt,compareTo.values),\n                    this.compareClicked(currMove.san))}\n                {this.getIndicator(\"./images/arrow-black.png\", \"18\", \"14\", \n                    this.constructAlt(this.props.compareToAlt,compareTo.values),\n                    this.compareClicked(currMove.san))}\n            </ProgressBar>\n          )\n    }\n    constructAlt(altTitle, steps) {\n        let white = Math.round(steps[0])\n        let draws = Math.round(steps[1])-white\n        let black = 100-white-draws\n        return `${altTitle} \\nWhite wins ${white}% \\nDraws ${draws}% \\nBlack wins ${black}%`\n    }\n    //&#013;\n\n    getIndicator(src, height, width, alt, click) {\n        return <Step transition=\"scale\">\n            {({ accomplished }) => (\n            <img onClick = {click}\n                alt={alt}\n                title={alt}\n                className=\"pointerExternalLink\"\n                width={width}\n                height={height}\n                src={src}\n            />\n            )}\n          </Step>\n    }\n\n    getPopover(moveIndex) {\n        let performancePopoverOpen = this.state.openPerformanceIndex === moveIndex\n        let openMove = this.props.movesToShow[moveIndex]\n\n        return <Popover trigger=\"hover\" placement=\"right\" isOpen={performancePopoverOpen} target={`p${this.props.namespace}${moveIndex}`} toggle={this.togglePerformancePopover(moveIndex)}>\n                <ReportControls moveDetails={openMove.details} simplifiedView={true} \n                isOpen = {performancePopoverOpen} launchGame={this.props.launchGame} \n                settings={this.props.settings} reportFooter ={this.reportFooter(moveIndex)}/>\n            </Popover>\n    }\n\n    reportFooter(moveIndex) {\n        let currMove = this.props.movesToShow[moveIndex]\n\n        if(this.getTranspositionWarningLevel(moveIndex)!=='none') {\n            return <div>{this.getInfoIcon(moveIndex)}<b> This move has transpositions</b> <div>{currMove.san} has been played only {currMove.moveCount} times but the resulting position has appeared {currMove.details.count} times through other move orders.</div></div>\n        }\n    }\n\n    getTranspositionWarningLevel(moveIndex){\n        let currMove = this.props.movesToShow[moveIndex]\n        let targetCount = currMove.details.count\n        let difference = targetCount - currMove.moveCount\n        if (difference>0) {\n            if(difference>10 && difference/targetCount>0.1) {\n                return \"warning\"\n            } else {\n                return \"info\"\n            }\n        }\n        return \"none\"\n    }\n\n    render() {\n        let hasMoves = (this.props.movesToShow && this.props.movesToShow.length>0)\n        return <Table>\n            {hasMoves?\n        <TableHead>\n        <TableRow>\n            <TableCell size=\"small\" className=\"smallCol\"><b>Move</b></TableCell>\n            <TableCell size=\"small\" className=\"smallCol\"><b>Games</b></TableCell>\n            <TableCell><b>Results</b><FontAwesomeIcon \n                className={`floatRight pointer`} \n                icon={faWrench} onClick={this.toggleMovesSettings.bind(this)}/>\n                <MovesSettings isOpen={this.state.moveSettingsOpen} \n                    toggle={this.toggleMovesSettings.bind(this)}\n                    settingsChange={this.props.settingsChange}\n                    updateSettings = {this.props.updateSettings}\n                    settings={this.props.settings}\n                    variant={this.props.variant}/>\n            </TableCell>\n        </TableRow></TableHead>\n        :null}\n        {hasMoves?\n        <TableBody>\n        {\n        this.props.movesToShow.map((move, moveIndex) => {\n            let lastPlayedGame = move.details.lastPlayedGame\n            return lastPlayedGame && move.moveCount === 1?\n                this.getSingleItemRow(move,lastPlayedGame):\n                this.getMultiItemRow(move, moveIndex)\n                \n            }\n        )}\n    </TableBody>\n    :null}\n        <TableFooter><TableRow>\n            <TableCell colSpan=\"3\">\n                {this.props.tableFooter}\n            </TableCell>\n        </TableRow></TableFooter>\n    </Table>\n    }\n    highlightArrowFn(move) {\n        if(this.isTouchDevice()) {\n            // do not highlight on touch screens because it gives weird behavior\n            // single touch just highlights the arrow and user will need to double touch to make the move\n            return ()=>{return}\n        }\n        return ()=>{\n            this.props.highlightArrow(move)\n        }\n    }\n    getMultiItemRow(move, moveIndex) {\n        return <TableRow className={`${this.props.highlightMove === move.san?'bgColor ':''}moveRow`} \n                        key = {`m${move.orig}${move.dest}${move.san}`} \n                        onClick={this.move(move.san)} \n                        onMouseOver={this.highlightArrowFn(move).bind(this)} \n                        onMouseOut={()=>this.props.highlightArrow(null)}>\n            <TableCell size=\"small\" className=\"smallCol\">{move.san} </TableCell>\n            <TableCell size=\"small\" id={`p${this.props.namespace}${moveIndex}`} className=\"smallCol\" onClick ={this.togglePerformancePopover(moveIndex)}>\n                {simplifyCount(move.moveCount)}{this.getInfoIcon(moveIndex)}\n                {this.getPopover(moveIndex)}\n            </TableCell>\n            <TableCell>\n                <Container>\n                {this.props.settings.movesSettings.openingBookScoreIndicator?\n                <Row className=\"scoresProgress\"><Col className=\"navCol\">\n                {this.compareScores(move)}\n                </Col></Row>:null}\n                <Row><Col className=\"navCol\">\n                <Progress className = \"border\" multi>\n                    <Progress bar className=\"whiteMove\" value={`${this.percentage(move.details.whiteWins,move.details.count)}`}>{this.getProgressLabel(move.details.whiteWins,move.details.count)}</Progress>\n                    <Progress bar className=\"grayMove\" value={`${this.percentage(move.details.draws,move.details.count)}`}>{this.getProgressLabel(move.details.draws,move.details.count)}</Progress>\n                    <Progress bar className=\"blackMove\" value={`${this.percentage(move.details.blackWins,move.details.count)}`}>{this.getProgressLabel(move.details.blackWins,move.details.count)}</Progress>\n                </Progress></Col></Row>\n                {this.props.settings.movesSettings.openingBookWinsIndicator?\n                <Row className=\"zeroHeight\"><Col className=\"navCol\">\n                {this.compareProgress(move)}\n                </Col></Row>:null}\n                </Container>\n            </TableCell>\n        </TableRow>\n    }\n\n    getInfoIcon(moveIndex) {\n        if(this.getTranspositionWarningLevel(moveIndex) === \"warning\"){\n            return <FontAwesomeIcon \n                className={`leftPadding redColor lowOpacity`} \n                icon={faExclamationTriangle}/>\n        }\n        return <FontAwesomeIcon \n            className={`lowOpacity leftPadding`} \n            icon={faInfoCircle}/>\n\n    }\n\n    getProgressLabel(count, total){\n        let percentage = this.percentage(count,total)\n        if(percentage<10) {\n            return ''\n        }\n        if(this.props.showAsPercentage) {\n            return `${percentage.toFixed(1)}%`\n        }\n        return count\n\n    }\n\n    percentage(count, total){\n        return count/total*100\n    }\n    getSingleItemRow(move,lastPlayedGame) {\n        let sampleResultWhite = playerDetails(lastPlayedGame.white, lastPlayedGame.whiteElo)\n        let sampleResultBlack = playerDetails(lastPlayedGame.black, lastPlayedGame.blackElo)\n        let sampleResult = lastPlayedGame.result\n\n        return <TableRow className={`${this.props.highlightMove === move.san?'bgColor ':''}moveRow`} \n                key = {`${move.orig}${move.dest}`} \n                onClick={this.move(move.san)}\n                onMouseOver={this.highlightArrowFn(move).bind(this)} \n                onMouseOut={()=>this.props.highlightArrow(null)}>\n                <TableCell size=\"small\" className=\"smallCol\">{move.san}</TableCell>\n                <TableCell colSpan = \"2\">\n                        {sampleResultWhite} {sampleResult} {sampleResultBlack} {<FontAwesomeIcon className=\"pointerExternalLink\" onClick ={this.props.launchGame(move.details.lastPlayedGame)} icon={faExternalLinkAlt}/>}\n                </TableCell>\n            </TableRow>\n    }\n\n}\n","import React from 'react'\nimport { Table, TableRow, TableBody, TableCell } from '@material-ui/core';\nimport {playerDetails} from './MovesCommon'\n\nexport default class ResultsTable extends React.Component {\n    render() {\n        return <Table>\n            <TableBody>\n                {\n                this.props.gameResults.map(result => {\n                    let whitePlayer = playerDetails(result.white, result.whiteElo)\n                    let blackPlayer = playerDetails(result.black, result.blackElo)\n                    return <TableRow className=\"moveRow\" key = {`${result.url}`} onClick={this.props.launchGame(result)}>\n                        <TableCell>\n                            {result.result===\"1-0\"?<b>{whitePlayer}</b>:whitePlayer} {result.result} {result.result === \"0-1\"?<b>{blackPlayer}</b>:blackPlayer}\n                        </TableCell>\n                    </TableRow>\n                })}\n            </TableBody>\n        </Table>\n    }\n}","import React from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUser } from '@fortawesome/free-solid-svg-icons'\nimport MovesTable from './MovesTable'\nimport ResultsTable from './ResultsTable';\n\nexport default class MovesList extends React.Component {\n\n    render(){\n        if(!this.props.playerMoves) {\n            return <div className = \"infoMessage\" >No moves to show. Please select a source from the \n                <span className = \"navLinkButton\" onClick={()=>this.props.switchToUserTab()}> <FontAwesomeIcon icon={faUser} /> User</span> tab and enter the details.</div>\n        }\n        return <div>{(this.props.gameResults && this.props.gameResults.length>0)?this.resultsTable():null}\n                {this.movesTable()}</div>\n    }\n\n    movesTable() {\n        return <MovesTable movesToShow={this.props.playerMoves} namespace='moves'\n                launchGame={this.props.launchGame} settings={this.props.settings}\n                turnColor={this.props.turnColor} onMove={this.props.onMove}\n                clickedEventName=\"MoveClicked\" tableFooter={this.tableFooter()}\n                highlightMove={this.props.highlightMove} \n                compareToClicked={this.props.switchToBookTab}\n                compareToAlt=\"Indicator for book moves - Click me\"\n                settingsChange={this.props.settingsChange}\n                variant={this.props.variant}\n                highlightArrow={this.props.highlightArrow}\n                />\n    }\n    resultsTable() {\n        return <ResultsTable gameResults={this.props.gameResults}\n                launchGame={this.props.launchGame}/>\n    }\n\n    tableFooter() {\n        let hasMoves = (this.props.playerMoves && this.props.playerMoves.length>0)\n        if(this.props.settings.playerName) {\n            if(hasMoves) {\n                return <span>\n                    Showing moves that have been  played {this.props.turnColor === this.props.settings.playerColor? \"by\" : \"by others against\"} <b>{this.props.settings.playerName}</b> in \n                    this position. <b>{this.props.settings.playerName}</b> is playing as <b>{this.props.settings.playerColor}</b>.\n                    </span>\n            } else {\n                return <span>No moves found played by {this.props.turnColor === this.props.settings.playerColor? \"by\" : \"by others against\"} <b>{this.props.settings.playerName}</b> in \n                    this position. <b>{this.props.settings.playerName}</b> is playing as <b>{this.props.settings.playerColor}</b>.</span>\n            }\n        } else {\n            if(hasMoves) {\n                return <span>\n                    Showing all moves that have been played by <b>{this.props.turnColor}</b> in this position.\n                    </span>\n            } else {\n                return <span>\n                    No moves found played by <b>{this.props.turnColor}</b> in this position.\n                    </span>\n            }\n        }\n    }\n\n}","import React from 'react'\nimport MovesTable from './MovesTable'\nimport ResultsTable from './ResultsTable';\nimport { Spinner } from 'reactstrap';\nimport {Card, CardBody, CardText, CardTitle} from 'reactstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faInfoCircle} from '@fortawesome/free-solid-svg-icons'\nimport { Button as MaterialUIButton } from '@material-ui/core'\nimport Cached from '@material-ui/icons/Cached'\nimport * as Constants from '../../app/Constants'\n\nexport default class BookMove extends React.Component {\n\n    render(){\n        if(!this.props.bookMoves) {\n            return <div className = \"infoMessage\" >No book moves found in this position</div>\n        }\n        return <div>{(this.props.gameResults && this.props.gameResults.length>0)?this.resultsTable():null}\n                {this.movesTable()}</div>\n    }\n\n    enableBook(){\n        let newMovesSettings = Object.assign({},this.props.settings.movesSettings)\n        newMovesSettings.openingBookType = Constants.OPENING_BOOK_TYPE_LICHESS\n        this.props.settingsChange(Constants.SETTING_NAME_MOVES_SETTINGS, newMovesSettings)\n    }\n\n    movesTable() {\n        if(this.props.bookMoves.fetch === \"pending\") {\n            return <div className=\"center\"><br/><Spinner/></div>\n        }\n        if(this.props.bookMoves.fetch === \"off\") {\n            return this.offCard('Opening book is disabled',\n                'Click the button below to enable it',\n                this.enableBook.bind(this),'Enable opening book', <Cached />)\n        }\n\n        if(this.props.bookMoves.fetch === \"failed\") {\n            return this.offCard('Failed to fetch book moves',\n                'Please check your internet connection. Lichess could also be down.',\n                this.props.forceFetchBookMoves,'Try again', <Cached />)\n        }\n        if(this.props.bookMoves.moves.length === 0) {\n            return this.offCard('No moves found',\n                'The opening book does not have any moves in this position')\n        }\n\n        return <MovesTable movesToShow={this.props.bookMoves.moves} namespace='book'\n                launchGame={this.props.launchGame} settings={this.props.settings}\n                turnColor={this.props.turnColor} onMove={this.props.onMove}\n                clickedEventName=\"BookMoveClicked\" tab=\"book\" showAsPercentage\n                highlightMove={this.props.highlightMove} \n                compareToClicked={this.props.switchToMovesTab}\n                compareToAlt=\"Indicator for player moves - Click me\"\n                settingsChange={this.props.settingsChange}\n                variant={this.props.variant}\n                highlightArrow={this.props.highlightArrow}\n                />\n    }\n\n    offCard(title, message, action, actionText, actionIcon) {\n        return <Card className=\"errorCard\"><CardBody className=\"singlePadding\">\n        <CardTitle className=\"smallBottomMargin\"><FontAwesomeIcon icon={faInfoCircle} className=\"lowOpacity\"/> {title}</CardTitle>\n        <CardText className=\"smallText\">\n            {message}\n            <br/>\n            <br/>\n            {actionText?<MaterialUIButton\n            onClick={action}\n            variant=\"contained\"\n            color=\"default\"\n            className=\"mainButton\" disableElevation\n            startIcon={actionIcon}\n            >\n                {actionText}\n            </MaterialUIButton>:null}\n        </CardText>\n        </CardBody>\n        </Card>\n    }\n    resultsTable() {\n        return <ResultsTable gameResults={this.props.gameResults}\n                launchGame={this.props.launchGame}/>\n    }\n}","import React from 'react'\nimport PGNLoader from './loader/PGNLoader'\nimport SettingsView from './Settings'\nimport {\n  Badge,\n  Button,\n  Col,\n  Modal,\n  ModalFooter,\n  ModalHeader,\n  Nav,\n  NavItem,\n  NavLink,\n  Row,\n  TabContent,\n  TabPane\n} from 'reactstrap';\nimport classnames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUser, faList, faCog, faChartBar, faBook } from '@fortawesome/free-solid-svg-icons'\nimport MovesList from './moves/MovesList'\nimport BookMoves from './moves/BookMoves'\nimport {trackEvent} from '../app/Analytics'\nimport * as Constants from '../app/Constants'\nimport ReportControls from './ReportControls'\nimport { Table, TableRow, TableBody, TableCell } from '@material-ui/core'\n\nexport default class ControlsContainer extends React.Component {\n    constructor(props){\n      super(props)\n      this.state = {\n          activeTab:'user',\n          activeGame:null\n      }\n      this.toggleModal = ()=>{\n        this.setState({activeGame:null})\n      }\n    }\n\n    launchGame(game) {\n      if(game.url) {\n          return (e) => {\n              e.stopPropagation()\n              window.open(game.url, '_blank');\n              trackEvent(Constants.EVENT_CATEGORY_MOVES_LIST, \"ViewGameExternal\")\n          }\n      }\n      return ((e) => {\n        e.stopPropagation()\n        this.setState({activeGame:game})\n      })\n    }\n    shouldComponentUpdate(newProps){\n      if(this.props.resize !== newProps.resize) {\n        // dont update component on resize\n        return false\n      }\n      return true\n    }\n    toggle(tab) {\n        if(this.state.activeTab !== tab) {\n            this.setState({activeTab:tab})\n            trackEvent(Constants.EVENT_CATEGORY_CONTROLS,`activeTab:${tab}`)\n        }\n    }\n    switchToUserTab() {\n      this.toggle('user')\n    }\n    switchToMovesTab(highlightMove) {\n      this.toggle('moves')\n      if(highlightMove) {\n        this.setState({highlightPlayerMove:highlightMove})\n        setTimeout(() => {\n          this.setState({\n            highlightPlayerMove:null\n          })\n        }, 1000);\n      }\n    }\n    switchToBookTab(highlightMove) {\n      this.toggle('book')\n      if(highlightMove) {\n        this.setState({highlightBookMove:highlightMove})\n        setTimeout(() => {\n          this.setState({\n            highlightBookMove:null\n          })\n        }, 1000);\n      }\n    }\n\n    render(){\n        return <div>\n              <Modal isOpen={this.state.activeGame} toggle={this.toggleModal}>\n              <ModalHeader toggle={this.toggleModal}>Game details</ModalHeader>\n              {!this.state.activeGame?null:\n              <Table>\n                <TableBody>\n                  {\n                    Object.entries(this.state.activeGame.headers).map((entry)=>!entry[1]?null:<TableRow className=\"performanceRatingRow\">\n                        <TableCell className=\"performanceRatingRow\">{entry[0]}</TableCell>\n                        <TableCell className=\"performanceRatingRow\">{entry[1]}</TableCell>\n                    </TableRow>\n                    )}\n                </TableBody>\n              </Table>\n              }\n              <ModalFooter>\n          <Button color=\"secondary\" onClick={this.toggleModal}>Done</Button>\n        </ModalFooter>\n              </Modal>\n            <Nav tabs>\n        <NavItem>\n          <NavLink\n            className={classnames({ active: this.state.activeTab === 'user' })}\n            onClick={() => { this.toggle('user'); }}\n          >\n            <FontAwesomeIcon icon={faUser} /> {this.state.activeTab === 'user'?\"User\":\"\"}\n          </NavLink>\n        </NavItem>\n        <NavItem>\n          <NavLink\n            className={classnames({ active: this.state.activeTab === 'moves' })}\n            onClick={() => { this.toggle('moves'); }}\n          >\n            <FontAwesomeIcon icon={faList} /> {this.state.activeTab === 'moves'?\"Moves\":\"\"}\n          </NavLink>\n        </NavItem>\n        <NavItem>\n          <NavLink\n            className={classnames({ active: this.state.activeTab === 'book' })}\n            onClick={() => { this.toggle('book'); }}\n          >\n            <FontAwesomeIcon icon={faBook} /> {this.state.activeTab === 'book'?\"Opening book\":<Badge className=\"sourceName\" color=\"info\">New!</Badge>}\n          </NavLink>\n        </NavItem>\n        <NavItem>\n          <NavLink\n            className={classnames({ active: this.state.activeTab === 'report' })}\n            onClick={() => { this.toggle('report'); }}\n          >\n            <FontAwesomeIcon icon={faChartBar} /> {this.state.activeTab === 'report'?\"Report\":\"\"}\n          </NavLink>\n        </NavItem>\n        <NavItem>\n          <NavLink\n            className={classnames({ active: this.state.activeTab === 'settings' })}\n            onClick={() => { this.toggle('settings'); }}\n          >\n            <FontAwesomeIcon icon={faCog} /> {this.state.activeTab === 'settings'?\"Controls\":\"\"}\n          </NavLink>\n        </NavItem>\n      </Nav>\n      <TabContent activeTab={this.state.activeTab}>\n        <TabPane tabId=\"user\">\n            <PGNLoader\n              switchToMovesTab={this.switchToMovesTab.bind(this)}\n              clear = {this.props.clear}\n              gamesProcessed = {this.props.gamesProcessed}\n              settings = {this.props.settings}\n              onChange = {this.props.settingsChange}\n              notify = {this.props.updateProcessedGames}\n              showError = {this.props.showError}\n              showInfo = {this.props.showInfo}\n              setDownloading = {this.props.setDownloading}\n              isDownloading = {this.props.isDownloading}\n              openingGraph={this.props.openingGraph}\n              importCallback={this.props.importCallback}\n              variant={this.props.variant}\n              variantChange={this.props.variantChange}\n              />\n            </TabPane>\n        <TabPane tabId=\"moves\">\n            <MovesList\n              switchToUserTab={this.switchToUserTab.bind(this)}\n              playerMoves={this.props.playerMoves}\n              gameResults={this.props.gameResults}\n              onMove={this.props.onMove}\n              settings={this.props.settings}\n              turnColor={this.props.turnColor}\n              settingsChange={this.props.settingsChange}\n              launchGame = {this.launchGame.bind(this)}\n              switchToBookTab={this.switchToBookTab.bind(this)}\n              highlightMove={this.state.highlightPlayerMove}\n              variant={this.props.variant}\n              highlightArrow={this.props.highlightArrow}\n            />\n        </TabPane>\n        <TabPane tabId=\"book\">\n            <BookMoves\n              bookMoves={this.props.bookMoves}\n              gameResults={this.props.bookResults}\n              onMove={this.props.onMove}\n              settings={this.props.settings}\n              turnColor={this.props.turnColor}\n              settingsChange={this.props.settingsChange}\n              launchGame = {this.launchGame.bind(this)}\n              switchToMovesTab = {this.switchToMovesTab.bind(this)}\n              highlightMove = {this.state.highlightBookMove}\n              forceFetchBookMoves = {this.props.forceFetchBookMoves}\n              variant={this.props.variant}\n              highlightArrow={this.props.highlightArrow}\n              />\n        </TabPane>\n        <TabPane tabId=\"report\">\n          <ReportControls fen={this.props.fen} simplifiedView = {false}\n            moveDetails = {this.props.openingGraph.getDetailsForFen(this.props.fen)}\n            launchGame={this.launchGame.bind(this)} settings={this.props.settings}\n            switchToUserTab={this.switchToUserTab.bind(this)}\n            isOpen = {this.state.activeTab === \"report\"}\n            showInfo = {this.props.showInfo} reportFooter={this.reportFooter()}/>\n        </TabPane>\n        <TabPane tabId=\"settings\">\n          <Row>\n            <Col sm=\"6\">\n            <SettingsView\n              fen={this.props.fen}\n              settings={this.props.settings}\n              isOpen = {true}\n              clear = {this.props.clear}\n              reset = {this.props.reset}\n              onChange = {this.props.settingsChange} />\n            </Col>\n          </Row>\n        </TabPane>\n      </TabContent>\n        </div>\n    }\n\n    reportFooter(){\n      return <span>Calculated based on <a href=\"https://handbook.fide.com/chapter/B022017\" target=\"_blank\" rel=\"noopener noreferrer\">FIDE regulations</a></span>\n    }\n}","import * as Constants from '../../app/Constants'\nimport * as Common from '../../app/Common'\nimport {getTimeControlsArray} from '../../app/util'\n\nlet timeClasses = [\n    {\n        label:\"Fast time controls\",\n        selectedTimeControls:[\n            Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_ULTRA_BULLET,\n            Constants.TIME_CONTROL_BLITZ\n        ],\n        unselectedTimeControls:[\n            Constants.TIME_CONTROL_RAPID,\n            Constants.TIME_CONTROL_CLASSICAL,\n            Constants.TIME_CONTROL_CORRESPONDENCE\n        ]\n    },\n    {\n        label:\"Slow time controls\",\n        selectedTimeControls:[\n            Constants.TIME_CONTROL_RAPID,\n            Constants.TIME_CONTROL_CLASSICAL,\n            Constants.TIME_CONTROL_CORRESPONDENCE\n        ],\n        unselectedTimeControls:[\n            Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_ULTRA_BULLET,\n            Constants.TIME_CONTROL_BLITZ\n        ]\n    },\n    {\n        label:\"Reasonable time controls\",\n        selectedTimeControls:[\n            Constants.TIME_CONTROL_BLITZ,\n            Constants.TIME_CONTROL_RAPID,\n            Constants.TIME_CONTROL_CLASSICAL,\n            Constants.TIME_CONTROL_CORRESPONDENCE\n        ],\n        unselectedTimeControls:[\n            Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_ULTRA_BULLET\n        ]\n    },\n    {\n        label:\"Exclude slow time controls\",\n        selectedTimeControls:[\n            Constants.TIME_CONTROL_BULLET,\n            Constants.TIME_CONTROL_ULTRA_BULLET,\n            Constants.TIME_CONTROL_BLITZ,\n            Constants.TIME_CONTROL_RAPID\n        ],\n        unselectedTimeControls:[\n            Constants.TIME_CONTROL_CLASSICAL,\n            Constants.TIME_CONTROL_CORRESPONDENCE\n        ]\n    }\n]\n        \n\n\nexport function timeControlLabel(site, timeControlState) {\n    let selectedTimeControls = getTimeControlsArray(site, timeControlState, true)\n    let unselectedTimeControls = getTimeControlsArray(site, timeControlState, false)\n    if(unselectedTimeControls.length === 0 || selectedTimeControls.length === 0) {\n        return \"All time controls\"\n    }\n    if(selectedTimeControls.length === 1) {\n        return Common.TIME_CONTROL_LABELS[selectedTimeControls[0]]\n    }\n    if(unselectedTimeControls.length === 1) {\n        return `All except ${Common.TIME_CONTROL_LABELS[unselectedTimeControls[0]]}`\n    }\n    if(selectedTimeControls.length === 2) {\n        return `${Common.TIME_CONTROL_LABELS[selectedTimeControls[0]]} and ${Common.TIME_CONTROL_LABELS[selectedTimeControls[1]]}`\n    }\n\n    return lichessTimeControlLabel(selectedTimeControls, unselectedTimeControls)\n}\n\nfunction lichessTimeControlLabel(selectedTimeControls, unselectedTimeControls) {\n    let timeClass = timeClasses.filter(\n        (timeClass) => {\n            return includesAll(unselectedTimeControls,timeClass.unselectedTimeControls)\n                && includesAll(selectedTimeControls,timeClass.selectedTimeControls)\n    })\n    if(timeClass.length) {\n        return timeClass[0].label\n    } \n    return selectedTimeControls.map(control=>Common.TIME_CONTROL_LABELS[control]).join(', ')\n}\n\nfunction includesAll(arr, subArray) {\n    return subArray.every(v => arr.includes(v));\n}\n","import {timeControlLabel} from './TimeControlLabels'\nimport {getSelectedTimeFrameData} from '../../app/util'\nimport * as Constants from '../../app/Constants'\n\nexport const getTimeControlLabel = timeControlLabel\n\nexport function getRatedLabel(rated) {\n    if(rated === 'all') {\n        return \"Rated and casual\"\n    } else if (rated === 'rated') {\n        return \"Rated only\"\n    } else if (rated === 'casual') {\n        return \"Casual only\"\n    }\n}\n\nexport function getWhenPlayedLabel(timeframe, timeframeSteps) {\n    return getSelectedTimeFrameData(timeframe, timeframeSteps).label\n}\n\nexport function getELORangeLabel(selectedEloRange) {\n    if(selectedEloRange[0] === 0 && selectedEloRange[1]===Constants.MAX_ELO_RATING) {\n        return \"All elo ratings\"\n    } else if (selectedEloRange[0] === 0) {\n        return `Below ${selectedEloRange[1]}`\n    } else if (selectedEloRange[1] === Constants.MAX_ELO_RATING) {\n        return `Above ${selectedEloRange[0]}`\n    } else {\n        return `Between ${selectedEloRange[0]} and ${selectedEloRange[1]}`\n    }\n}\nexport function getDownloadLimitLabel(downloadLimit) {\n    return downloadLimit>= Constants.MAX_DOWNLOAD_LIMIT?\"No limit\":`${downloadLimit} games`\n}\n","import FormControl from '@material-ui/core/FormControl';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport React from 'react'\nimport {Collapse, Container, Row, Col} from 'reactstrap'\nimport { FormControlLabel,Slider } from '@material-ui/core';\nimport * as Constants from '../../app/Constants'\nimport {getTimeControlLabel, getELORangeLabel, getRatedLabel, getWhenPlayedLabel, getDownloadLimitLabel} from './FilterLabels'\nimport * as Common from '../../app/Common'\nimport {trackEvent} from '../../app/Analytics'\n\nexport default class AdvancedFilters extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            currentlyOpenAdvancedFilter:'',\n        }\n        this.timeframeMarks=[\n            {\n                value:0,\n                label:\"Big bang\"\n            }, {\n                value:props.timeframeSteps.length-1,\n                label:\"Now\"\n            }]\n        this.downloadLimitMarks=[\n            {\n                value:0,\n                label:\"0\"\n            }, {\n                value:Constants.MAX_DOWNLOAD_LIMIT,\n                label:`No limit`\n            }]\n        this.eloRangeMarks=[\n            {\n                value:0,\n                label:\"0\"\n            }, {\n                value:Constants.MAX_ELO_RATING,\n                label:`No limit`\n            }]\n    \n    }\n    setCurrentlyOpenAdvancedFilter(filterName) {\n        return () => {\n            if(this.state.currentlyOpenAdvancedFilter === filterName) {\n                //close if already open\n                filterName = ''\n            }\n            this.setState({currentlyOpenAdvancedFilter:filterName})\n            trackEvent(Constants.EVENT_CATEGORY_PGN_LOADER, \"AdvancedFilterChange\", filterName)\n        }\n    }\n\n    getFilters(site){\n        return <div>\n            {this.subSectionComponent('Mode', getRatedLabel(this.props.advancedFilters.rated), this.props.toggleRated)}\n            {this.subSectionComponent('Time control', getTimeControlLabel(this.props.site, this.props.advancedFilters), \n                    this.setCurrentlyOpenAdvancedFilter('timeControl').bind(this),\n                <Collapse isOpen={this.state.currentlyOpenAdvancedFilter === 'timeControl'}>\n                    {this.getTimeControlFilters(site, 4)}\n                </Collapse>\n            )}\n            {this.subSectionComponent('When played', getWhenPlayedLabel(this.props.advancedFilters[Constants.FILTER_NAME_SELECTED_TIMEFRAME], this.props.timeframeSteps), \n                this.setCurrentlyOpenAdvancedFilter('whenPlayed').bind(this),\n                <Collapse isOpen={this.state.currentlyOpenAdvancedFilter === 'whenPlayed'}>\n                    {this.getTimeFrameFilters()}\n                </Collapse>)}\n            {this.subSectionComponent('Opponent elo range', getELORangeLabel(this.props.advancedFilters[Constants.FILTER_NAME_ELO_RANGE]), \n                this.setCurrentlyOpenAdvancedFilter('eloRange').bind(this),\n                <Collapse isOpen={this.state.currentlyOpenAdvancedFilter === 'eloRange'}>\n                    {this.getEloRangeFilters()}\n                </Collapse>)}\n            {this.subSectionComponent('Download limit', getDownloadLimitLabel(this.props.advancedFilters[Constants.FILTER_NAME_DOWNLOAD_LIMIT]), \n                this.setCurrentlyOpenAdvancedFilter('downloadLimit').bind(this),\n                <Collapse isOpen={this.state.currentlyOpenAdvancedFilter === 'downloadLimit'}>\n                    {this.getDownloadLimitFilters()}\n                </Collapse>)}\n      </div>\n    }\n\n    getDownloadLimitFilters() {\n        return <Slider className = \"sliderCustom\"\n            value={this.props.advancedFilters[Constants.FILTER_NAME_DOWNLOAD_LIMIT]}\n            onChange={this.props.handleDownloadLimitChange}\n            valueLabelDisplay=\"auto\"\n            valueLabelFormat={(val)=>val>=Constants.MAX_DOWNLOAD_LIMIT?\"All\":val}\n            step={100}\n            min={0}\n            marks={this.downloadLimitMarks}\n            max={Constants.MAX_DOWNLOAD_LIMIT}\n        />\n    }\n\n    getTimeFrameFilters() {\n        return <Slider className = \"sliderCustom\"\n            value={this.props.advancedFilters[Constants.FILTER_NAME_SELECTED_TIMEFRAME]}\n            onChange={this.props.handleTimeframeChange}\n            valueLabelDisplay=\"off\"\n            valueLabelFormat={(val)=>this.props.timeframeSteps[val].label}\n            step={1}\n            marks={this.timeframeMarks}\n            min={0}\n            max={this.props.timeframeSteps.length-1}\n        />\n    }\n\n    getEloRangeFilters() {\n        return <Slider className = \"sliderCustom\"\n            value={this.props.advancedFilters[Constants.FILTER_NAME_ELO_RANGE]}\n            onChange={this.props.handleEloRangeChange}\n            valueLabelDisplay=\"off\"\n            marks={this.eloRangeMarks}\n            min={0}\n            max={Constants.MAX_ELO_RATING}\n        />\n    }\n\n    getTimeControlFilters(site){\n        let firstRow = null, middleRow = null, lastRow = null\n        let colWidth = null\n        if(site === 'lichess') {\n            firstRow = [Constants.TIME_CONTROL_BULLET,\n                        Constants.TIME_CONTROL_ULTRA_BULLET]\n            middleRow = [Constants.TIME_CONTROL_BLITZ,\n                        Constants.TIME_CONTROL_CLASSICAL]\n            lastRow = [Constants.TIME_CONTROL_RAPID,\n                        Constants.TIME_CONTROL_CORRESPONDENCE]\n            colWidth = '4'\n                    \n        } else {\n            firstRow = [Constants.TIME_CONTROL_BULLET,\n                        Constants.TIME_CONTROL_BLITZ]\n            lastRow = [Constants.TIME_CONTROL_RAPID, \n                        Constants.TIME_CONTROL_DAILY]\n            colWidth = '6'\n        }\n        return <FormControl><FormGroup><Container>\n            {this.getTimeControlFilterRow(firstRow,colWidth,'first')}\n            {middleRow?this.getTimeControlFilterRow(middleRow,colWidth,'middle'):null}\n            {this.getTimeControlFilterRow(lastRow,colWidth,'last')}\n          </Container>\n        </FormGroup></FormControl>\n      \n    }\n\n    getTimeControlFilterRow(controls,firstColumnWidth, position){\n        let clsName = 'topBottomNegativeMargin'\n        if(position === \"first\") {\n            clsName = 'bottomNegativeMargin'\n        } else if (position === \"last\") {\n            clsName = 'topNegativeMargin'\n        } \n        return <Row className={clsName}>\n            {controls.map((control) => \n            <Col sm={firstColumnWidth} key={`ctrl${control}`}>\n                \n            <FormControlLabel className = \"nomargin\"\n                control={<Checkbox checked={this.props.advancedFilters[control]} color=\"primary\" \n                onChange={this.props.handleTimeControlChange} name={control} />}\n                label={Common.TIME_CONTROL_LABELS[control]}\n          /></Col>)}</Row>\n    }\n\n    subSectionComponent(title, label, changeCallback, children) {\n        return <div className=\"pgnloadersection\">{title}: <span className=\"smallText\">[<span className=\"linkStyle\" onClick={changeCallback}>change</span>]</span>\n        <div><b>{label}</b></div>{children}\n        </div>\n    }\n\n\n    render() {\n        return this.getFilters(this.props.site)\n    }\n\n}","import * as ChessLogic from './chess/ChessLogic'\n\nexport default class OpeningManager {\n    plys = []\n    currentIndex = 0\n    constructor(variant) {\n        this.plys = [{pgn:'', fen:ChessLogic.rootFen(variant), move:null}]\n        this.currentIndex = 0\n    }\n    addPly(fen,move) {\n        if(this.currentIndex<this.plys.length-1 && this.plys[this.currentIndex+1].move.san === move.san) {\n            this.moveForward()\n            return\n        }\n        this.plys = this.plys.slice(0,this.currentIndex+1)\n        this.plys.push({\n            pgnAsList:this.pgnAsList(move.san),\n            fen: fen,\n            move: move\n        })\n        this.currentIndex++;\n        return this.plys[this.currentIndex]\n    }\n\n    pgnAsList(san) {\n        let pgnSoFar = this.pgnListSoFar()\n        let pgnList\n        if (!pgnSoFar) {\n            pgnList = []\n        } else {\n            pgnList = [...pgnSoFar]\n        }\n        let numPlys = this.plys.length\n        if(numPlys%2 !== 0) {\n            pgnList.push({\n                moveNumber:pgnList.length+1,\n                whitePly:san,\n                blackPly:''\n            })\n        } else {\n            let currMove = pgnList[pgnList.length-1]\n            currMove.blackPly = san\n            pgnList[pgnList.length-1] = currMove\n        }\n        return pgnList\n    }\n\n    currentMove() {\n        return Math.floor((this.currentIndex-1)/2);\n    }\n\n    pgnListSoFar(){\n        return this.plys[this.plys.length-1].pgnAsList\n    }\n\n    fen(){\n        return this.plys[this.currentIndex].fen\n    }\n\n    moveForward() {\n        return this.moveTo(this.currentIndex+1)\n    }\n    moveBack() {\n        return this.moveTo(this.currentIndex-1)\n    }\n    moveTo(index) {\n        if(index>=0 && index<this.plys.length) {\n            this.currentIndex = index\n        }\n        return this.plys[this.currentIndex]\n    }\n\n}","import React from 'react'\nimport ChessEcoCodes from 'chess-eco-codes'\nimport OpeningManager from '../app/OpeningManager'\nimport {Container, Row, Col, Button} from 'reactstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faStepForward, faStepBackward } from '@fortawesome/free-solid-svg-icons'\nimport * as Constants from '../app/Constants'\nimport {trackEvent} from '../app/Analytics'\n\nexport default class Navigator extends React.Component {\n\n    constructor(props){\n        super(props)\n        this.openingManager = new OpeningManager(this.props.variant)\n        this.state = {\n            currentMove:0,\n        }\n        window.addEventListener(\"keydown\",this.keyHandler.bind(this))\n    }\n    keyHandler(e){\n        switch(e.keyCode) {\n            case 37:\n                this.previous(e, \"keyboard\");\n                break\n            case 39:\n                this.next(e, \"keyboard\")\n                break\n            default:\n                break\n        }\n    }\n\n    // TODO: Put scroll handler behind setting\n    // scrollHandler(e) {\n    //     e.preventDefault();\n\n    //     if (e.deltaY > 0) {\n    //         this.next(e, \"wheel\");\n    //     }\n\n    //     else if (e.deltaY < 0) {\n    //         this.previous(e, \"wheel\");\n    //     }\n    // }\n\n    shouldComponentUpdate(newProps) {\n        //console.log(newProps)\n        if(newProps.variant !== this.props.variant) {\n            this.openingManager = new OpeningManager(newProps.variant)\n            return true\n\n        }\n        if(newProps.fen !== this.openingManager.fen()) {\n            if(newProps.move === null) {\n                // called when \"clear\" or \"starting position\" actions are hit\n                this.openingManager = new OpeningManager(newProps.variant)\n                return true\n            }\n            this.openingManager.addPly(newProps.fen, newProps.move)\n            return true\n        }\n        return true\n    }\n\n    previous(e, device) {\n        let newState = this.openingManager.moveBack()\n        this.props.onChange(newState.fen, newState.move)\n        this.setState({\n            currentMove: this.openingManager.currentMove()\n        })\n        trackEvent(Constants.EVENT_CATEGORY_NAVIGATOR, \"Previous\", device || \"mouse\")\n    }\n\n    next(e, device) {\n        let newState = this.openingManager.moveForward()\n        this.props.onChange(newState.fen, newState.move)\n        this.setState({currentMove:this.openingManager.currentMove()})\n        trackEvent(Constants.EVENT_CATEGORY_NAVIGATOR, \"Next\", device || \"mouse\")\n    }\n\n    moveTo(index) {\n        return () => {\n            let newState = this.openingManager.moveTo(index+1)\n            this.props.onChange(newState.fen, newState.move)\n            this.setState({currentMove:this.openingManager.currentMove()})\n            trackEvent(Constants.EVENT_CATEGORY_NAVIGATOR, \"move\", null, index)\n        }\n    }\n\n    render(){\n        let opening = ChessEcoCodes(this.openingManager.fen())\n        if (opening) {\n            this.opening = opening.name\n            this.openingCode = opening.code\n        }\n        if(!this.openingManager.pgnListSoFar()) {\n            return <div></div>\n        }\n        return <Container id=\"navigator\">\n            <Row>\n                <Col lg=\"6\" className=\"navSection\">\n                    <Button color=\"\" onClick= {this.previous.bind(this)}>\n                        <FontAwesomeIcon icon={faStepBackward} />&nbsp;\n                        <span>prev</span>\n                    </Button>\n                </Col>\n                <Col lg=\"6\" className=\"navSection\">\n                    <Button color=\"\" onClick = {this.next.bind(this)}>\n                        <span>next</span>&nbsp;\n                        <FontAwesomeIcon icon={faStepForward} /> \n                    </Button>\n                </Col>\n            </Row>\n            <Row className=\"greyText\">{this.openingCode}: {this.opening}</Row>\n            {\n                this.openingManager.pgnListSoFar().map((move, index)=>\n                    <Row key={`${move.moveNumber}`} className=\"navCol\">\n                        <Col sm=\"2\" className = \"navItem navMoveNumber\">\n                            {`${move.moveNumber}.`}\n                        </Col>\n                        <Col sm=\"5\"\n                            className = {`navItem navMove border ${this.openingManager.currentIndex-1 === index*2 ? 'selectedMove':''}`}\n                            onClick={this.moveTo(index*2).bind(this)}>\n                            {`${move.whitePly}`}\n                        </Col>\n                        <Col sm=\"5\"\n                            className = {`navItem navMove border ${this.openingManager.currentIndex-1 === index*2+1 ? 'selectedMove':''}`}\n                            onClick={\n                                this.moveTo(index*2+1).bind(this)}>\n                            {`${move.blackPly}`}\n                        </Col>\n                    </Row>)\n            }\n        </Container>\n    }\n\n    // TODO: Put scroll handler behind setting\n    // componentDidUpdate () {\n    //     const chessBoard = document.querySelector('cg-board');\n    //     const navigator = document.querySelector('#navigator');\n\n    //     if (chessBoard) chessBoard.onwheel = this.scrollHandler.bind(this);\n    //     if (navigator) navigator.onwheel = this.scrollHandler.bind(this);\n    // }\n}","import ReactDOM from 'react-dom'\nimport MainContainer from './pres/MainContainer'\nimport React from 'react'\nimport {trackPageView} from './app/Analytics'\n\nReactDOM.render(<MainContainer />, document.getElementById('root'))\ntrackPageView()","module.exports = __webpack_public_path__ + \"static/js/0.a5c5b1a0.chunk.worker.js\"","import Cookies from 'js-cookie'\n\nclass CookieManager {\n    getLichessAccessToken() {\n        return Cookies.get('at')\n    }\n\n    deleteLichessAccessToken() {\n        Cookies.remove('at', { path: '/', domain:'www.openingtree.com' })\n    }\n\n    setSettingsCookie(settings) {\n        Cookies.set('set',JSON.stringify(settings))\n    }\n\n    setDarkModeCookie(darkMode) {\n        Cookies.set('dm',darkMode)\n    }\n    getDarkModeCookie() {\n        return Cookies.get('dm')\n\n    }\n\n    getSettingsCookie() {\n        let settingsCookie = null\n        try {\n            settingsCookie = Cookies.get('set')\n        } catch (e) {\n            console.log(e)\n            return null\n        }\n        if(!settingsCookie) {\n            return null\n        }\n        return JSON.parse(settingsCookie)\n    }\n\n    currentVisit = null\n\n    getVisitInfo(){\n        if(this.currentVisit) {\n            return this.currentVisit\n        }\n        // executes when page loads\n        let lastVisitCookie = Cookies.get('lst')\n        let visitsCookie = Cookies.get('vcnt')\n        let firstVisitCookie = Cookies.get('fst')\n        let lastVisit = lastVisitCookie?parseInt(lastVisitCookie):null\n        let timesVisited = visitsCookie?parseInt(visitsCookie):0\n        let firstVisit = firstVisitCookie?parseInt(firstVisitCookie):null\n        let currDate = new Date().getTime()\n        this.currentVisit = {\n            firstVisit:firstVisit,\n            lastVisit: lastVisit,\n            currentVisit: currDate,\n            numVisits: timesVisited,\n        }\n        if(lastVisit === null || currDate-lastVisit>1000*60*60*24){\n            // increment count if visit in more than an day\n            Cookies.set('lst', currDate);\n            Cookies.set('vcnt', timesVisited+1)\n        }\n        if(firstVisit === null) {\n            Cookies.set('fst', currDate);\n        }\n        return this.currentVisit\n    }\n\n}\n\nexport default new CookieManager();","import * as Constants from './Constants'\n\nexport const LICHESS_TIME_CONTROLS = [\n    Constants.TIME_CONTROL_ULTRA_BULLET,\n    Constants.TIME_CONTROL_BULLET,\n    Constants.TIME_CONTROL_BLITZ,\n    Constants.TIME_CONTROL_RAPID,\n    Constants.TIME_CONTROL_CLASSICAL,\n    Constants.TIME_CONTROL_CORRESPONDENCE\n]\nexport const CHESS_DOT_COM_TIME_CONTROLS = [\n    Constants.TIME_CONTROL_BULLET,\n    Constants.TIME_CONTROL_BLITZ,\n    Constants.TIME_CONTROL_RAPID,\n    Constants.TIME_CONTROL_DAILY,\n]\n\nexport const TIME_CONTROL_LABELS = {\n    [Constants.TIME_CONTROL_ULTRA_BULLET]: \"Ultrabullet\",\n    [Constants.TIME_CONTROL_BULLET]: \"Bullet\",\n    [Constants.TIME_CONTROL_BLITZ]: \"Blitz\",\n    [Constants.TIME_CONTROL_RAPID]: \"Rapid\",\n    [Constants.TIME_CONTROL_CLASSICAL]: \"Classical\",\n    [Constants.TIME_CONTROL_CORRESPONDENCE]: \"Correspondence\",\n    [Constants.TIME_CONTROL_DAILY]: \"Daily\"\n}\n\nexport function trimString(str) {\n    return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nexport function lichessVariantHeader(variant) {\n    if(variant === Constants.VARIANT_RACING_KINGS) {\n        return Constants.LICHESS_HEADER_RACING_KINGS\n    } else if(variant === Constants.VARIANT_KING_OF_THE_HILL) {\n        return Constants.LICHESS_HEADER_KING_OF_THE_HILL\n    } else if(variant === Constants.VARIANT_THREE_CHECK) {\n        return Constants.LICHESS_HEADER_THREE_CHECK\n    } else if(variant === Constants.VARIANT_CRAZYHOUSE) {\n        return Constants.LICHESS_HEADER_CRAZYHOUSE\n    }\n    return Constants.LICHESS_HEADER_STANDARD\n}\nexport function lichessPerf(variant) {\n    if (variant === Constants.VARIANT_KING_OF_THE_HILL) {\n        return Constants.LICHESS_PERF_KING_OF_THE_HILL\n    } else if (variant === Constants.VARIANT_RACING_KINGS) {\n        return Constants.LICHESS_PERF_RACING_KINGS\n    } else if (variant === Constants.VARIANT_THREE_CHECK) {\n        return Constants.LICHESS_PERF_THREE_CHECK\n    } else if (variant === Constants.VARIANT_CRAZYHOUSE) {\n        return Constants.LICHESS_PERF_CRAZYHOUSE\n    } else if (variant === Constants.VARIANT_STANDARD) {\n        return Constants.LICHESS_PERF_STANDARD\n    }\n}\nexport function chessDotComRules(variant) {\n    if(variant === Constants.VARIANT_KING_OF_THE_HILL) {\n        return Constants.CHESS_COM_RULES_KING_OF_THE_HILL\n    } else if(variant === Constants.VARIANT_THREE_CHECK) {\n        return Constants.CHESS_COM_RULES_THREE_CHECK\n    } else if(variant === Constants.VARIANT_CRAZYHOUSE) {\n        return Constants.CHESS_COM_RULES_CRAZYHOUSE\n    }\n    return Constants.CHESS_COM_RULES_STANDARD\n}\n\n\nexport const DP_TABLE = {\n    \"100\":800,   \"99\":677,    \"98\":589,    \"97\":538,\n    \"96\":501,    \"95\":470,    \"94\":444,    \"93\":422,\n    \"92\":401,    \"91\":383,    \"90\":366,    \"89\":351,\n    \"88\":336,    \"87\":322,    \"86\":309,    \"85\":296,\n    \"84\":284,    \"83\":273,    \"82\":262,    \"81\":251,\n    \"80\":240,    \"79\":230,    \"78\":220,    \"77\":211,\n    \"76\":202,    \"75\":193,    \"74\":184,    \"73\":175,\n    \"72\":166,    \"71\":158,    \"70\":149,    \"69\":141,\n    \"68\":133,    \"67\":125,    \"66\":117,    \"65\":110,\n    \"64\":102,    \"63\":95,     \"62\":87,     \"61\":80,\n    \"60\":72,     \"59\":65,     \"58\":57,     \"57\":50,\n    \"56\":43,     \"55\":36,     \"54\":29,     \"53\":21,\n    \"52\":14,     \"51\":7,      \"50\":0,      \"49\":-7,\n    \"48\":-14,    \"47\":-21,    \"46\":-29,    \"45\":-36,\n    \"44\":-43,    \"43\":-50,    \"42\":-57,    \"41\":-65,\n    \"40\":-72,    \"39\":-80,    \"38\":-87,    \"37\":-95,\n    \"36\":-102,   \"35\":-110,   \"34\":-117,   \"33\":-125,\n    \"32\":-133,   \"31\":-141,   \"30\":-149,   \"29\":-158,\n    \"28\":-166,   \"27\":-175,   \"26\":-184,   \"25\":-193,\n    \"24\":-202,   \"23\":-211,   \"22\":-220,   \"21\":-230,\n    \"20\":-240,   \"19\":-251,   \"18\":-262,   \"17\":-273,\n    \"16\":-284,   \"15\":-296,   \"14\":-309,   \"13\":-322,\n    \"12\":-336,   \"11\":-351,   \"10\":-366,   \"9\":-383,\n    \"8\":-401,    \"7\":-422,    \"6\":-444,    \"5\":-470,\n    \"4\":-501,    \"3\":-538,    \"2\":-589,    \"1\":-677,\n    \"0\":-800,\n}","import Chess from 'chess.js'\n\nexport default class RacingKingsChess {\n    constructor(fen){\n        this.chess = new Chess(fen);\n        this.SQUARES = this.chess.SQUARES\n    }\n    fen(){\n        return this.chess.fen()\n    }\n    turn() {\n        return this.chess.turn()\n    }\n    moves(options) {\n        // checks are not allowed in racing kings \n        // so remove moves that cause a check\n        return this.chess.moves(options).filter((move)=>{\n            let san = move.san || move\n            return !san.endsWith(\"+\") && !san.endsWith(\"#\")\n        })\n    }\n\n    move(moveObject, options) {\n        if(typeof moveObject !== \"string\") {\n            return this.chess.move(moveObject, options)\n        }\n        \n        if (moveObject.endsWith('#')) {\n            // a move ending in checkmate in racing kings will not \n            // be a checkmate under standard rules. so remove the # at the end \n            // to make it pass as a standard notation \n            moveObject = moveObject.substring(0, moveObject.length - 1);\n        } \n        let move = this.chess.move(moveObject, options)\n        if(move) {\n            return move\n        }\n        let disambiguatedMove = disambiguate(moveObject, this.moves())\n        if(!disambiguatedMove) {\n            // disambiguation failed\n            return move\n        }\n        // making this move failed so try disambiguating\n        return this.chess.move(disambiguatedMove, options)\n    }\n\n}\n\n// this is needed because in certain positions, while a disambiguating notation is needed \n// in standard chess, it is not needed in racing kings. \n// for example in this position \"1q4R1/1kN2Q2/8/5K2/8/4Nn2/8/b7 w - - 1 21\"\n// Move Nd5 is ambiguous in standard chess but is clear in Racing kings\n// because Ncd5 will lead to check\n\n// The way this function works is by actually finding the disambiguated move Ned5\n// to pass to the chess.js library. Since the move Ncd5 will end with a check (+) \n// it will fail the filter below\nfunction disambiguate(problematicMove, potentialMoves) {\n    let filteredMoves = potentialMoves.filter((potentialMove)=>{\n        if(problematicMove.charAt(0) !== potentialMove.charAt(0)) {\n            return false;\n        }\n        return problematicMove.slice(-2) === potentialMove.slice(-2)\n    })\n    if(filteredMoves.length !== 1) {\n        return null\n    }\n    return filteredMoves[0]\n}","import Chess from 'chess.js'\n\nexport default class CrazyhouseChess {\n    constructor(fen){\n        this.chess = new Chess(fen);\n        this.SQUARES = this.chess.SQUARES\n    }\n    fen(){\n        return this.chess.fen()\n    }\n    turn() {\n        return this.chess.turn()\n    }\n    moves(options) {\n        return this.chess.moves(options)\n    }\n\n    move(moveObject, options) {\n        let move = this.chess.move(moveObject, options)\n        if(move) {\n            return move\n        }\n        if(typeof moveObject === \"string\") {\n            return this.moveSan(moveObject)\n        } else {\n            return this.moveSan(moveObject.san)\n        }\n    }\n\n    moveSan(san) {\n        if(san.includes('@')){\n            let locationOfAt = san.indexOf('@')\n            let piece = ''\n            if(locationOfAt === 0) {\n                piece = this.chess.PAWN\n            } else {\n                piece = san.charAt(0).toLowerCase()\n            }\n            let location = san.slice(locationOfAt+1,locationOfAt+3)\n            let success = this.chess.put({type:piece, color:this.turn()}, location)\n            if(!success) {\n                return null\n            }\n            let color = this.turn()\n\n            this.toggleTurn()\n            return {\n                color: color,\n                from:location,\n                to:location,\n                san:san\n            }\n        }\n        return null\n    }\n    toggleTurn() {\n        var tokens = this.chess.fen().split(' ');\n        // switch the color\n        tokens[1] = tokens[1] === 'b'? 'w' : 'b'\n        // remove en passent\n        tokens[3] = '-'\n        this.chess.load(tokens.join(' '));\n    }\n    \n}\n\n","import * as Constants from '../Constants'\nimport Chess from 'chess.js'\nimport RacingKingsChess from './RacingKingsChess'\nimport CrazyhouseChess from './CrazyhouseChess'\n\nexport function chessLogic(variant, fen) {\n    if(!fen) {\n        fen = rootFen(variant)\n    }\n    if(variant === Constants.VARIANT_RACING_KINGS) {\n        return new RacingKingsChess(fen)\n    }\n    if(variant === Constants.VARIANT_CRAZYHOUSE) {\n        return new CrazyhouseChess(fen)\n    }\n    return new Chess(fen)\n}\n\nexport function rootFen(variant) {\n    if(variant === Constants.VARIANT_RACING_KINGS) {\n        return Constants.RACING_KINGS_ROOT_FEN\n    }\n    return Constants.ROOT_FEN\n}","import * as Constants from './Constants'\n\nexport function isAdvancedFiltersEnabled(source) {\n    return source === Constants.SITE_CHESS_DOT_COM ||\n        source === Constants.SITE_LICHESS\n}\n\n\nexport function isFilterPanelEnabled(source, playerName) {\n    if(source === Constants.SITE_EVENT_DB ||\n        source === Constants.SITE_OPENING_TREE_FILE ||\n        source === Constants.SITE_ONLINE_TOURNAMENTS) {\n            return false\n    }\n    return !!playerName\n}\n\nexport function treeSaveDisabledReason(loadedSite, selectedSite, gamesProcessed, isDownloading){\n    if(selectedSite === Constants.SITE_ONLINE_TOURNAMENTS) {\n        return \"Not currently supported for tournaments\"\n    }\n    if(selectedSite !== Constants.SITE_LICHESS && \n        selectedSite !== Constants.SITE_CHESS_DOT_COM) {\n        return \"Only supported for chess.com and lichess\"\n    }\n    if(loadedSite !== selectedSite || gamesProcessed<=0) {\n        return \"You need to analyze games before saving\"\n    }\n    if(isDownloading) {\n        return \"Action not supported while games are loading\"\n    }\n    return ''\n}\nexport function exportFileName(source, playerName, playerColor, selectedEvent, extension) {\n    if(source === Constants.SITE_EVENT_DB) {\n        return `${selectedEvent.name}.${extension}`\n    }\n    if(playerName) {\n        return `${playerName}-${playerColor}.${extension}`\n    }\n    return `openingtree-exportedgames.${extension}`\n}"],"sourceRoot":""}